<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="icon" type="image/x-icon" href="assets/logos/logo.jpg">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="assets/logos/logo.jpg">
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
<link rel="preconnect" href="https://analytics.vercel.com" crossorigin>
<link rel="dns-prefetch" href="https://analytics.vercel.com">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://analytics.vercel.com https://www.googletagmanager.com; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; img-src 'self' data: https: blob:; font-src 'self' https://cdnjs.cloudflare.com; connect-src 'self' https://analytics.vercel.com https://www.google-analytics.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
    <meta name="description" content="Camisetazo - Tienda deportiva premium: camisetas de fútbol, NBA, NFL y más. Calidad superior, envíos rápidos y atención personalizada.">
    <meta property="og:title" content="Camisetazo - Tienda Deportiva Premium">
<meta property="og:description" content="Explora nuestro catálogo premium: camisetas de fútbol, NBA, NFL, zapatillas y más. Envío express y pago seguro.">
<meta property="og:type" content="website">
<meta property="og:image" content="assets/logos/logo.jpg">
<meta property="og:url" content="https://camisetazo.com">
<meta property="og:site_name" content="Camisetazo">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Camisetazo - Tienda Deportiva Premium">
<meta name="twitter:description" content="Explora nuestro catálogo premium: camisetas de fútbol, NBA, NFL, zapatillas y más. Envío express y pago seguro.">
<meta name="twitter:image" content="assets/logos/logo.jpg">
<meta name="keywords" content="camisetas deportivas, camisetas fútbol, NBA, NFL, tienda deportiva, ropa deportiva, camisetas premium">

    <!-- Enhanced Open Graph Meta Tags -->
    <meta property="og:image:alt" content="Logo de Camisetazo - Tienda Deportiva Premium">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:secure_url" content="https://camisetazo.com/assets/logos/logo.jpg">
    <meta property="og:locale" content="es_ES">
    <meta property="og:locale:alternate" content="en_US">
    <meta property="article:author" content="Camisetazo">
    <meta property="article:publisher" content="https://www.facebook.com/camisetazo">
    <meta property="article:section" content="Deportes">
    <meta property="article:tag" content="camisetas deportivas">
    <meta property="article:tag" content="fútbol">
    <meta property="article:tag" content="NBA">
    <meta property="article:tag" content="NFL">
    
    <!-- Enhanced Twitter Card Meta Tags -->
    <meta name="twitter:site" content="@camisetazo">
    <meta name="twitter:creator" content="@camisetazo">
    <meta name="twitter:image:alt" content="Camisetazo - Tu tienda deportiva de confianza">
    <meta name="twitter:domain" content="camisetazo.com">
    <meta name="twitter:url" content="https://camisetazo.com/">
    <meta name="twitter:label1" content="Categorías">
    <meta name="twitter:data1" content="Fútbol, NBA, NFL, NHL, MLB, F1">
    <meta name="twitter:label2" content="Envío">
    <meta name="twitter:data2" content="Express 5-15 días">
    
    <!-- Additional Social Media Meta Tags -->
    <meta property="fb:app_id" content="123456789012345">
    <meta property="fb:pages" content="123456789012345">
    <meta name="pinterest-rich-pin" content="true">
    <meta property="pinterest:title" content="Camisetazo - Camisetas Deportivas Premium">
    <meta property="pinterest:description" content="Encuentra las mejores camisetas deportivas de todas las ligas. Fútbol, NBA, NFL y más deportes.">
    <meta property="pinterest:image" content="https://camisetazo.com/assets/logos/logo.jpg">
    
    <!-- LinkedIn Meta Tags -->
    <meta property="og:see_also" content="https://www.linkedin.com/company/camisetazo">
    
    <!-- WhatsApp Sharing Optimization -->
    <meta property="og:video" content="https://camisetazo.com/video/promo.mp4">
    <meta property="og:video:secure_url" content="https://camisetazo.com/video/promo.mp4">
    <meta property="og:video:type" content="video/mp4">
    <meta property="og:video:width" content="1280">
    <meta property="og:video:height" content="720">
    
    <!-- Mobile App Meta Tags -->
    <meta name="theme-color" content="#2e7bed">
    <meta name="msapplication-TileColor" content="#2e7bed">
    <meta name="msapplication-TileImage" content="https://camisetazo.com/assets/logos/logo.jpg">
    <meta name="application-name" content="Camisetazo">
    <meta name="apple-mobile-web-app-title" content="Camisetazo">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="author" content="Camisetazo">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    <link rel="canonical" href="https://camisetazo.com/">
    <link rel="alternate" hreflang="es" href="https://camisetazo.com/">
    <link rel="alternate" hreflang="en" href="https://camisetazo.com/en/">
    <link rel="alternate" hreflang="x-default" href="https://camisetazo.com/">
    
    <!-- Rich Snippets for Social Sharing -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Camisetazo - Tienda Deportiva Premium",
        "description": "La mejor tienda online de camisetas deportivas. Fútbol, NBA, NFL, NHL, MLB, F1 y más.",
        "url": "https://camisetazo.com/",
        "image": {
            "@type": "ImageObject",
            "url": "https://camisetazo.com/assets/logos/logo.jpg",
            "width": 1200,
            "height": 630
        },
        "author": {
            "@type": "Organization",
            "name": "Camisetazo",
            "url": "https://camisetazo.com",
            "logo": "https://camisetazo.com/assets/logos/logo.jpg",
            "sameAs": [
                "https://www.facebook.com/camisetazo",
                "https://www.instagram.com/camisetazo",
                "https://twitter.com/camisetazo",
                "https://www.youtube.com/camisetazo",
                "https://www.tiktok.com/@camisetazo",
                "https://www.linkedin.com/company/camisetazo"
            ]
        },
        "publisher": {
            "@type": "Organization",
            "name": "Camisetazo",
            "logo": {
                "@type": "ImageObject",
                "url": "https://camisetazo.com/assets/logos/logo.jpg"
            }
        },
        "mainEntity": {
            "@type": "Store",
            "name": "Camisetazo",
            "description": "Tienda deportiva premium especializada en camisetas de fútbol, NBA, NFL y más deportes."
        }
    }
    </script>
<meta name="author" content="Camisetazo">
<meta name="robots" content="index, follow">
<meta name="theme-color" content="#0a1f3d">
    <title>Camisetazo - Tienda Deportiva Premium</title>
    <link rel="preload" href="styles/styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="stylesheet" href="styles/styles.css">
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" media="print" onload="this.media='all'">
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" media="print" onload="this.media='all'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</noscript>

<script>
  window.dataLayer = window.dataLayer || [];

  window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-GS53GWE2Z0');

</script>
</head>
<body>
    <a href="#tienda" class="skip-link">Saltar al contenido principal</a>
    <div id="formStatus"></div>
    <div class="contenedor-principal">
        <header role="banner">
    <div class="brand-header">
        <img src="assets/logos/logo.jpg" alt="Logo Camisetazo" class="logo" loading="lazy" width="120" height="120">
        <div class="brand-title">CAMISETAZO</div>
        <div class="brand-subtitle">Tienda Deportiva Premium</div>
    </div>
    <nav class="navegacion">
        <button class="boton-seccion activo" data-seccion="tienda">Catálogo</button>
        <button class="boton-seccion" data-seccion="pedidos">Tienda</button>
    <button class="boton-seccion" data-seccion="carrito">Carrito</button>
    <button class="boton-seccion" data-seccion="quienes-somos">¿Quiénes Somos?</button>
    </nav>
</header>

<section id="tienda" class="seccion activa" role="main" aria-label="Catálogo de productos">
            <div class="catalogo-header animate__animated animate__fadeInDown">
                <h2 class="catalogo-titulo">Catálogo Premium</h2>
                <p class="catalogo-descripcion">Explora nuestra selección exclusiva de productos deportivos de alta calidad. Haz clic en cada categoría para ver el catálogo completo.</p>
            </div>
            <div class="grid-catalogo">
                
                <div class="catalogo-card animate__animated animate__fadeInUp catalogo-card-clickable futbol-dropdown" data-link="https://2020soccer.x.yupoo.com/albums">
                    <div class="catalogo-img-wrap">
                        <img src="assets/images/camfut.png" alt="Camisetas" class="catalogo-img" loading="lazy" width="120" height="120">
                    </div>
                    <div class="catalogo-info">
                        <h3>Camisetas Fútbol</h3>
                        <p>Las mejores camisetas de clubes y selecciones, calidad premium.</p>
                        <button class="catalogo-btn futbol-dropdown-btn" type="button">
                            Ver opciones <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="futbol-dropdown-menu">
                            <a href="https://2020soccer.x.yupoo.com/albums" target="_blank" rel="noopener noreferrer">GENERAL</a>
                            <a href="https://classic-football-fhirts052.x.yupoo.com/" target="_blank" rel="noopener noreferrer">RETRO</a>
                            <a href="https://yongfa1688.x.yupoo.com/" target="_blank" rel="noopener noreferrer">NUEVA TEMPORADA</a>
                            <a href="https://aosendi.x.yupoo.com/albums" target="_blank" rel="noopener noreferrer">CONJUNTOS</a>
                            <a href="https://dongshanstore.x.yupoo.com/" target="_blank" rel="noopener noreferrer">CONJUNTOS 2</a>
                        </div>
                    </div>
                </div>
                
                <div class="catalogo-card animate__animated animate__fadeInUp catalogo-card-clickable" style="animation-delay: 0.1s;" data-link="https://eu1688.x.yupoo.com/albums">
                    <div class="catalogo-img-wrap">
                        <img src="assets/images/zap.png" alt="Zapatillas" class="catalogo-img" loading="lazy" width="120" height="120">
                    </div>
                    <div class="catalogo-info">
                        <h3>Zapatillas</h3>
                        <p>Modelos exclusivos y últimas tendencias en sneakers deportivas.</p>
                        <a href="https://eu1688.x.yupoo.com/albums" class="catalogo-btn" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();">
                            Ver catálogo <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                
                <div class="catalogo-card animate__animated animate__fadeInUp catalogo-card-clickable" style="animation-delay: 0.2s;" data-link="https://x.yupoo.com/photos/05941188/albums">
                    <div class="catalogo-img-wrap">
                        <img src="assets/images/nba.png" alt="NBA" class="catalogo-img nba-img" loading="lazy" width="250" height="160">
                    </div>
                    <div class="catalogo-info">
                        <h3>NBA</h3>
                        <p>Camisetas y productos oficiales de la mejor liga de baloncesto.</p>
                        <a href="https://x.yupoo.com/photos/05941188/albums" class="catalogo-btn" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();">
                            Ver catálogo <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                
                <div class="catalogo-card animate__animated animate__fadeInUp catalogo-card-clickable" style="animation-delay: 0.3s;" data-link="https://docs.google.com/document/d/1IXUCHDWRw8osfQltnWGwz2bUFpD_J85-0_Nnq0p55NI/edit?usp=drivesdk">
                    <div class="catalogo-img-wrap">
                        <img src="assets/images/airpods.png" alt="AirPods" class="catalogo-img" loading="lazy" width="120" height="120">
                    </div>
                    <div class="catalogo-info">
                        <h3>AirPods</h3>
                        <p>Audio inalámbrico de alta calidad, compatibles con todos tus dispositivos.</p>
                        <a href="https://docs.google.com/document/d/1IXUCHDWRw8osfQltnWGwz2bUFpD_J85-0_Nnq0p55NI/edit?usp=drivesdk" class="catalogo-btn" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();">
                            Ver catálogo <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                
                <div class="catalogo-card animate__animated animate__fadeInUp catalogo-card-clickable" style="animation-delay: 0.4s;" data-link="https://zuqiuliu.x.yupoo.com">
                    <div class="catalogo-img-wrap">
                        <img src="assets/images/botfut.png" alt="Botas Fútbol" class="catalogo-img" loading="lazy" width="120" height="120">
                    </div>
                    <div class="catalogo-info">
                        <h3>Botas Fútbol</h3>
                        <p>Botas de fútbol profesionales para todos los terrenos y estilos.</p>
                        <a href="https://zuqiuliu.x.yupoo.com" class="catalogo-btn" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();">
                            Ver catálogo <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                
                <div class="catalogo-card animate__animated animate__fadeInUp catalogo-card-clickable" style="animation-delay: 0.5s;" data-link="https://x.yupoo.com/photos/yiyisports2016/collections/3551571">
                    <div class="catalogo-img-wrap">
                        <img src="assets/images/f1.png" alt="F1" class="catalogo-img" loading="lazy" width="120" height="120">
                    </div>
                    <div class="catalogo-info">
                        <h3>F1</h3>
                        <p>Merchandising y ropa oficial de Fórmula 1 para verdaderos fans.</p>
                        <a href="https://x.yupoo.com/photos/yiyisports2016/collections/3551571" class="catalogo-btn" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();">
                            Ver catálogo <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                
                <div class="catalogo-card animate__animated animate__fadeInUp catalogo-card-clickable" style="animation-delay: 0.6s;" data-link="https://docs.google.com/document/d/15vg3VeVf8gs3R7r6JEaG8_mdgA05hKDKg9mMsdKFVWc/edit?usp=sharing">
                    <div class="catalogo-img-wrap">
                        <img src="assets/images/ps4.png" alt="Mandos PS4" class="catalogo-img" loading="lazy" width="120" height="120">
                    </div>
                    <div class="catalogo-info">
                        <h3>Mandos PS4</h3>
                        <p>Mandos y accesorios para PlayStation 4, máxima precisión y calidad.</p>
                        <a href="https://docs.google.com/document/d/15vg3VeVf8gs3R7r6JEaG8_mdgA05hKDKg9mMsdKFVWc/edit?usp=sharing" class="catalogo-btn" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();">
                            Ver catálogo <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                
                <div class="catalogo-card animate__animated animate__fadeInUp catalogo-card-clickable" style="animation-delay: 0.7s;" data-link="https://nfl-world.x.yupoo.com/">
                    <div class="catalogo-img-wrap">
                        <img src="assets/images/nfl.png" alt="NFL" class="catalogo-img" loading="lazy" width="120" height="120">
                    </div>
                    <div class="catalogo-info">
                        <h3>NFL</h3>
                        <p>Jerseys y artículos oficiales de la National Football League.</p>
                        <a href="https://nfl-world.x.yupoo.com/" class="catalogo-btn" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();">
                            Ver catálogo <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                
            </div>
        </section>

        <section id="quienes-somos" class="seccion" role="region" aria-label="Quiénes somos">
    <style>
    .quienes-somos-ui {
        max-width: 900px;
        margin: 0 auto 2.5rem auto;
        background: rgba(20,40,80,0.18);
        border-radius: 22px;
        box-shadow: 0 4px 32px rgba(42,91,168,0.10), 0 1.5px 8px rgba(0,0,0,0.08);
        padding: 2.5rem 2rem 2rem 2rem;
        text-align: center;
        position: relative;
        overflow: hidden;
        border: 1.5px solid rgba(42,91,168,0.13);
        animation: aparecer 0.8s;
    }
    .quienes-somos-ui h2 {
        color: var(--azul-acento);
        font-size: 2.2rem;
        font-weight: 800;
        margin-bottom: 1.2rem;
        letter-spacing: 1px;
        text-shadow: 0 2px 12px rgba(42,91,168,0.10);
    }
    .quienes-somos-ui p {
        color: #e0e0e0;
        font-size: 1.15rem;
        line-height: 1.7;
        margin-bottom: 2rem;
        opacity: 0.92;
        max-width: 700px;
        margin-left: auto;
        margin-right: auto;
    }
    .quienes-somos-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 2rem;
        margin-top: 2.5rem;
    }
    .quienes-somos-card {
        background: rgba(42,91,168,0.13);
        border-radius: 16px;
        padding: 2rem 1.2rem 1.5rem 1.2rem;
        box-shadow: 0 2px 12px rgba(42,91,168,0.08);
        display: flex;
        flex-direction: column;
        align-items: center;
        transition: transform 0.2s, box-shadow 0.2s;
        border: 1px solid rgba(42,91,168,0.10);
    }
    .quienes-somos-card:hover {
        transform: translateY(-6px) scale(1.03);
        box-shadow: 0 8px 32px rgba(42,91,168,0.13);
        background: rgba(42,91,168,0.18);
    }
    .quienes-somos-card i {
        font-size: 2.7rem;
        margin-bottom: 1rem;
        color: var(--azul-acento);
        background: #fff;
        border-radius: 50%;
        padding: 0.7rem;
        box-shadow: 0 2px 8px rgba(42,91,168,0.08);
        transition: background 0.2s;
    }
    .quienes-somos-card h3 {
        font-size: 1.25rem;
        color: #fff;
        margin-bottom: 0.7rem;
        font-weight: 700;
    }
    .quienes-somos-card p {
        color: #b8c6e0;
        font-size: 1rem;
        margin-bottom: 0;
        min-height: 40px;
    }
    .quienes-somos-card .stars {
        color: #ffd700;
        margin-top: 0.5rem;
        font-size: 1.1rem;
    }
    .quienes-somos-card .stars i {
        color: #FFD700 !important;
        font-size: 1rem !important;
        background: none !important;
        border-radius: 0 !important;
        padding: 0 !important;
        box-shadow: none !important;
        margin: 0 1px;
        vertical-align: middle;
    }
    .quienes-somos-instagram {
        background: linear-gradient(90deg, #e1306c 0%, #fdc468 100%);
        color: #fff;
        border-radius: 16px;
        padding: 1.5rem 1rem 1.2rem 1rem;
        margin-bottom: 2rem;
        box-shadow: 0 2px 12px rgba(225,48,108,0.10);
        display: flex;
        flex-direction: column;
        align-items: center;
        animation: aparecer 1s;
    }
    .quienes-somos-instagram i {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        color: #fff;
        background: #e1306c;
        border-radius: 50%;
        padding: 0.7rem;
        box-shadow: 0 2px 8px rgba(225,48,108,0.10);
    }
    .quienes-somos-instagram a {
        color: #fff;
        font-weight: 600;
        text-decoration: underline;
        margin: 0.5rem 0;
        font-size: 1.1rem;
    }
    .quienes-somos-instagram p {
        margin-top: 0.5rem;
        opacity: 0.95;
        font-size: 1rem;
    }
    @media (max-width: 700px) {
        .quienes-somos-ui {
            padding: 1.2rem 0.5rem;
        }
        .quienes-somos-grid {
            grid-template-columns: 1fr;
            gap: 1.2rem;
        }
    }
    .formulario-pedido {
        max-width: 900px;
        margin: 2.5rem auto;
        background: linear-gradient(135deg, rgba(10,31,61,0.92) 70%, rgba(42,91,168,0.13) 100%);
        backdrop-filter: blur(16px);
        border-radius: 28px;
        padding: 2.7rem 2.2rem 2.2rem 2.2rem;
        border: 2.5px solid var(--azul-acento);
        box-shadow: 0 8px 40px rgba(42,91,168,0.13), 0 2px 12px rgba(0,0,0,0.10);
        position: relative;
        animation: aparecer 0.7s;
    }

    .formulario-pedido h2 {
        text-align: center;
        color: var(--azul-acento);
        margin-bottom: 2.2rem;
        font-size: 2.3rem;
        font-weight: 900;
        letter-spacing: 1.5px;
        text-shadow: 0 2px 12px rgba(42,91,168,0.10);
    }

    .selector-unidades {
        display: flex;
        justify-content: center;
        gap: 1.2rem;
        margin-bottom: 2.2rem;
    }

    .boton-unidad {
        background: var(--azul-acento);
        color: #fff;
        border: 2px solid transparent;
        border-radius: 12px;
        padding: 0.9rem 2.1rem;
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        box-shadow: 0 2px 12px rgba(42,91,168,0.10);
        transition: background 0.2s, color 0.2s, border 0.2s, transform 0.2s, box-shadow 0.2s;
    }

    .boton-unidad.activo, .boton-unidad:focus {
        background: #163a6b;
        color: var(--azul-acento);
        border: 2.5px solid var(--azul-acento);
        outline: none;
        box-shadow: 0 6px 24px rgba(42,91,168,0.13);
        transform: translateY(-3px) scale(1.04);
    }

    .boton-unidad:not(.activo):hover {
        background: #2456a8;
        color: #fff;
        border: 2px solid #2456a8;
        transform: translateY(-1px) scale(1.02);
        box-shadow: 0 4px 16px rgba(42,91,168,0.13);
    }

    .input-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 2.2rem;
        margin: 2.2rem 0 1.5rem 0;
    }

    .input-group {
        margin-bottom: 1.2rem;
        background: rgba(255,255,255,0.04);
        border-radius: 10px;
        padding: 1.1rem 1rem 0.7rem 1rem;
        box-shadow: 0 1px 6px rgba(42,91,168,0.07);
        border: 1.5px solid rgba(42,91,168,0.10);
    }

    .input-group label {
        display: block;
        margin-bottom: 0.5rem;
        color: #e0e0e0;
        font-weight: 600;
        letter-spacing: 0.5px;
    }

    .input-group input,
    .input-group textarea {
        width: 100%;
        padding: 13px;
        border: 2px solid var(--azul-acento);
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.13);
        color: white;
        font-size: 1.08rem;
        transition: all 0.3s ease;
    }

    .input-group input:focus,
    .input-group textarea:focus {
        outline: none;
        border-color: #4a90e2;
        box-shadow: 0 0 10px rgba(74, 144, 226, 0.3);
        background: rgba(255,255,255,0.18);
    }

    .calculadora-precio {
        background: rgba(255, 255, 255, 0.13);
        border-radius: 16px;
        padding: 2.2rem 1.5rem 1.5rem 1.5rem;
        margin: 2.2rem 0 1.2rem 0;
        box-shadow: 0 4px 16px rgba(42, 91, 168, 0.10);
        border: 1.5px solid var(--azul-acento);
    }

    .calculadora-precio h3 {
        color: var(--azul-acento);
        font-size: 1.4rem;
        font-weight: 800;
        margin-bottom: 1.2rem;
        letter-spacing: 1px;
    }

    .detalle-precio {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 1rem 0;
        padding: 1.1rem 1.2rem;
        background: rgba(255, 255, 255, 0.09);
        border-radius: 10px;
        font-size: 1.08rem;
        border: 1px solid rgba(42,91,168,0.10);
        box-shadow: 0 1px 4px rgba(42,91,168,0.06);
    }

    .detalle-precio span:first-child:before {
        content: '\f02b';
        font-family: 'Font Awesome 5 Free';
        font-weight: 900;
        color: var(--azul-acento);
        margin-right: 0.7em;
        font-size: 1.1em;
        vertical-align: middle;
    }

    .total-container {
        background: var(--azul-acento);
        padding: 1.7rem;
        border-radius: 12px;
        margin: 2.2rem 0 0.5rem 0;
        text-align: center;
        box-shadow: 0 2px 12px rgba(42,91,168,0.13);
    }

    .precio-total {
        font-size: 2.5rem;
        font-weight: bold;
        margin: 0.5rem 0;
        color: #fff;
        text-shadow: 0 2px 12px rgba(42,91,168,0.10);
    }

    .moneda {
        font-size: 1.2rem;
        vertical-align: super;
    }

    .badge-extra {
        background: #28a745;
        padding: 0.3rem 0.8rem;
        border-radius: 15px;
        font-size: 0.9rem;
        margin-left: 1rem;
    }
    .contenedor-principal {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
    }

.brand-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: rgba(20,40,80,0.25);
    border-radius: 24px;
    box-shadow: 0 6px 32px rgba(42,91,168,0.10), 0 1.5px 8px rgba(0,0,0,0.10);
    padding: 2.5rem 1.5rem 2rem 1.5rem;
    margin-bottom: 2rem;
    position: relative;
    max-width: 480px;
    margin-left: auto;
    margin-right: auto;
}

.brand-header .logo {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 1.2rem;
    box-shadow: 0 4px 24px rgba(42,91,168,0.15);
    background: #fff;
    border: 4px solid var(--azul-acento);
    transition: transform 0.3s;
}
.brand-header .logo:hover {
    transform: scale(1.07) rotate(-2deg);
}

.brand-header .brand-title {
    font-size: 2.7em;
    font-weight: 900;
    color: var(--azul-acento);
    letter-spacing: 2px;
    text-shadow: 0 2px 12px rgba(42,91,168,0.10);
    margin-bottom: 0.2em;
    line-height: 1.1;
    background: linear-gradient(90deg, #fff 60%, var(--azul-acento) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.brand-header .brand-subtitle {
    color: #e0e0e0;
    font-size: 1.1em;
    font-weight: 400;
    opacity: 0.85;
    margin-bottom: 0;
    text-align: center;
    letter-spacing: 0.5px;
}

        header {
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
            padding: 20px 0;
        }

        .logo {
            width: 200px;
            filter: drop-shadow(0 0 15px rgba(42, 91, 168, 0.4));
            animation: pulse 3s 1;
            border-radius: 50%;
            margin: 20px auto;
        }

        @keyframes flotar {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        h1 {
            font-size: 2.5em;
            margin: 1rem 0 0.5rem;
            color: #e0e0e0;
            position: relative;
            display: inline-block;
            padding-bottom: 10px;
        }

        h1::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            height: 3px;
            background: var(--azul-acento);
            transform: scaleX(0);
            animation: subrayar-titulo 1.5s ease-in-out 1s forwards;
            box-shadow: 0 0 15px rgba(42, 91, 168, 0.5);
        }

        @keyframes subrayar-titulo {
            from { transform: scaleX(0); }
            to { transform: scaleX(1); }
        }
        .selector-unidades {
            display: flex;
            justify-content: center;
            gap: 1.2rem;
            margin-bottom: 2.2rem;
        }

        .boton-unidad {
            background: var(--azul-acento);
            color: #fff;
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 0.9rem 2.1rem;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 2px 12px rgba(42,91,168,0.10);
            transition: background 0.2s, color 0.2s, border 0.2s, transform 0.2s, box-shadow 0.2s;
        }

        .boton-unidad.activo, .boton-unidad:focus {
            background: #163a6b;
            color: var(--azul-acento);
            border: 2.5px solid var(--azul-acento);
            outline: none;
            box-shadow: 0 6px 24px rgba(42,91,168,0.13);
            transform: translateY(-3px) scale(1.04);
        }

        .boton-unidad:not(.activo):hover {
            background: #2456a8;
            color: #fff;
            border: 2px solid #2456a8;
            transform: translateY(-1px) scale(1.02);
            box-shadow: 0 4px 16px rgba(42,91,168,0.13);
        }

        .boton-version-especial, .boton-version-jugador, .boton-camiseta-nba {
            width: 100%;
            padding: 0.85rem 0;
            font-size: 1.08rem;
            font-weight: 700;
            border: none;
            border-radius: 12px;
            background: linear-gradient(90deg, var(--azul-acento) 60%, #1a3b6d 100%);
            color: #fff;
            box-shadow: 0 2px 12px rgba(42,91,168,0.10);
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: background 0.2s, color 0.2s, transform 0.18s, box-shadow 0.2s;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.7em;
            position: relative;
            outline: none;
        }
        .boton-version-especial span, .boton-version-jugador span, .boton-camiseta-nba span {
            font-size: 0.98em;
            font-weight: 600;
            margin-left: 0.5em;
            letter-spacing: 0.2px;
        }
        .boton-version-especial.activo, .boton-version-jugador.activo, .boton-camiseta-nba.activo {
            background: linear-gradient(90deg, #fff 10%, var(--azul-acento) 100%);
            color: var(--azul-acento);
            transform: translateY(-2px) scale(1.04);
            box-shadow: 0 6px 24px rgba(42,91,168,0.13);
            border: 2px solid var(--azul-acento);
        }
        .boton-version-especial:not(.activo):hover, .boton-version-jugador:not(.activo):hover, .boton-camiseta-nba:not(.activo):hover {
            background: linear-gradient(90deg, #2a5ba8 60%, #1a3b6d 100%);
            color: #fff;
            transform: translateY(-1px) scale(1.02);
            box-shadow: 0 4px 16px rgba(42,91,168,0.13);
        }
        .boton-version-jugador::before,
    .boton-version-especial:not(.boton-version-jugador):not(.boton-camiseta-nba)::before,
    .boton-camiseta-nba::before {
        content: none !important;
        display: none !important;
    }
    </style>
    <div class="quienes-somos-ui animate__animated animate__fadeIn">
        <h2>Nuestra Historia</h2>
        <p>
            En Camisetazo nos apasiona conectar a los verdaderos amantes del deporte con artículos premium de las mejores marcas. Nos especializamos en ofrecer productos de alta calidad y artículos exclusivos que permiten vivir la emoción del deporte al mejor precio. Combinamos nuestro conocimiento experto con un servicio personalizado para garantizar que cada compra supere tus expectativas.
        </p>
        <div class="quienes-somos-instagram">
            <i class="fab fa-instagram"></i>
            <h3>Síguenos en Instagram</h3>
            <a href="https://www.instagram.com/camisetazo._/" target="_blank" rel="noopener noreferrer">@camisetazo._ ➔</a>
            <p>Novedades diarias | Ofertas exclusivas</p>
        </div>
        <div class="clientes-carrusel-section">
            <h3 style="color:var(--azul-acento);margin-bottom:1rem;">Clientes Satisfechos</h3>
            <div class="clientes-carrusel">
                <button class="carrusel-btn" id="carrusel-prev" aria-label="Anterior">&#8592;</button>
                <div class="carrusel-imagenes">
                    <div class="carrusel-img-bg activa" data-img="assets/clientes/cliente1.jpg" aria-label="Cliente satisfecho 1"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente2.jpg" aria-label="Cliente satisfecho 2"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente3.jpg" aria-label="Cliente satisfecho 3"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente4.jpg" aria-label="Cliente satisfecho 4"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente5.jpg" aria-label="Cliente satisfecho 5"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente6.jpg" aria-label="Cliente satisfecho 6"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente7.jpg" aria-label="Cliente satisfecho 7"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente8.jpg" aria-label="Cliente satisfecho 8"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente9.jpg" aria-label="Cliente satisfecho 9"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente10.jpg" aria-label="Cliente satisfecho 10"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente11.jpg" aria-label="Cliente satisfecho 11"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente12.jpg" aria-label="Cliente satisfecho 12"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente13.jpg" aria-label="Cliente satisfecho 13"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente14.jpg" aria-label="Cliente satisfecho 14"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente15.jpg" aria-label="Cliente satisfecho 15"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente16.jpg" aria-label="Cliente satisfecho 16"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente17.jpg" aria-label="Cliente satisfecho 17"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente18.jpg" aria-label="Cliente satisfecho 18"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente19.jpg" aria-label="Cliente satisfecho 19"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente20.jpg" aria-label="Cliente satisfecho 20"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente21.jpg" aria-label="Cliente satisfecho 21"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente22.jpg" aria-label="Cliente satisfecho 22"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente23.jpg" aria-label="Cliente satisfecho 23"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente24.jpg" aria-label="Cliente satisfecho 24"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente25.jpg" aria-label="Cliente satisfecho 25"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente26.jpg" aria-label="Cliente satisfecho 26"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente27.jpg" aria-label="Cliente satisfecho 27"></div>
                    <div class="carrusel-img-bg" data-img="assets/clientes/cliente28.jpg" aria-label="Cliente satisfecho 28"></div>
                    
                </div>
                <button class="carrusel-btn" id="carrusel-next" aria-label="Siguiente">&#8594;</button>
            </div>
            <p style="margin-top:0.7rem;color:#b8c6e0;font-size:1rem;">Desliza para ver más capturas de clientes reales. ¡Gracias por confiar en nosotros!</p>
        </div>
        
        <div class="reseñas-clientes">
            <h3 style="color:var(--azul-acento);margin:1.5rem 0 1rem;">Opiniones sobre nuestras camisetas</h3>
            <div class="lista-reseñas">
                <div class="reseña">
                    <p>"La calidad de la tela es increíble, se nota que es premium desde el primer uso. ¡Superó mis expectativas!"</p>
                </div>
                <div class="reseña">
                    <p>"Compré la del Barça y la verdad que los detalles están perfectamente cosidos. No se deshilacha como otras."</p>
                </div>
                <div class="reseña">
                    <p>"Llevo 3 meses usando la del Madrid y sigue como nueva después de tantos lavados. Calidad-precio imbatible."</p>
                </div>
                <div class="reseña">
                    <p>"Los logos y patrocinadores están bien pegados, no se levantan como en otras tiendas. Muy recomendable."</p>
                </div>
                <div class="reseña">
                    <p>"La transpiración es excelente, jugué un partido completo y no se pegó al cuerpo. ¡De las mejores que he tenido!"</p>
                </div>
            </div>
        </div>
        <div class="quienes-somos-grid">
            <div class="quienes-somos-card">
                <i class="fas fa-shield-alt"></i>
                <h3>Garantía de Pago</h3>
                <p>Transacciones seguras con protección al comprador</p>
            </div>
            <div class="quienes-somos-card">
                <i class="fas fa-shipping-fast"></i>
                <h3>Envío Express</h3>
                <p>Entrega en 1-2 semanas con seguimiento del paquete</p>
            </div>
            <div class="quienes-somos-card">
                <i class="fas fa-users"></i>
                <h3>Comunidad</h3>
                <p>+100 clientes satisfechos</p>
                <div class="stars">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                </div>
            </div>
            <div class="quienes-somos-card">
                <i class="fas fa-headset"></i>
                <h3>Atención al cliente</h3>
                <p>Obtén respuestas rápidas con nuestro servicio de atención al cliente</p>
            </div>
            <div class="quienes-somos-card">
                <i class="fas fa-tshirt"></i>
                <h3>Personalización</h3>
                <p>Elige nombre, número y detalles únicos para tu camiseta</p>
            </div>
            <div class="quienes-somos-card">
                <i class="fas fa-gem"></i>
                <h3>Calidad Premium</h3>
                <p>Materiales de alta gama y acabados profesionales en cada producto</p>
            </div>
        </div>
    </div>
</section>
    <section id="carrito" class="seccion" role="region" aria-label="Carrito de compras">
        <div class="cart-layout" role="group" aria-label="Carrito y recomendaciones">
            <aside id="cartPanel" class="cart-panel" aria-label="Carrito de compras">
                <div class="cart-header">
                    <h3>Tu Carrito</h3>
                    <div id="cartCount" class="cart-count" aria-hidden="true">0</div>
                </div>

                <div id="cartItems" class="cart-items">
                    <div class="cart-empty">Tu carrito está vacío<br><small>Agrega productos para empezar</small></div>
                </div>

                <div class="cart-divider" aria-hidden="true"></div>

                <div class="cart-totals">
                    <div class="tot-row"><span>Subtotal</span><span><strong id="cartSubtotal">0.00</strong></span></div>
                    <div class="tot-row"><span>Gastos envío</span><span id="cartShipping">2.00</span></div>
                    <div class="tot-row total"><span>Total</span><span id="cartTotal">0.00</span></div>
                </div>

                <div class="cart-actions">
                    <button id="clearCartGallery" class="btn-secondary">Vaciar</button>
                    <button id="gotoCheckoutBtn" class="btn-primary">Pagar</button>
                </div>

                <p class="cart-note">Antes de pagar se solicitará correo de PayPal, usuario de Instagram y dirección de envío.</p>
            </aside>
            <aside id="cartRecoPanel" class="cart-reco-panel" aria-label="Recomendaciones para ti">
                <div class="reco-header">
                    <h3>Te podría gustar</h3>
                    <div class="reco-nav">
                        <button class="reco-arrow" id="recoPrev" aria-label="Desplazar recomendaciones a la izquierda">‹</button>
                        <button class="reco-arrow" id="recoNext" aria-label="Desplazar recomendaciones a la derecha">›</button>
                    </div>
                </div>
                <div id="recoScroller" class="reco-scroller" tabindex="0" role="region" aria-label="Lista de recomendaciones desplazable horizontalmente"></div>
                <p class="reco-hint">Añade productos al carrito para ver recomendaciones.</p>
            </aside>
        </div>
        <style>
            
            #carrito .cart-layout { display:grid; grid-template-columns: 1fr; gap:16px; align-items:start; grid-template-areas: 'cart' 'reco'; }
            #carrito #cartPanel { grid-area: cart; }
            #carrito #cartRecoPanel { grid-area: reco; }
            #carrito { scroll-margin-top: 16px; }
            @media (min-width: 992px) { #carrito .cart-layout { grid-template-columns: minmax(520px, 1fr) clamp(320px, 28vw, 460px); grid-template-areas: 'cart reco'; } }
            #carrito .cart-panel { max-width: none; max-height: none; }
            @media (min-width: 992px) { #carrito .cart-panel { position: sticky; top: 16px; } }
             @media (min-width: 992px) { #carrito #cartRecoPanel { position: sticky; top: 16px; } }
            #carrito .cart-panel { margin-top: 0 !important; }
            #carrito #cartRecoPanel { background: rgba(10,31,61,0.9); border:1px solid rgba(46,123,237,0.12); border-radius:14px; padding:12px 12px 0px; }
            @media (min-width: 992px) { #carrito #cartRecoPanel { margin-top:16px !important; } }
            #carrito .reco-header { display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px; }
            #carrito .reco-header h3 { color:#fff; font-size:1.02rem; margin:0; }
            #carrito .reco-nav { display:flex; gap:8px; }
            #carrito .reco-arrow { background: transparent; border: 1px solid rgba(255,255,255,0.12); color:#d6e9ff; border-radius:8px; padding:6px 10px; cursor:pointer; }
            #carrito .reco-arrow:hover { background: rgba(255,255,255,0.07); }
            #carrito .reco-scroller { display:grid; grid-auto-flow: column; grid-auto-columns: minmax(160px, 1fr); gap:10px; overflow-x:auto; overflow-y:hidden; scroll-snap-type:x mandatory; padding-bottom:4px; }
            #carrito .reco-scroller::-webkit-scrollbar { height:8px; }
            #carrito .reco-scroller::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius:6px; }
            #carrito .reco-card { scroll-snap-align:start; background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03)); border:1px solid rgba(255,255,255,0.08); border-radius:12px; overflow:hidden; display:flex; flex-direction:column; cursor:pointer; }
            #carrito .reco-card img { width:100%; aspect-ratio:1/1; object-fit:cover; }
            #carrito .reco-meta { padding:8px 10px; color:#d6e9ff; min-height:64px; }
            #carrito .reco-name { font-weight:700; font-size:0.95rem; line-height:1.2; margin-bottom:4px; }
            #carrito .reco-price { color:#9fe0ff; font-weight:800; }
            #carrito .reco-actions { display:flex; gap:8px; padding:8px 10px 12px; }
            #carrito .reco-actions .btn-primary { flex:1; padding:8px 10px; border-radius:10px; }
            #carrito .reco-actions .btn-secondary { padding:8px 10px; border-radius:10px; }
            #carrito .reco-hint { color:#9fbfe8; font-size:0.9rem; margin-top:4px; text-align:center; }

            
            @media (max-width: 768px) {
                
                #carrito .cart-layout {
                    display: flex;
                    flex-direction: column;
                    gap: 16px;
                    padding: 0 clamp(8px, 2vw, 16px);
                    width: 100%;
                    box-sizing: border-box;
                }
                
                
                #carrito .cart-panel,
                #carrito #cartRecoPanel {
                    width: 100%;
                    max-width: 100%;
                    min-width: 0;
                    margin: 0;
                    border-radius: 12px;
                    box-sizing: border-box;
                    overflow: hidden;
                }
                
                #carrito .cart-panel {
                    padding: clamp(12px, 3vw, 16px);
                    background: rgba(10,31,61,0.95);
                    border: 1px solid rgba(46,123,237,0.12);
                }
                
                
                #carrito .cart-header {
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    gap: 12px;
                    padding: 8px 4px 12px;
                    margin-bottom: 8px;
                }
                
                #carrito .cart-header h3 {
                    font-size: clamp(1rem, 2.5vw, 1.15rem);
                    margin: 0;
                    white-space: nowrap;
                }
                
                
                #carrito .cart-items {
                    max-height: min(50vh, 400px);
                    overflow-y: auto;
                    margin-bottom: 12px;
                    padding-right: 4px;
                }
                
                
                #carrito .cart-item {
                    display: flex;
                    gap: clamp(8px, 2vw, 12px);
                    align-items: flex-start;
                    padding: clamp(8px, 2vw, 12px);
                    border-radius: 8px;
                    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
                    border: 1px solid rgba(255,255,255,0.03);
                    margin-bottom: 8px;
                    box-sizing: border-box;
                }
                
                #carrito .cart-item img {
                    width: clamp(48px, 12vw, 64px);
                    height: clamp(48px, 12vw, 64px);
                    object-fit: cover;
                    border-radius: 6px;
                    flex-shrink: 0;
                }
                
                #carrito .cart-item .meta {
                    flex: 1;
                    min-width: 0;
                    text-align: left;
                }
                
                #carrito .cart-item .meta b {
                    display: block;
                    color: #fff;
                    font-size: clamp(0.9rem, 2.2vw, 0.98rem);
                    margin-bottom: 2px;
                    line-height: 1.3;
                    word-break: break-word;
                    overflow-wrap: break-word;
                }
                
                #carrito .cart-item .meta small {
                    color: #bcd9ff;
                    font-size: clamp(0.8rem, 2vw, 0.9rem);
                    display: block;
                    line-height: 1.2;
                }
                
                #carrito .cart-item .meta .qty-row {
                    margin-top: 6px;
                    display: flex;
                    align-items: center;
                    gap: 6px;
                    flex-wrap: wrap;
                }
                
                #carrito .cart-item .meta .qty-row input {
                    width: clamp(44px, 10vw, 56px);
                    padding: 4px 6px;
                    border-radius: 6px;
                    border: 1px solid rgba(255,255,255,0.06);
                    background: transparent;
                    color: #fff;
                    text-align: center;
                    font-size: clamp(0.9rem, 2vw, 0.95rem);
                }
                
                
                #carrito .cart-item .meta + div {
                    display: flex;
                    flex-direction: column;
                    align-items: flex-end;
                    gap: 4px;
                    min-width: 60px;
                    flex-shrink: 0;
                }
                
                #carrito .cart-item .remove {
                    background: transparent;
                    border: none;
                    color: #ff8a8a;
                    cursor: pointer;
                    font-size: 1.1rem;
                    padding: 4px;
                    align-self: flex-end;
                }
                
                
                #carrito .cart-totals {
                    display: flex;
                    flex-direction: column;
                    gap: 6px;
                    padding: 8px 0;
                }
                
                #carrito .cart-totals .tot-row {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    color: #cfe8ff;
                    font-weight: 600;
                    font-size: clamp(0.9rem, 2.2vw, 1rem);
                    line-height: 1.4;
                }
                
                #carrito .cart-totals .tot-row.total {
                    font-size: clamp(1rem, 2.5vw, 1.16rem);
                    color: #fff;
                    font-weight: 800;
                    padding-top: 4px;
                    border-top: 1px solid rgba(255,255,255,0.08);
                }
                
                
                #carrito .cart-actions {
                    display: flex;
                    flex-direction: column;
                    gap: 8px;
                    margin-top: 12px;
                }
                
                #carrito .cart-actions .btn-primary,
                #carrito .cart-actions .btn-secondary {
                    width: 100%;
                    padding: clamp(10px, 2.5vw, 12px) clamp(12px, 3vw, 16px);
                    border-radius: 8px;
                    font-size: clamp(0.9rem, 2.2vw, 1rem);
                    min-height: 44px;
                    box-sizing: border-box;
                }
                
                
                #carrito #cartRecoPanel {
                    padding: 12px 12px 4px;
                    background: rgba(10,31,61,0.9);
                    border: 1px solid rgba(46,123,237,0.12);
                }
                
                #carrito .reco-header {
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    gap: 8px;
                    margin-bottom: 8px;
                    flex-wrap: wrap;
                }
                
                #carrito .reco-header h3 {
                    font-size: clamp(0.95rem, 2.3vw, 1.02rem);
                    margin: 0;
                }
                
                #carrito .reco-scroller {
                    display: grid;
                    grid-auto-flow: column;
                    grid-auto-columns: minmax(clamp(130px, 30vw, 160px), 1fr);
                    gap: clamp(6px, 1.5vw, 10px);
                    overflow-x: auto;
                    overflow-y: hidden;
                    scroll-snap-type: x mandatory;
                    padding-bottom: 4px;
                    -webkit-overflow-scrolling: touch;
                }
                
                #carrito .reco-card {
                    scroll-snap-align: start;
                    background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
                    border: 1px solid rgba(255,255,255,0.08);
                    border-radius: 8px;
                    overflow: hidden;
                    display: flex;
                    flex-direction: column;
                    cursor: pointer;
                    min-width: 0;
                }
                
                #carrito .reco-card img {
                    width: 100%;
                    aspect-ratio: 1/1;
                    object-fit: cover;
                    border-radius: 6px 6px 0 0;
                }
                
                #carrito .reco-meta {
                    padding: clamp(6px, 1.5vw, 8px);
                    color: #d6e9ff;
                    min-height: clamp(50px, 12vw, 64px);
                }
                
                #carrito .reco-name {
                    font-weight: 700;
                    font-size: clamp(0.85rem, 2vw, 0.95rem);
                    line-height: 1.2;
                    margin-bottom: 2px;
                }
                
                #carrito .reco-price {
                    color: #9fe0ff;
                    font-weight: 800;
                    font-size: clamp(0.85rem, 2vw, 0.9rem);
                }
                
                
                @media (max-width: 360px) {
                    #carrito .cart-layout {
                        padding: 0 6px;
                    }
                    
                    #carrito .cart-panel,
                    #carrito #cartRecoPanel {
                        border-radius: 8px;
                    }
                    
                    #carrito .cart-item {
                        padding: 6px;
                        gap: 6px;
                    }
                    
                    #carrito .cart-item img {
                        width: 42px;
                        height: 42px;
                    }
                }
            }
        </style>
        <script>
            (function(){
                const scroller = document.getElementById('recoScroller');
                const prev = document.getElementById('recoPrev');
                const next = document.getElementById('recoNext');
                if (!scroller) return;
                const scrollBy = () => Math.max(220, scroller.clientWidth * 0.8);
                prev && prev.addEventListener('click', () => scroller.scrollBy({ left: -scrollBy(), behavior: 'smooth' }));
                next && next.addEventListener('click', () => scroller.scrollBy({ left: scrollBy(), behavior: 'smooth' }));
                scroller.addEventListener('wheel', (e) => {
                    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {
                        scroller.scrollLeft += e.deltaY;
                        e.preventDefault();
                    }
                }, { passive: false });
            })();
        </script>
    </section>
    
    <section id="pedidos" class="seccion" role="region" aria-label="Proceso de pedido">
    
    <form id="pedidoForm" action="https://formsubmit.co/ac88c19c0b46633676d4b3e8db41dea8" method="POST" style="display:none;">
        <input type="hidden" name="_next" value="https://compra-exitosa.vercel.app/">
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_subject" value="Nuevo pedido con pago confirmado">
        <input type="hidden" name="_language" value="es">
        <input type="hidden" name="_template" value="table">
        <input type="hidden" name="precio_total" id="precioTotal">
        
        <input type="hidden" name="emailPaypal" id="form_emailPaypal">
        <input type="hidden" name="direccion" id="form_direccion">
        <input type="hidden" name="contactName" id="form_contactName">
        <input type="hidden" name="city" id="form_city">
        <input type="hidden" name="state" id="form_state">
        <input type="hidden" name="country" id="form_country">
        <input type="hidden" name="postal" id="form_postal">
        <input type="hidden" name="phone" id="form_phone">
        <input type="hidden" name="instagram" id="form_instagram">
    
    
    <input type="hidden" name="cart_items_text" id="form_cart_items_text">
    </form>
    <div class="product-gallery-ui">
    <div class="gallery-header"></div>

    <div id="productGallery" class="product-gallery" aria-live="polite"></div>

    
    </div>

    <style>
    
    
    #pedidos:not(.activa) .product-gallery-ui { display: none; }
    
    #pedidos.activa .product-gallery-ui {
        display: grid;
        grid-template-columns: 1fr;
        grid-template-rows: auto 1fr;
        grid-template-areas: "header" "gallery";
        gap: 22px;
        align-items: start;
    }
    .gallery-header { grid-area: header; }
    .product-gallery { grid-area: gallery; }
    .cart-panel { grid-area: cart; }
        .gallery-header h2 { color: var(--azul-acento); font-size: 2rem; margin: 0 0 6px; }
        .gallery-header p { color: #cfdff6; margin: 0 0 16px; }
          
        .product-gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 18px; width: 100%; }
          .product-gallery > .product-item:only-child { justify-self: start; max-width: 800px; }
    .product-item { background: rgba(255,255,255,0.03); border: 1px solid rgba(42,91,168,0.08); padding: 10px 12px; border-radius: 12px; text-align: center; transition: transform .12s, box-shadow .12s; max-width: 360px; box-sizing: border-box; cursor: pointer; align-items: stretch; display:flex; flex-direction:column; justify-content:space-between; overflow:hidden; }
        .product-item:hover { transform: translateY(-6px); box-shadow: 0 8px 30px rgba(42,91,168,0.12); }
    .product-item img { width: 100%; height: 160px; object-fit: cover; border-radius: 8px; }
        .product-item h4 { color: #fff; margin: 8px 0 6px; font-size: 1.04rem; }
        .product-item .price { color: #9fe0ff; font-weight: 900; margin: 6px 0; font-size:1.05rem; display:inline-block; background: rgba(15,56,100,0.12); padding:6px 10px; border-radius:8px; }
        .product-item .excerpt { color: #d6e9ff; font-size: 0.95rem; min-height: 0; margin-bottom:0; }
    .product-item .actions { display:flex; gap:8px; justify-content:center; margin-top:6px; }
        .btn-primary { background: linear-gradient(90deg,var(--azul-acento) 60%, #163a6b 100%); color: #fff; border: none; padding: 8px 12px; border-radius: 10px; cursor: pointer; }
        .btn-secondary { background: transparent; color: #d6e9ff; border: 1px solid rgba(255,255,255,0.06); padding: 8px 12px; border-radius: 10px; cursor: pointer; }

          
    .cart-panel { background: rgba(10,31,61,0.95); padding: 16px; border-radius: 14px; color: #e6f3ff; border: 1px solid rgba(46,123,237,0.12); position: relative; width: 100%; max-width: 420px; box-sizing: border-box; max-height: calc(100vh - 160px); overflow: auto; }
        .cart-header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
        .cart-header h3 { margin:0; color:#fff; font-size:1.15rem; letter-spacing:0.4px; }
        .cart-count { background:linear-gradient(90deg,#2e7bed,#144a85); color:#fff; padding:6px 10px; border-radius:999px; font-weight:800; font-size:0.9rem; box-shadow:0 6px 18px rgba(46,123,237,0.18); }
        .cart-items { max-height: 420px; overflow:auto; margin-bottom:12px; }
        .cart-empty { text-align:center; color:#9fbfe8; padding:24px 8px; border-radius:10px; background:rgba(255,255,255,0.02); }
        .cart-item { display:flex; gap:12px; align-items:flex-start; padding:10px; border-radius:10px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); margin-bottom:10px; border:1px solid rgba(255,255,255,0.03); width:100%; box-sizing:border-box; }
        .cart-item img { width:64px; height:64px; object-fit:cover; border-radius:8px; box-shadow: 0 6px 18px rgba(0,0,0,0.35); }
        .cart-item .meta { flex:1; text-align:left; min-width:0; }
        .cart-item .meta b { display:block; color:#fff; font-size:0.98rem; margin-bottom:4px; white-space:normal; overflow-wrap:anywhere; word-break:break-word; }
        .cart-item .meta small { color:#bcd9ff; display:block; font-size:0.9rem; }
        .cart-item .meta .qty-row { margin-top:6px; display:flex; align-items:center; gap:8px; }
        .cart-item .meta .qty-row input { width:56px; padding:6px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:transparent; color:#fff; text-align:center; }
        .cart-item .remove { background:transparent; border:none; color:#ff8a8a; cursor:pointer; font-size:1.05rem; padding:6px; }
        
        .cart-item .meta + div { flex: 0 0 auto; max-width: 52%; }
        .cart-item .meta + div > div { flex-wrap: wrap; }
        .cart-divider { height:1px; background:linear-gradient(90deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01)); margin:10px 0; border-radius:2px; }
        .cart-totals { display:flex; flex-direction:column; gap:8px; padding:6px 2px; }
        .cart-totals .tot-row { display:flex; justify-content:space-between; color:#cfe8ff; font-weight:700; }
        .cart-totals .tot-row.total { font-size:1.16rem; color:#fff; font-weight:900; }
        .cart-actions { display:flex; gap:8px; margin-top:10px; }
        .cart-actions .btn-primary { flex:1; }
        .cart-actions .btn-secondary { background:transparent; border:1px solid rgba(255,255,255,0.04); padding:10px 12px; border-radius:10px; color:#d6e9ff; }
        .cart-note { font-size:0.85rem; color:#bcd9ff; margin-top:8px; }

        
        .cart-promo-banner {
            position: fixed; 
            left: 0; top: 0; 
            width: auto; 
            box-sizing: border-box;
            padding: 10px 14px;
            border-radius: 12px;
            color: #fff;
            font-weight: 800;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            box-shadow: 0 10px 30px rgba(0,0,0,0.25), 0 1px 0 rgba(255,255,255,0.06) inset;
            opacity: 0;
            transform: translateY(-8px); 
            pointer-events: none; 
            z-index: 1195; 
            border: 1px solid rgba(255,255,255,0.12);
        }
        
        .cart-promo-banner.fast { transition: opacity 0.3s ease, transform 0.3s ease; }
        .cart-promo-banner.subtle { transition: opacity 0.45s ease, transform 0.45s ease; }
        .cart-promo-banner.visible { opacity: 1; transform: translateY(0); }
        
        .cart-promo-banner.theme-3 { background: linear-gradient(180deg, #ff9800 0%, #ff7a00 100%); }
        .cart-promo-banner.theme-5 { background: linear-gradient(180deg, #2ecc71 0%, #27ae60 100%); }
        .cart-promo-banner .promo-inner { display:flex; align-items:center; justify-content:center; gap:10px; font-size:0.95rem; line-height:1; }
    .cart-promo-banner .promo-badge { display:inline-flex; align-items:center; justify-content:center; background: rgba(255,255,255,0.16); padding: 6px 10px; border-radius: 999px; font-weight:900; letter-spacing:1px; text-transform:uppercase; color:#fff; font-size:0.95rem; }

        
        @media (min-width: 1201px) {
            
            #pedidos.activa .product-gallery-ui { display: grid; grid-template-columns: 1fr; grid-template-rows: auto 1fr; grid-template-areas: "header" "gallery"; gap: 22px; }
            .gallery-header { grid-area: header; }
            .product-gallery { grid-area: gallery; }
            
            .product-gallery { display: grid; grid-template-columns: repeat(4, 1fr); gap: 18px; padding-right: 0; width: 100%; }
            
            #pedidos .product-item { max-width: none; }
            #pedidos .product-item img { height: clamp(160px, 14vw, 240px); }
            
            .competition-products { grid-template-columns: repeat(3, 1fr); }
            
            .cart-panel { position: relative; right: 0; top: 0; width: 100%; max-width: 560px; align-self: start; transform: none; margin-top: 36px; }
            
            #pedidos.activa .product-gallery { padding-right: 0; }
        }
        @media (max-width: 1200px) {
            .product-gallery-ui { padding-right: 0; }
            .cart-panel { position: relative; width: 100%; right: 0; top: 0; z-index: auto; }
        }
    
    .checkout-input { width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;margin-bottom:8px }
    
    .product-item, .pedido-mini-card { display:flex; flex-direction:column; align-items:center; }
    .product-item > img, .pedido-mini-card img.pedido-carrusel-img { max-width:800px; width:100%; height:140px; object-fit:cover; border-radius:8px; }
    .pedido-mini-card { padding:4px; cursor: pointer; }
    .pedido-mini-card .thumb-img { display:none; }
    
    
    .gallery-controls {
        margin-top: 10px;
        margin-bottom: 20px;
        padding: 15px;
        background: rgba(5,25,55,0.6);
        border-radius: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 15px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        width: 100%;
        box-sizing: border-box;
    }
    
    .gallery-controls .league-filter,
    .gallery-controls .sort-order {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .gallery-controls select {
        padding: 8px 12px;
        border-radius: 6px;
        background: #071735;
        color: white;
        border: 1px solid #2e7bed;
        cursor: pointer;
        transition: all 0.3s ease;
        min-width: 180px;
    }
    
    .gallery-controls select:hover {
        border-color: var(--azul-acento);
        box-shadow: 0 0 8px rgba(46,123,237,0.5);
    }
    
    .gallery-controls label {
        color: #9fe0ff;
        font-weight: 500;
        white-space: nowrap;
    }
    
    @media (max-width: 768px) {
        .gallery-controls {
            flex-direction: column;
            align-items: flex-start;
        }
        
        .gallery-controls .league-filter,
        .gallery-controls .sort-order {
            width: 100%;
        }
        
        .gallery-controls select {
            width: 100%;
        }
    }
    </style>

    <style>
    
    @media (max-width: 900px) {
        
        #pedidos.activa .product-gallery-ui {
            display: grid;
            grid-template-columns: 1fr;
            grid-template-rows: auto 1fr auto;
            grid-template-areas: "header" "gallery" "cart";
            gap: 14px;
            padding-right: 0;
        }

        
        #pedidos .product-gallery { grid-template-columns: repeat(2, minmax(140px, 1fr)); gap: 12px; }
        #pedidos .product-item { padding: 12px; border-radius: 12px; max-width: none; }
        #pedidos .product-item img { height: 180px; object-fit: cover; border-radius: 8px; }

        
        #pedidos .gallery-header, #pedidos .gallery-controls { padding: 8px 6px; }

        
        #pedidos .cart-panel {
            position: fixed !important;
            left: 12px !important;
            right: 12px !important;
            bottom: 12px !important;
            top: auto !important;
            width: auto !important;
            max-width: none !important;
            max-height: 62vh !important;
            overflow: auto !important;
            border-radius: 12px !important;
            box-shadow: 0 12px 40px rgba(0,0,0,0.45) !important;
            transition: transform 0.22s ease, visibility 0.22s ease;
            z-index: 3001 !important;
            margin-top: 0 !important;
        }

        
        #pedidos .cart-panel.collapsed { transform: translateY(calc(100% - 64px)); }

        
        #pedidos .cart-header { cursor: pointer; padding: 12px 10px; }

        
        #pedidos .cart-actions { display:flex; gap:8px; }
        #pedidos .cart-actions .btn-primary, #pedidos .cart-actions .btn-secondary { padding: 12px; font-size: 1rem; border-radius: 10px; }

        
        #pedidos .cart-item { padding:10px; gap:10px; }
        #pedidos .cart-item img { width:56px; height:56px; }
        #pedidos .cart-items { max-height: calc(62vh - 180px); overflow:auto; }

        
        #pedidos .gallery-controls select, #pedidos .product-search-wrap input { padding: 12px 10px; font-size: 1rem; }
    }
    </style>

    <script>

        const PRODUCTS = [
    { id: 'barca1', name: 'Camiseta Local Barcelona 25/26', price: 19.90, img: 'assets/productos/La Liga/Barcelona2526L/1.jpg', images: [
        'assets/productos/La Liga/Barcelona2526L/1.jpg',
        'assets/productos/La Liga/Barcelona2526L/2.jpg',
        'assets/productos/La Liga/Barcelona2526L/3.jpg',
        'assets/productos/La Liga/Barcelona2526L/4.jpg',
        'assets/productos/La Liga/Barcelona2526L/5.jpg'
    ], excerpt: '', link: 'productos/barcelona2526L.html' },

    { id: 'realm1', name: 'Camiseta Local Real Madrid 25/26', price: 19.90, img: 'assets/productos/La Liga/RealMadrid2526L/1.jpg', images: [
        'assets/productos/La Liga/RealMadrid2526L/1.jpg',
        'assets/productos/La Liga/RealMadrid2526L/2.jpg',
        'assets/productos/La Liga/RealMadrid2526L/3.jpg',
        'assets/productos/La Liga/RealMadrid2526L/4.jpg'
    ], excerpt: '', link: 'productos/realmadrid2526L.html' },

    { id: 'athl1', name: 'Camiseta Local Athletic Club 25/26', price: 19.90, img: 'assets/productos/La Liga/Athletic2526L/1.jpg', images: [
        'assets/productos/La Liga/Athletic2526L/1.jpg',
        'assets/productos/La Liga/Athletic2526L/2.jpg',
        'assets/productos/La Liga/Athletic2526L/3.jpg',
        'assets/productos/La Liga/Athletic2526L/4.jpg'
    ], excerpt: '', link: 'productos/athletic2526L.html' },

    { id: 'atletico0203', name: 'Camiseta Retro Atlético 02/03', price: 24.90, img: 'assets/productos/La Liga/Atletico0203LR/1.jpg', images: [
        'assets/productos/La Liga/Atletico0203LR/1.jpg',
        'assets/productos/La Liga/Atletico0203LR/2.jpg',
        'assets/productos/La Liga/Atletico0203LR/3.jpg'
    ], excerpt: '', link: 'productos/atletico0203.html', versions: ['fan'], isRetro: true },

    { id: 'athl0103F', name: 'Camiseta Retro Athletic 01/03 Visitante', price: 24.90, img: 'assets/productos/La Liga/Athletic0103FR/1.jpg', images: [
        'assets/productos/La Liga/Athletic0103FR/1.jpg',
        'assets/productos/La Liga/Athletic0103FR/2.jpg',
        'assets/productos/La Liga/Athletic0103FR/3.jpg',
        'assets/productos/La Liga/Athletic0103FR/4.jpg'
    ], excerpt: '', link: 'productos/athletic0103FR.html', versions: ['fan'], isRetro: true },

    { id: 'atleticoL', name: 'Camiseta Local Atlético 25/26', price: 19.90, img: 'assets/productos/La Liga/Atletico2526L/1.jpg', images: [
        'assets/productos/La Liga/Atletico2526L/1.jpg',
        'assets/productos/La Liga/Atletico2526L/2.jpg',
        'assets/productos/La Liga/Atletico2526L/3.jpg',
        'assets/productos/La Liga/Atletico2526L/4.jpg'
    ], excerpt: '', link: 'productos/atletico2526L.html' },

    { id: 'atleticoF2', name: 'Camiseta Visitante Atlético 25/26', price: 19.90, img: 'assets/productos/La Liga/Atletico2526F/1.jpg', images: [
        'assets/productos/La Liga/Atletico2526F/1.jpg',
        'assets/productos/La Liga/Atletico2526F/2.jpg',
        'assets/productos/La Liga/Atletico2526F/3.jpg',
        'assets/productos/La Liga/Atletico2526F/4.jpg'
    ], excerpt: '', link: 'productos/atletico2526F.html' },

    { id: 'betisL', name: 'Camiseta Local Betis 25/26', price: 19.90, img: 'assets/productos/La Liga/Betis2526L/1.jpg', images: [
        'assets/productos/La Liga/Betis2526L/1.jpg',
        'assets/productos/La Liga/Betis2526L/2.jpg',
        'assets/productos/La Liga/Betis2526L/3.jpg',
        'assets/productos/La Liga/Betis2526L/4.jpg'
    ], excerpt: '', link: 'productos/betis2526L.html' },
    { id: 'Barcelona2526F', name: 'Camiseta Visitante Barcelona 25/26', price: 19.90, img: 'assets/productos/La Liga/Barcelona2526F/1.jpg', images: [
        'assets/productos/La Liga/Barcelona2526F/1.jpg',
        'assets/productos/La Liga/Barcelona2526F/2.jpg',
        'assets/productos/La Liga/Barcelona2526F/3.jpg',
        'assets/productos/La Liga/Barcelona2526F/4.jpg'
    ], excerpt: '', link: 'productos/Barcelona2526F.html' },

    { id: 'celtaL', name: 'Camiseta Local Celta 25/26', price: 19.90, img: 'assets/productos/La Liga/Celta2526L/1.jpg', images: [
        'assets/productos/La Liga/Celta2526L/1.jpg',
        'assets/productos/La Liga/Celta2526L/2.jpg',
        'assets/productos/La Liga/Celta2526L/3.jpg',
        'assets/productos/La Liga/Celta2526L/4.jpg'
    ], excerpt: '', link: 'productos/celta2526L.html' },

    { id: 'elcheF', name: 'Camiseta Visitante Elche 25/26', price: 19.90, img: 'assets/productos/La Liga/Elche2526F/1.jpg', images: [
        'assets/productos/La Liga/Elche2526F/1.jpg',
        'assets/productos/La Liga/Elche2526F/2.jpg',
        'assets/productos/La Liga/Elche2526F/3.jpg',
        'assets/productos/La Liga/Elche2526F/4.jpg'
    ], excerpt: '', link: 'productos/Elche2526F.html' },

    { id: 'elcheL', name: 'Camiseta Local Elche 25/26', price: 19.90, img: 'assets/productos/La Liga/Elche2526L/1.jpeg', images: [
        'assets/productos/La Liga/Elche2526L/1.jpeg',
        'assets/productos/La Liga/Elche2526L/2.jpeg',
        'assets/productos/La Liga/Elche2526L/3.jpeg'
    ], excerpt: '', link: 'productos/Elche2526L.html' },

    { id: 'espanyolLR', name: 'Camiseta Retro Espanyol 99/00 Local', price: 24.90, img: 'assets/productos/La Liga/Espanyol9920LR/1.jpg', images: [
        'assets/productos/La Liga/Espanyol9920LR/1.jpg',
        'assets/productos/La Liga/Espanyol9920LR/2.jpg',
        'assets/productos/La Liga/Espanyol9920LR/3.jpg',
        'assets/productos/La Liga/Espanyol9920LR/4.jpg'
    ], excerpt: '', link: 'productos/espanyol9920LR.html', versions: ['fan'], isRetro: true },

    { id: 'getafeL', name: 'Camiseta Local Getafe 25/26', price: 19.90, img: 'assets/productos/La Liga/Getafe2526L/1.png', images: [
        'assets/productos/La Liga/Getafe2526L/1.png',
        'assets/productos/La Liga/Getafe2526L/2.png'
    ], excerpt: '', link: 'productos/getafe2526L.html' },

    { id: 'gironaL', name: 'Camiseta Local Girona 25/26', price: 19.90, img: 'assets/productos/La Liga/Girona2526L/1.jpg', images: [
        'assets/productos/La Liga/Girona2526L/1.jpg',
        'assets/productos/La Liga/Girona2526L/2.jpg',
        'assets/productos/La Liga/Girona2526L/3.jpg',
        'assets/productos/La Liga/Girona2526L/4.jpg'
    ], excerpt: '', link: 'productos/girona2526L.html' },

    { id: 'granadaL', name: 'Camiseta Local Granada 25/26', price: 19.90, img: 'assets/productos/La Liga/Granada2526L/1.jpg', images: [
        'assets/productos/La Liga/Granada2526L/1.jpg',
        'assets/productos/La Liga/Granada2526L/2.jpg',
        'assets/productos/La Liga/Granada2526L/3.jpg',
        'assets/productos/La Liga/Granada2526L/4.jpg'
    ], excerpt: '', link: 'productos/granada2526L.html' },

    { id: 'laspalmasL', name: 'Camiseta Local Las Palmas 25/26', price: 19.90, img: 'assets/productos/La Liga/LasPalmas2526L/1.jpg', images: [
        'assets/productos/La Liga/LasPalmas2526L/1.jpg',
        'assets/productos/La Liga/LasPalmas2526L/2.jpg',
        'assets/productos/La Liga/LasPalmas2526L/3.jpg',
        'assets/productos/La Liga/LasPalmas2526L/4.jpg'
    ], excerpt: '', link: 'productos/laspalmas2526L.html' },

    { id: 'leganesL', name: 'Camiseta Local Leganés 25/26', price: 19.90, img: 'assets/productos/La Liga/Leganes2526L/1.jpg', images: [
        'assets/productos/La Liga/Leganes2526L/1.jpg',
        'assets/productos/La Liga/Leganes2526L/2.jpg',
        'assets/productos/La Liga/Leganes2526L/3.jpg',
        'assets/productos/La Liga/Leganes2526L/4.jpg'
    ], excerpt: '', link: 'productos/leganes2526L.html' },

    { id: 'levanteL', name: 'Camiseta Local Levante 25/26', price: 19.90, img: 'assets/productos/La Liga/Levante2526L/1.jpeg', images: [
        'assets/productos/La Liga/Levante2526L/1.jpeg',
        'assets/productos/La Liga/Levante2526L/2.jpeg',
        'assets/productos/La Liga/Levante2526L/3.jpeg',
        'assets/productos/La Liga/Levante2526L/4.jpeg'
    ], excerpt: '', link: 'productos/levante2526L.html' },

    { id: 'malagaL', name: 'Camiseta Local Málaga 25/26', price: 19.90, img: 'assets/productos/La Liga/Malaga2526L/1.jpg', images: [
        'assets/productos/La Liga/Malaga2526L/1.jpg',
        'assets/productos/La Liga/Malaga2526L/2.jpg',
        'assets/productos/La Liga/Malaga2526L/3.jpg',
        'assets/productos/La Liga/Malaga2526L/4.jpg'
    ], excerpt: '', link: 'productos/malaga2526L.html' },

    { id: 'mallorcaL', name: 'Camiseta Local Mallorca 25/26', price: 19.90, img: 'assets/productos/La Liga/Mallorca2526L/1.jpg', images: [
        'assets/productos/La Liga/Mallorca2526L/1.jpg',
        'assets/productos/La Liga/Mallorca2526L/2.jpg',
        'assets/productos/La Liga/Mallorca2526L/3.jpg',
        'assets/productos/La Liga/Mallorca2526L/4.jpg'
    ], excerpt: '', link: 'productos/mallorca2526L.html' },

    { id: 'osasunaL', name: 'Camiseta Local Osasuna 25/26', price: 19.90, img: 'assets/productos/La Liga/Osasuna2526L/1.png', images: [
        'assets/productos/La Liga/Osasuna2526L/1.png',
        'assets/productos/La Liga/Osasuna2526L/2.png'
    ], excerpt: '', link: 'productos/osasuna2526L.html' },

    { id: 'oviedoL', name: 'Camiseta Local Oviedo 25/26', price: 19.90, img: 'assets/productos/La Liga/Oviedo2526L/1.jpg', images: [
        'assets/productos/La Liga/Oviedo2526L/1.jpg',
        'assets/productos/La Liga/Oviedo2526L/2.jpg',
        'assets/productos/La Liga/Oviedo2526L/3.jpg',
        'assets/productos/La Liga/Oviedo2526L/4.jpg'
    ], excerpt: '', link: 'productos/oviedo2526L.html' },

    { id: 'rayoL', name: 'Camiseta Local Rayo Vallecano 25/26', price: 19.90, img: 'assets/productos/La Liga/Rayo2526L/1.jpg', images: [
        'assets/productos/La Liga/Rayo2526L/1.jpg',
        'assets/productos/La Liga/Rayo2526L/2.jpg'
    ], excerpt: '', link: 'productos/rayo2526L.html' },

    { id: 'realmF', name: 'Camiseta Visitante Real Madrid 25/26', price: 19.90, img: 'assets/productos/La Liga/RealMadrid2526F/1.jpg', images: [
        'assets/productos/La Liga/RealMadrid2526F/1.jpg',
        'assets/productos/La Liga/RealMadrid2526F/2.jpg',
        'assets/productos/La Liga/RealMadrid2526F/3.jpg',
        'assets/productos/La Liga/RealMadrid2526F/4.jpg'
    ], excerpt: '', link: 'productos/realmadrid2526F.html' },

    { id: 'realmT', name: 'Camiseta Tercera Real Madrid 25/26', price: 19.90, img: 'assets/productos/La Liga/RealMadrid2526T/1.jpg', images: [
        'assets/productos/La Liga/RealMadrid2526T/1.jpg',
        'assets/productos/La Liga/RealMadrid2526T/2.jpg',
        'assets/productos/La Liga/RealMadrid2526T/3.jpg',
        'assets/productos/La Liga/RealMadrid2526T/4.jpg'
    ], excerpt: '', link: 'productos/realmadrid2526T.html' },

    { id: 'realsociedadL', name: 'Camiseta Local Real Sociedad 25/26', price: 19.90, img: 'assets/productos/La Liga/RealSociedad2526L/1.jpg', images: [
        'assets/productos/La Liga/RealSociedad2526L/1.jpg',
        'assets/productos/La Liga/RealSociedad2526L/2.jpg',
        'assets/productos/La Liga/RealSociedad2526L/3.jpg',
        'assets/productos/La Liga/RealSociedad2526L/4.jpg'
    ], excerpt: '', link: 'productos/realsociedad2526L.html' },

    { id: 'sevillaF', name: 'Camiseta Visitante Sevilla 25/26', price: 19.90, img: 'assets/productos/La Liga/Sevilla2526F/1.jpg', images: [
        'assets/productos/La Liga/Sevilla2526F/1.jpg',
        'assets/productos/La Liga/Sevilla2526F/2.jpg',
        'assets/productos/La Liga/Sevilla2526F/3.jpg',
        'assets/productos/La Liga/Sevilla2526F/4.jpg'
    ], excerpt: '', link: 'productos/sevilla2526F.html' },

    { id: 'sevillaT', name: 'Camiseta Tercera Sevilla 25/26', price: 19.90, img: 'assets/productos/La Liga/Sevilla2526T/1.jpg', images: [
        'assets/productos/La Liga/Sevilla2526T/1.jpg',
        'assets/productos/La Liga/Sevilla2526T/2.jpg',
        'assets/productos/La Liga/Sevilla2526T/3.jpg',
        'assets/productos/La Liga/Sevilla2526T/4.jpg'
    ], excerpt: '', link: 'productos/sevilla2526T.html' },

    { id: 'valenciaL', name: 'Camiseta Local Valencia 25/26', price: 19.90, img: 'assets/productos/La Liga/Valencia2526L/1.jpg', images: [
        'assets/productos/La Liga/Valencia2526L/1.jpg',
        'assets/productos/La Liga/Valencia2526L/2.jpg',
        'assets/productos/La Liga/Valencia2526L/3.jpg',
        'assets/productos/La Liga/Valencia2526L/4.jpg'
    ], excerpt: '', link: 'productos/valencia2526L.html' },

    { id: 'valladolidL', name: 'Camiseta Local Valladolid 25/26', price: 19.90, img: 'assets/productos/La Liga/Valladolid2526L/1.jpg', images: [
        'assets/productos/La Liga/Valladolid2526L/1.jpg',
        'assets/productos/La Liga/Valladolid2526L/2.jpg',
        'assets/productos/La Liga/Valladolid2526L/3.jpg',
        'assets/productos/La Liga/Valladolid2526L/4.jpg'
    ], excerpt: '', link: 'productos/valladolid2526L.html' },
    
    { id: 'alavesL', name: 'Camiseta Local Alavés 25/26', price: 19.90, img: 'assets/productos/La Liga/Alaves2526L/1.jpg', images: [
        'assets/productos/La Liga/Alaves2526L/1.jpg',
        'assets/productos/La Liga/Alaves2526L/2.jpg',
    ], excerpt: '', link: 'productos/alaves2526L.html' },

    { id: 'villarrealL', name: 'Camiseta Local Villarreal 25/26', price: 19.90, img: 'assets/productos/La Liga/Villarreal2526L/1.jpg', images: [
        'assets/productos/La Liga/Villarreal2526L/1.jpg',
        'assets/productos/La Liga/Villarreal2526L/2.jpg',
        'assets/productos/La Liga/Villarreal2526L/3.jpg',
        'assets/productos/La Liga/Villarreal2526L/4.jpg'
    ], excerpt: '', link: 'productos/villarreal2526L.html' },
    { id: 'munich2526L', name: 'Camiseta Local Bayern Munich 25/26', price: 19.90, img: 'assets/productos/Bundesliga/Munich2526L/1.jpg', images: [
        'assets/productos/Bundesliga/Munich2526L/1.jpg',
        'assets/productos/Bundesliga/Munich2526L/2.jpg',
        'assets/productos/Bundesliga/Munich2526L/3.jpg',
        'assets/productos/Bundesliga/Munich2526L/4.jpg'
    ], excerpt: '', link: 'productos/munich2526L.html' },
    { id: 'Paris2526L', name: 'Camiseta Local PSG 25/26', price: 19.90, img: 'assets/productos/Ligue 1/PSG2526L/1.jpg', images: [
        'assets/productos/Ligue 1/PSG2526L/1.jpg',
        'assets/productos/Ligue 1/PSG2526L/2.jpg',
        'assets/productos/Ligue 1/PSG2526L/3.jpg',
        'assets/productos/Ligue 1/PSG2526L/4.jpg'
    ], excerpt: '', link: 'productos/Paris2526L.html' },
    { id: 'CrystalPalace2526L', name: 'Camiseta Local Crystal Palace 25/26', price: 19.90, img: 'assets/productos/Premier League/CrystalPalace2526L/1.jpg', images: [
        'assets/productos/Premier League/CrystalPalace2526L/1.jpg',
        'assets/productos/Premier League/CrystalPalace2526L/2.jpg',
        'assets/productos/Premier League/CrystalPalace2526L/3.jpg',
        'assets/productos/Premier League/CrystalPalace2526L/4.jpg'
    ], excerpt: '', link: 'productos/CrystalPalace2526L.html' },
    { id: 'Milan9798LR', name: 'Camiseta Retro Milan 97/98 Local', price: 24.90, img: 'assets/productos/Serie A/Milan9798LR/1.jpg', images: [
        'assets/productos/Serie A/Milan9798LR/1.jpg',
        'assets/productos/Serie A/Milan9798LR/2.jpg',
        'assets/productos/Serie A/Milan9798LR/3.jpg',
        'assets/productos/Serie A/Milan9798LR/4.jpg'
    ], excerpt: '', link: 'productos/Milan9798LR.html', versions: ['fan'], isRetro: true },

    { id: 'atleticoKids2526F', name: 'Camiseta Visitante Atlético 25/26 (niños)', price: 21.90, img: 'assets/productos/La Liga/AtleticoKids2526F/1.jpg', images: [
        'assets/productos/La Liga/AtleticoKids2526F/1.jpg',
        'assets/productos/La Liga/AtleticoKids2526F/2.jpg',
        'assets/productos/La Liga/AtleticoKids2526F/3.jpg',
        'assets/productos/La Liga/AtleticoKids2526F/4.jpg'
    ], excerpt: '', link: 'productos/AtleticoKids2526F.html' },

    { id: 'athleticKids2526T', name: 'Camiseta Tercera Athletic Club 25/26 (niños)', price: 21.90, img: 'assets/productos/La Liga/AthelticKids2526T/1.jpg', images: [
        'assets/productos/La Liga/AthelticKids2526T/1.jpg',
        'assets/productos/La Liga/AthelticKids2526T/2.jpg',
        'assets/productos/La Liga/AthelticKids2526T/3.jpg'
    ], excerpt: '', link: 'productos/AthleticKids2526T.html' },

    { id: 'marseillaKids2526F', name: 'Camiseta Visitante Marsella 25/26 (niños)', price: 21.90, img: 'assets/productos/Ligue 1/MarseillaKids2526F/1.jpg', images: [
        'assets/productos/Ligue 1/MarseillaKids2526F/1.jpg',
        'assets/productos/Ligue 1/MarseillaKids2526F/2.jpg',
        'assets/productos/Ligue 1/MarseillaKids2526F/3.jpg',
        'assets/productos/Ligue 1/MarseillaKids2526F/4.jpg'
    ], excerpt: '', link: 'productos/MarseillaKids2526F.html' },

    { id: 'unitedKids2526F', name: 'Camiseta Visitante Manchester United 25/26 (niños)', price: 21.90, img: 'assets/productos/Premier League/UnitedKids2526F/1.jpg', images: [
        'assets/productos/Premier League/UnitedKids2526F/1.jpg',
        'assets/productos/Premier League/UnitedKids2526F/2.jpg',
        'assets/productos/Premier League/UnitedKids2526F/3.jpg',
        'assets/productos/Premier League/UnitedKids2526F/4.jpg'
    ], excerpt: '', link: 'productos/UnitedKids2526F.html' },

    { id: 'nbaLakers1', name: 'Camiseta NBA Lakers (Modelo 1)', price: 24.90, img: 'assets/productos/NBA/Lakers1/1.jpeg', images: [
        'assets/productos/NBA/Lakers1/1.jpeg',
        'assets/productos/NBA/Lakers1/2.jpeg'
    ], excerpt: '', link: 'productos/Lakers1.html' },

    { id: 'nbaOklahoma1', name: 'Camiseta NBA Oklahoma (Modelo 1)', price: 24.90, img: 'assets/productos/NBA/Oklahoma/1.jpeg', images: [
        'assets/productos/NBA/Oklahoma/1.jpeg',
        'assets/productos/NBA/Oklahoma/2.jpeg'
    ], excerpt: '', link: 'productos/Oklahoma.html' },

    { id: 'nbaPhila1', name: 'Camiseta NBA Philadelphia (Modelo 1)', price: 24.90, img: 'assets/productos/NBA/Phila1/1.jpeg', images: [
        'assets/productos/NBA/Phila1/1.jpeg',
        'assets/productos/NBA/Phila1/2.jpeg',
        'assets/productos/NBA/Phila1/3.jpeg'
    ], excerpt: '', link: 'productos/Phila1.html' },

    { id: 'Barcelona2526T', name: 'Camiseta Tercera Barcelona 25/26', price: 19.90, img: 'assets/productos/La Liga/Barcelona2526T/1.jpg', images: [
        'assets/productos/La Liga/Barcelona2526T/1.jpg',
        'assets/productos/La Liga/Barcelona2526T/2.jpg',
        'assets/productos/La Liga/Barcelona2526T/3.jpg',
        'assets/productos/La Liga/Barcelona2526T/4.jpg'
    ], excerpt: '', link: 'productos/Barcelona2526T.html' },

    { id: 'LasPalmas2526F', name: 'Camiseta Visitante Las Palmas 25/26', price: 19.90, img: 'assets/productos/La Liga/LasPalmas2526F/1.jpg', images: [
        'assets/productos/La Liga/LasPalmas2526F/1.jpg',
        'assets/productos/La Liga/LasPalmas2526F/2.jpg',
        'assets/productos/La Liga/LasPalmas2526F/3.jpg',
        'assets/productos/La Liga/LasPalmas2526F/4.jpg'
    ], excerpt: '', link: 'productos/LasPalmas2526F.html' },

    { id: 'Atletico9596TR', name: 'Camiseta Retro Atlético 95/96 Tercera', price: 24.90, img: 'assets/productos/La Liga/Atletico9596TR/1.jpg', images: [
        'assets/productos/La Liga/Atletico9596TR/1.jpg',
        'assets/productos/La Liga/Atletico9596TR/2.jpg',
        'assets/productos/La Liga/Atletico9596TR/3.jpg',
        'assets/productos/La Liga/Atletico9596TR/4.jpg'
    ], excerpt: '', link: 'productos/atletico9596TR.html', versions: ['fan'], isRetro: true },

    { id: 'Barcelona9697LR', name: 'Camiseta Retro Barcelona 96/97 Local', price: 24.90, img: 'assets/productos/La Liga/Barcelona9697LR/1.jpg', images: [
        'assets/productos/La Liga/Barcelona9697LR/1.jpg',
        'assets/productos/La Liga/Barcelona9697LR/2.jpg',
        'assets/productos/La Liga/Barcelona9697LR/3.jpg',
        'assets/productos/La Liga/Barcelona9697LR/4.jpg'
    ], excerpt: '', link: 'productos/barcelona9697LR.html', versions: ['fan'], isRetro: true },

    { id: 'Sevilla2526L', name: 'Camiseta Local Sevilla 25/26', price: 19.90, img: 'assets/productos/La Liga/Sevilla2526L/1.jpg', images: [
        'assets/productos/La Liga/Sevilla2526L/1.jpg',
        'assets/productos/La Liga/Sevilla2526L/2.jpg',
        'assets/productos/La Liga/Sevilla2526L/3.jpg',
        'assets/productos/La Liga/Sevilla2526L/4.jpg'
    ], excerpt: '', link: 'productos/Sevilla2526L.html' },

    { id: 'Schalke2526L', name: 'Camiseta Local Schalke 25/26', price: 19.90, img: 'assets/productos/Bundesliga/Schalke2526L/1.jpg', images: [
        'assets/productos/Bundesliga/Schalke2526L/1.jpg',
        'assets/productos/Bundesliga/Schalke2526L/2.jpg',
        'assets/productos/Bundesliga/Schalke2526L/3.jpg',
        'assets/productos/Bundesliga/Schalke2526L/4.jpg'
    ], excerpt: '', link: 'productos/Schalke2526L.html' },

    { id: 'Flamengo2526T', name: 'Camiseta Tercera Flamengo 25/26', price: 19.90, img: 'assets/productos/Brasileirão Série A/Flamengo2526T/1.jpg', images: [
        'assets/productos/Brasileirão Série A/Flamengo2526T/1.jpg',
        'assets/productos/Brasileirão Série A/Flamengo2526T/2.jpg',
        'assets/productos/Brasileirão Série A/Flamengo2526T/3.jpg',
        'assets/productos/Brasileirão Série A/Flamengo2526T/4.jpg'
    ], excerpt: '', link: 'productos/Flamengo2526T.html' },

    { id: 'AlNassr2526L', name: 'Camiseta Local Al-Nassr 25/26', price: 19.90, img: 'assets/productos/Liga Arabe/Al-Nassr2526L/1.jpg', images: [
        'assets/productos/Liga Arabe/Al-Nassr2526L/1.jpg',
        'assets/productos/Liga Arabe/Al-Nassr2526L/2.jpg',
        'assets/productos/Liga Arabe/Al-Nassr2526L/3.jpg',
        'assets/productos/Liga Arabe/Al-Nassr2526L/4.jpg'
    ], excerpt: '', link: 'productos/AlNassr2526L.html' },

    { id: 'Boca0102LR', name: 'Camiseta Retro Boca Juniors 01/02 Local', price: 24.90, img: 'assets/productos/SAF (Argentina)/Boca0102LR/1.jpeg', images: [
        'assets/productos/SAF (Argentina)/Boca0102LR/1.jpeg',
        'assets/productos/SAF (Argentina)/Boca0102LR/2.jpeg',
        'assets/productos/SAF (Argentina)/Boca0102LR/3.jpeg'
    ], excerpt: '', link: 'productos/Boca0102LR.html', versions: ['fan'], isRetro: true },

    { id: 'Monaco2526F', name: 'Camiseta Visitante Monaco 25/26', price: 19.90, img: 'assets/productos/Ligue 1/Monaco2526F/1.jpg', images: [
        'assets/productos/Ligue 1/Monaco2526F/1.jpg',
        'assets/productos/Ligue 1/Monaco2526F/2.jpg',
        'assets/productos/Ligue 1/Monaco2526F/3.jpg',
        'assets/productos/Ligue 1/Monaco2526F/4.jpg'
    ], excerpt: '', link: 'productos/Monaco2526F.html' },

    { id: 'Lazio2526F', name: 'Camiseta Visitante Lazio 25/26', price: 19.90, img: 'assets/productos/Serie A/Lazio2526F/1.jpg', images: [
        'assets/productos/Serie A/Lazio2526F/1.jpg',
        'assets/productos/Serie A/Lazio2526F/2.jpg',
        'assets/productos/Serie A/Lazio2526F/3.jpg',
        'assets/productos/Serie A/Lazio2526F/4.jpg'
    ], excerpt: '', link: 'productos/Lazio2526F.html' },

    { id: 'RomaKids2526L', name: 'Camiseta Local Roma 25/26 (niños)', price: 21.90, img: 'assets/productos/Serie A/RomaKids2526L/1.jpg', images: [
        'assets/productos/Serie A/RomaKids2526L/1.jpg',
        'assets/productos/Serie A/RomaKids2526L/2.jpg',
        'assets/productos/Serie A/RomaKids2526L/3.jpg'
    ], excerpt: '', link: 'productos/RomaKids2526L.html' },

    { id: 'Espana0809LR', name: 'Camiseta Retro España 08/09 Local', price: 24.90, img: 'assets/productos/Internacional/España0809LR/1.jpeg', images: [
        'assets/productos/Internacional/España0809LR/1.jpeg',
        'assets/productos/Internacional/España0809LR/2.jpeg',
        'assets/productos/Internacional/España0809LR/3.jpeg',
        'assets/productos/Internacional/España0809LR/4.jpeg'
    ], excerpt: '', link: 'productos/Espana0809LR.html', versions: ['fan'], isRetro: true },

    { id: 'Espana2425L', name: 'Camiseta Local España 24/25', price: 19.90, img: 'assets/productos/Internacional/España2425L/1.jpg', images: [
        'assets/productos/Internacional/España2425L/1.jpg',
        'assets/productos/Internacional/España2425L/2.jpg',
        'assets/productos/Internacional/España2425L/3.jpg',
        'assets/productos/Internacional/España2425L/4.jpg'
    ], excerpt: '', link: 'productos/Espana2425L.html' },

    { id: 'Francia9899LR', name: 'Camiseta Retro Francia 98/99 Local', price: 24.90, img: 'assets/productos/Internacional/Francia9899LR/1.jpg', images: [
        'assets/productos/Internacional/Francia9899LR/1.jpg',
        'assets/productos/Internacional/Francia9899LR/2.jpg',
        'assets/productos/Internacional/Francia9899LR/3.jpg',
        'assets/productos/Internacional/Francia9899LR/4.jpg'
    ], excerpt: '', link: 'productos/Francia9899LR.html', versions: ['fan'], isRetro: true },

    { id: 'Holanda9899LR', name: 'Camiseta Retro Holanda 98/99 Local', price: 24.90, img: 'assets/productos/Internacional/Holanda9899LR/1.jpg', images: [
        'assets/productos/Internacional/Holanda9899LR/1.jpg',
        'assets/productos/Internacional/Holanda9899LR/2.jpg',
        'assets/productos/Internacional/Holanda9899LR/3.jpg'
    ], excerpt: '', link: 'productos/Holanda9899LR.html', versions: ['fan'], isRetro: true },

    { id: 'PSG2526T', name: 'Camiseta Tercera PSG 25/26', price: 19.90, img: 'assets/productos/Ligue 1/PSG2526T/1.jpg', images: [
        'assets/productos/Ligue 1/PSG2526T/1.jpg',
        'assets/productos/Ligue 1/PSG2526T/2.jpg',
        'assets/productos/Ligue 1/PSG2526T/3.jpg',
        'assets/productos/Ligue 1/PSG2526T/4.jpg'
    ], excerpt: '', link: 'productos/PSG2526T.html' },

    { id: 'Arsenal2525L', name: 'Camiseta Local Arsenal 25/25', price: 19.90, img: 'assets/productos/Premier League/Arsenal2525L/1.jpg', images: [
        'assets/productos/Premier League/Arsenal2525L/1.jpg',
        'assets/productos/Premier League/Arsenal2525L/2.jpg',
        'assets/productos/Premier League/Arsenal2525L/3.jpg',
        'assets/productos/Premier League/Arsenal2525L/4.jpg'
    ], excerpt: '', link: 'productos/Arsenal2525L.html' },

    { id: 'Arsenal2526F', name: 'Camiseta Visitante Arsenal 25/26', price: 19.90, img: 'assets/productos/Premier League/Arsenal2526F/1.jpg', images: [
        'assets/productos/Premier League/Arsenal2526F/1.jpg',
        'assets/productos/Premier League/Arsenal2526F/2.jpg',
        'assets/productos/Premier League/Arsenal2526F/3.jpg',
        'assets/productos/Premier League/Arsenal2526F/4.jpg'
    ], excerpt: '', link: 'productos/Arsenal2526F.html' },

    { id: 'AstonVilla2526L', name: 'Camiseta Local Aston Villa 25/26', price: 19.90, img: 'assets/productos/Premier League/AstonVilla2526L/1.jpg', images: [
        'assets/productos/Premier League/AstonVilla2526L/1.jpg',
        'assets/productos/Premier League/AstonVilla2526L/2.jpg',
        'assets/productos/Premier League/AstonVilla2526L/3.jpg',
        'assets/productos/Premier League/AstonVilla2526L/4.jpg'
    ], excerpt: '', link: 'productos/AstonVilla2526L.html' },

    { id: 'Chealsea2526L', name: 'Camiseta Local Chelsea 25/26', price: 19.90, img: 'assets/productos/Premier League/Chealsea2526L/1.jpg', images: [
        'assets/productos/Premier League/Chealsea2526L/1.jpg',
        'assets/productos/Premier League/Chealsea2526L/2.jpg',
        'assets/productos/Premier League/Chealsea2526L/3.jpg',
        'assets/productos/Premier League/Chealsea2526L/4.jpg'
    ], excerpt: '', link: 'productos/Chealsea2526L.html' },

    { id: 'ManCity2526F', name: 'Camiseta Visitante Manchester City 25/26', price: 19.90, img: 'assets/productos/Premier League/ManCity2526F/1.jpg', images: [
        'assets/productos/Premier League/ManCity2526F/1.jpg',
        'assets/productos/Premier League/ManCity2526F/2.jpg',
        'assets/productos/Premier League/ManCity2526F/3.jpg',
        'assets/productos/Premier League/ManCity2526F/4.jpg'
    ], excerpt: '', link: 'productos/ManCity2526F.html' },

    { id: 'ManUnited2526L', name: 'Camiseta Local Manchester United 25/26', price: 19.90, img: 'assets/productos/Premier League/ManUnited2526L/1.jpg', images: [
        'assets/productos/Premier League/ManUnited2526L/1.jpg',
        'assets/productos/Premier League/ManUnited2526L/2.jpg'
    ], excerpt: '', link: 'productos/ManUnited2526L.html' },

    { id: 'Newcastle2526L', name: 'Camiseta Local Newcastle 25/26', price: 19.90, img: 'assets/productos/Premier League/Newcastle2526L/1.jpg', images: [
        'assets/productos/Premier League/Newcastle2526L/1.jpg',
        'assets/productos/Premier League/Newcastle2526L/2.jpg',
        'assets/productos/Premier League/Newcastle2526L/3.jpg',
        'assets/productos/Premier League/Newcastle2526L/4.jpg'
    ], excerpt: '', link: 'productos/Newcastle2526L.html' },

    { id: 'Napoli2526L', name: 'Camiseta Local Napoli 25/26', price: 19.90, img: 'assets/productos/Serie A/Napoli2526L/1.jpg', images: [
        'assets/productos/Serie A/Napoli2526L/1.jpg',
        'assets/productos/Serie A/Napoli2526L/2.jpg',
        'assets/productos/Serie A/Napoli2526L/3.jpg',
        'assets/productos/Serie A/Napoli2526L/4.jpg'
    ], excerpt: '', link: 'productos/Napoli2526L.html' },

    { id: 'Albacete2526L', name: 'Camiseta Local Albacete 25/26', price: 19.90, img: 'assets/productos/La Liga/Albacete2526L/1.jpg', images: [
        'assets/productos/La Liga/Albacete2526L/1.jpg',
        'assets/productos/La Liga/Albacete2526L/2.jpg',
        'assets/productos/La Liga/Albacete2526L/3.jpg',
        'assets/productos/La Liga/Albacete2526L/4.jpg'
    ], excerpt: '', link: 'productos/Albacete2526L.html' },

    { id: 'MalagaKids2526L', name: 'Camiseta Local Málaga 25/26 (niños)', price: 21.90, img: 'assets/productos/La Liga/MalagaKids2526L/1.jpg', images: [
        'assets/productos/La Liga/MalagaKids2526L/1.jpg',
        'assets/productos/La Liga/MalagaKids2526L/2.jpg',
        'assets/productos/La Liga/MalagaKids2526L/3.jpg'
    ], excerpt: '', link: 'productos/MalagaKids2526L.html' },

    { id: 'River2526L', name: 'Camiseta Local River Plate 25/26', price: 19.90, img: 'assets/productos/SAF (Argentina)/River2526L/1.jpg', images: [
        'assets/productos/SAF (Argentina)/River2526L/1.jpg',
        'assets/productos/SAF (Argentina)/River2526L/2.jpg',
        'assets/productos/SAF (Argentina)/River2526L/3.jpg',
        'assets/productos/SAF (Argentina)/River2526L/4.jpg'
    ], excerpt: '', link: 'productos/River2526L.html' },

    { id: 'RiverKids2526L', name: 'Camiseta Local River Plate 25/26 (niños)', price: 21.90, img: 'assets/productos/SAF (Argentina)/RiverKids2526L/1.jpeg', images: [
        'assets/productos/SAF (Argentina)/RiverKids2526L/1.jpeg',
        'assets/productos/SAF (Argentina)/RiverKids2526L/2.jpg',
        'assets/productos/SAF (Argentina)/RiverKids2526L/3.jpg',
        'assets/productos/SAF (Argentina)/RiverKids2526L/4.jpg'
    ], excerpt: '', link: 'productos/RiverKids2526L.html' }
];

        const EXTRAS = { parche: 1, dorsal: 2, versionJugador: 5, version: 5 };
        const SHIPPING = 2.00;

        const OFFERS = [
            { size: 5, price: 85.90, shipping: 0, label: 'MEGAPACK 5' },
            { size: 4, price: 72.90, shipping: 0, label: 'Pack 4' },
            { size: 3, price: 56.90, shipping: 0, label: 'Pack 3' },
            { size: 2, price: 39.80, shipping: 0, label: 'Pack 2' },

            { size: 1, price: 19.90, shipping: 1.90, label: 'Pack 1 (Promo)' }
        ];
        let CART = [];

        function isShirtItem(ci){
            if (!ci || !ci.name) return false;
            const name = (ci.name || '').toLowerCase();
            return (ci.productId === 'barca1') || name.includes('camiseta') || name.includes('camisetas');
        }

        function computeBestOfferForCount(count){
            if (count <= 0) return { total:0, shipping:0, combo: {} };
            const dp = Array(count+1).fill(null);
            dp[0] = { total:0, shipping:0, combo: {} };
            for (let i=1;i<=count;i++){
                let best = null;
                for (const offer of OFFERS){
                    if (i - offer.size < 0) continue;
                    const prev = dp[i - offer.size];
                    if (!prev) continue;
                    const candTotal = prev.total + offer.price;
                    const candShipping = prev.shipping + (offer.shipping||0);
                    const candSum = candTotal + candShipping;
                    if (!best || candSum < (best.total + best.shipping)){
                        const combo = Object.assign({}, prev.combo);
                        combo[offer.size] = (combo[offer.size]||0) + 1;
                        best = { total: candTotal, shipping: candShipping, combo };
                    }
                }
                dp[i] = best;
            }
            return dp[count] || { total:0, shipping:0, combo: {} };
        }

        function byId(id){return document.getElementById(id);}    

    function computeCartTotals(){
            const shirtItems = CART.filter(isShirtItem);
            const nonShirtItems = CART.filter(ci => !isShirtItem(ci));
            const nonShirtSubtotal = nonShirtItems.reduce((s,it)=> s + (it.total || 0), 0);
            const shirtCount = shirtItems.length;
            const shirtExtrasSum = shirtItems.reduce((s,it)=> s + (it.extra||0), 0);
            const shirtBaseSum = shirtItems.reduce((s,it)=> s + (it.price||0), 0);

            const baseOffer = (OFFERS && OFFERS.find(o=>o.size===1) && OFFERS.find(o=>o.size===1).price) ? OFFERS.find(o=>o.size===1).price : 19.90;

            const shirtPriceSurplus = shirtItems.reduce((s,it) => s + Math.max(0, (it.price || 0) - baseOffer), 0);
            const originalSubtotal = nonShirtSubtotal + shirtBaseSum + shirtExtrasSum;
            const originalShipping = (CART.length>0? SHIPPING : 0);
            const originalTotal = originalSubtotal + originalShipping;
            if (shirtCount === 0) return { subtotal: originalSubtotal, shipping: originalShipping, total: originalTotal, appliedOffer: null, savings:0 };
            const best = computeBestOfferForCount(shirtCount);

            const shirtsOfferCost = best.total + shirtExtrasSum + shirtPriceSurplus;

            const shirtsOfferShipping = (shirtCount > 1) ? 0 : best.shipping;
            const newSubtotal = nonShirtSubtotal + shirtsOfferCost;

            const newShipping = (shirtCount > 1) ? 0 : (shirtsOfferShipping + (nonShirtItems.length>0 ? SHIPPING : 0));
            const newTotal = newSubtotal + newShipping;

            const SAVINGS_TABLE = { 1: 2.00, 2: 5.00, 3: 13.00, 4: 15.00, 5: 25.00 };

            function computeSavingsByDecomposition(n){
                if (!n || n <= 0) return 0;
                let remaining = n;
                let totalSavings = 0;

                const pack5 = Math.floor(remaining / 5);
                if (pack5 > 0 && SAVINGS_TABLE[5]) {
                    totalSavings += pack5 * SAVINGS_TABLE[5];
                    remaining = remaining - pack5 * 5;
                }

                if (remaining > 0) {
                    if (SAVINGS_TABLE[remaining] !== undefined) {
                        totalSavings += SAVINGS_TABLE[remaining];
                    } else {

                        const fallback = Math.max(0, originalTotal - newTotal);

                        totalSavings += Math.round((fallback * (remaining / n)) * 100) / 100;
                    }
                }
                return totalSavings;
            }

            const fallbackSavings = Math.max(0, originalTotal - newTotal);
            const savings = (shirtCount > 0) ? computeSavingsByDecomposition(shirtCount) : 0;

            return { subtotal: newSubtotal, shipping: newShipping, total: newTotal, appliedOffer: { count: shirtCount, detail: best, priceSurplus: shirtPriceSurplus }, savings };
        }

        function debounce(fn, wait){ let t = null; return function(){ clearTimeout(t); t = setTimeout(()=> fn.apply(this, arguments), wait); }; }

        const __PROMO = { el: null, type: null, visible: false };
        function ensurePromoEl(){
            if (__PROMO.el && document.body.contains(__PROMO.el)) return __PROMO.el;
            const el = document.createElement('div');
            el.id = 'cartPromoBanner';
            el.className = 'cart-promo-banner fast';

            el.innerHTML = '<div class="promo-inner"><span class="promo-badge"></span></div>';
            document.body.appendChild(el);
            __PROMO.el = el; return el;
        }
        function positionPromoBanner(){
            const el = ensurePromoEl();
            if (!__PROMO.visible) return;
            const cart = document.getElementById('cartPanel');
            const secCarrito = document.getElementById('carrito');
            const secPedidos = document.getElementById('pedidos');
            const sectionActive = (secCarrito && secCarrito.classList.contains('activa')) || (secPedidos && secPedidos.classList.contains('activa'));
            if (!cart || !sectionActive) { el.style.opacity = '0'; return; }
            const r = cart.getBoundingClientRect();
            const left = Math.round(r.left);
            const width = Math.round(r.width);

            const gap = 8;
            const bannerH = el.offsetHeight || 0;
            const topPos = Math.round(r.top) - bannerH - gap;
            el.style.left = left + 'px';
            el.style.top = topPos + 'px';
            el.style.width = width + 'px';
        }
        function hidePromoBanner(){
            const el = ensurePromoEl();
            __PROMO.visible = false;
            el.classList.remove('visible');
        }
        function showPromoBanner(type){
            const el = ensurePromoEl();
            const newType = (type === 5 ? 5 : 3);
            if (__PROMO.visible && __PROMO.type === newType) { positionPromoBanner(); return; }
            __PROMO.type = newType;
            el.classList.remove('theme-3','theme-5','fast','subtle');
            const badge = el.querySelector('.promo-badge');
            if (newType === 3){
                el.classList.add('theme-3','fast');
                if (badge) badge.textContent = 'PACK POPULAR';
            } else {
                el.classList.add('theme-5','subtle');
                if (badge) badge.textContent = 'MEJOR OFERTA';
            }
            __PROMO.visible = true;
            positionPromoBanner();
            void el.offsetWidth;
            el.classList.add('visible');
        }
        function updateCartPromoBanner(){
            try {
                const secCarrito = document.getElementById('carrito');
                const secPedidos = document.getElementById('pedidos');
                const sectionActive = (secCarrito && secCarrito.classList.contains('activa')) || (secPedidos && secPedidos.classList.contains('activa'));
                if (!sectionActive) { hidePromoBanner(); return; }
                const shirtCount = (Array.isArray(CART)? CART : []).filter(isShirtItem).length;
                if (shirtCount === 5) showPromoBanner(5);
                else if (shirtCount === 3) showPromoBanner(3);
                else hidePromoBanner();
                setTimeout(positionPromoBanner, 30);
                setTimeout(positionPromoBanner, 160);
            } catch(e) {}
        }
        window.addEventListener('resize', debounce(positionPromoBanner, 60));
        window.addEventListener('scroll', debounce(positionPromoBanner, 60));
        document.addEventListener('DOMContentLoaded', ()=> setTimeout(positionPromoBanner, 140));

        document.querySelectorAll('.boton-seccion').forEach(b => b.addEventListener('click', ()=> setTimeout(()=> { updateCartPromoBanner(); positionPromoBanner(); }, 240)));

        let currentSortOrder = 'default';
        let currentLeagueFilter = 'all';
        let currentTeamFilter = 'all';
        

        function normalizeNoAccentsGlobal(s){
            return (s || '').toString().toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').trim();
        }
        function canonicalizeTeamName(name){
            const raw = (name || '').toString().trim();
            if (!raw) return '';

            let s = raw.replace(/\(\s*\)/g, '').replace(/\s{2,}/g,' ').trim();
            const key = normalizeNoAccentsGlobal(s);
            const map = new Map([
                ['atletico', 'Atlético de Madrid'],
                ['atlético', 'Atlético de Madrid'],
                ['atleti', 'Atlético de Madrid'],
                ['atletico madrid', 'Atlético de Madrid'],
                ['atletico de madrid', 'Atlético de Madrid'],
                ['real madrid', 'Real Madrid'],
                ['fc barcelona', 'Barcelona'],
                ['barcelona', 'Barcelona'],
                ['athletic', 'Athletic Club'],
                ['athletic club', 'Athletic Club'],
                ['athletic bilbao', 'Athletic Club'],
                ['athletic de bilbao', 'Athletic Club']
            ]);
            if (map.has(key)) return map.get(key);
            return s;
        }
        function getLeagueFromProduct(p){
            try{
                const imgPath = p && (p.img || (p.images && p.images[0]) || '');
                const m = (imgPath||'').match(/assets\/productos\/([^/]+)\//i);
                return m ? m[1] : 'Otros';
            }catch(e){ return 'Otros'; }
        }
        function extractTeamFromName(name){
            let s = (name || '').replace(/\bCamiseta\b/gi,'').replace(/\bNBA\b/gi,'');
            s = s.replace(/\b(Local|Visitante|Tercera|Retro|Kids|niños)\b/gi,'');
            s = s.replace(/\(\s*(Kids|niños)\s*\)/gi,'');
            s = s.replace(/\(\s*Modelo\s*\d+\s*\)/gi,'');
            s = s.replace(/\b\d{2}\/\d{2}\b/g,'');
            s = s.replace(/\b\d{2}\d{2}\b/g,'');
            s = s.replace(/\b\d{4}\b/g,'');
            s = s.replace(/\s{2,}/g,' ').trim();
            return s;
        }
        function getTeamFromProduct(p){
            try{
                const nameTeam = extractTeamFromName(p && p.name);
                if (nameTeam && nameTeam.length >= 2) return nameTeam;
                const imgPath = p && (p.img || (p.images && p.images[0]) || '');
                const m = (imgPath||'').match(/assets\/productos\/[^/]+\/([^/]+)\//i);
                let folder = m ? m[1] : '';

                folder = folder.replace(/(Kids|LR|FR|TR)$/i,'');
                folder = folder.replace(/\d{2,4}/g,'');

                const normas = [
                    ['RealMadrid','Real Madrid'], ['Barcelona','Barcelona'], ['Athletic','Athletic Club'], ['Atletico','Atlético'],
                    ['Betis','Betis'], ['Celta','Celta'], ['Elche','Elche'], ['Espanyol','Espanyol'], ['Getafe','Getafe'],
                    ['Girona','Girona'], ['Granada','Granada'], ['LasPalmas','Las Palmas'], ['Leganes','Leganés'], ['Levante','Levante'],
                    ['Malaga','Málaga'], ['Mallorca','Mallorca'], ['Osasuna','Osasuna'], ['Oviedo','Oviedo'], ['Rayo','Rayo Vallecano'],
                    ['RealSociedad','Real Sociedad'], ['Sevilla','Sevilla'], ['Valencia','Valencia'], ['Valladolid','Valladolid'],
                    ['Alaves','Alavés'], ['Villarreal','Villarreal'], ['Munich','Bayern Munich'], ['Paris','PSG'],
                    ['CrystalPalace','Crystal Palace'], ['Milan','Milan'], ['Lazio','Lazio'], ['Roma','Roma'], ['Schalke','Schalke'],
                    ['Flamengo','Flamengo'], ['Al-Nassr','Al-Nassr'], ['Boca','Boca Juniors'], ['Monaco','Monaco'],
                    ['Espana','España'], ['Francia','Francia'], ['Holanda','Holanda'], ['Lakers','Lakers'],
                    ['Oklahoma','Oklahoma City Thunder'], ['Phila','Philadelphia 76ers']
                ];
                for (const [k,v] of normas){
                    const rk = new RegExp('^'+k+'$', 'i');
                    if (rk.test(folder)) return v;
                }

                const inferred = (folder||'').replace(/([a-z])([A-Z])/g,'$1 $2').replace(/[\-_]/g,' ').trim();
                return inferred || 'Otros';
            }catch(e){ return 'Otros'; }
        }
        

        function getSeasonYearFromProduct(p){
            try{

                try {
                    const league = getLeagueFromProduct(p);
                    if ((league || '').toLowerCase() === 'nba') return 2025;
                } catch (e) {}
                const candidates = [];
                const consider = [];
                if (p && p.name) consider.push(p.name);
                const imgPath = p && (p.img || (Array.isArray(p.images) && p.images[0]) || '');
                if (imgPath) consider.push(imgPath);
                for (const sRaw of consider){
                    const s = String(sRaw);

                    let m = s.match(/\b(20\d{2})\s*\/\s*(\d{2,4})\b/);
                    if (m){ const y = parseInt(m[1],10); if (!Number.isNaN(y)) candidates.push(y); }

                    m = s.match(/\b(\d{2})\s*\/\s*(\d{2})\b/);
                    if (m){ const y = 2000 + parseInt(m[1],10); if (!Number.isNaN(y)) candidates.push(y); }

                    m = s.match(/\b(20\d{2})\b/);
                    if (m){ const y = parseInt(m[1],10); if (!Number.isNaN(y)) candidates.push(y); }
                }
                if (candidates.length) return Math.max(...candidates);
                return 0;
            }catch(e){ return 0; }
        }
        

        function createGalleryControls(container) {

            const leagues = [];
            PRODUCTS.forEach(p => {
                const imgPath = p.img || (p.images && p.images.length > 0 ? p.images[0] : '');
                const match = imgPath.match(/assets\/productos\/([^/]+)\//i);
                const league = match ? match[1] : 'Otros';
                if (!leagues.includes(league)) {
                    leagues.push(league);
                }
            });
            

            const controlsContainer = document.createElement('div');
            controlsContainer.id = 'galleryControls';
            controlsContainer.className = 'gallery-controls';
            

            const leagueFilter = document.createElement('div');
            leagueFilter.className = 'league-filter';
            leagueFilter.innerHTML = `
                <label>Filtrar por liga:</label>
                <div class="league-dropdown" id="leagueDropdown">
                    <button type="button" class="dropdown-toggle" id="leagueDropdownToggle">Todas las ligas</button>
                    <div class="dropdown-menu" id="leagueDropdownMenu"></div>
                </div>
            `;

            (function(){

                const styleId = 'leagueSubmenuStyles';
                if (!document.getElementById(styleId)){
                    const st = document.createElement('style');
                    st.id = styleId;
                    st.textContent = `
                    
                    .gallery-controls .league-dropdown { position: relative; display: inline-block; }
                    .gallery-controls .league-dropdown .dropdown-toggle { padding: 8px 12px; padding-right: 32px; position: relative; border-radius: 6px; background: #071735; color: #fff; border: 1px solid #2e7bed; cursor: pointer; min-width: 220px; text-align:left; }
                    .gallery-controls .league-dropdown .dropdown-toggle::after { content: '▾'; position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #9fe0ff; pointer-events: none; font-size: 14px; }
                    .gallery-controls .league-dropdown.open .dropdown-toggle { box-shadow: 0 0 8px rgba(46,123,237,0.4); border-color: var(--azul-acento); }
                    .gallery-controls .league-dropdown.open .dropdown-toggle::after { transform: translateY(-50%) rotate(180deg); }
                    .gallery-controls .league-dropdown .dropdown-menu { position: absolute; top: 100%; left: 0; min-width: 240px; background: #071735; border: 1px solid #2e7bed; border-radius: 8px; box-shadow: 0 8px 30px rgba(0,0,0,0.35); padding: 6px 0; display: none; z-index: 1200; max-height: none; overflow: visible; }
                    .gallery-controls .league-dropdown.open .dropdown-menu { display: block; }
                    .gallery-controls .dropdown-item { padding: 8px 12px; color: #fff; cursor: pointer; white-space: nowrap; line-height: 1.2; }
                    .gallery-controls .dropdown-item:hover { background: rgba(46,123,237,0.12); }
                    .gallery-controls .dropdown-item.has-sub { position: relative; padding-right: 28px; }
                    .gallery-controls .dropdown-item.has-sub::after { content: '›'; position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #9fe0ff; }
                    .gallery-controls .submenu { position: absolute; top: 0; left: 100%; min-width: 240px; background: #071735; border: 1px solid #2e7bed; border-radius: 8px; box-shadow: 0 8px 30px rgba(0,0,0,0.35); padding: 6px 0; display: none; z-index: 1201; max-height: none; overflow: visible; }
                    .gallery-controls .dropdown-item.has-sub:hover > .submenu { display: block; }
                    .gallery-controls .dropdown-menu.fixed-open, .gallery-controls .submenu.fixed-open { position: fixed !important; max-height: none !important; overflow: visible !important; transform-origin: top left; }
                    .gallery-controls .dropdown-menu.columns, .gallery-controls .submenu.columns { column-gap: 8px; }
                    @media (max-width: 768px){
                        .gallery-controls .league-dropdown .dropdown-menu, .gallery-controls .submenu { position: static; box-shadow:none; border-radius:8px; border-width:1px; }
                        .gallery-controls .dropdown-item.has-sub::after { display:none; }
                        .gallery-controls .dropdown-item.has-sub { position: relative; cursor: pointer; }
                        .gallery-controls .dropdown-item.has-sub .submenu-toggle { 
                            display: block !important; 
                            position: absolute; 
                            right: 8px; 
                            top: 50%; 
                            transform: translateY(-50%); 
                            background: transparent; 
                            border: 1px solid rgba(159, 224, 255, 0.3); 
                            color: #9fe0ff; 
                            border-radius: 50%; 
                            width: 28px; 
                            height: 28px; 
                            cursor: pointer; 
                            font-size: 14px; 
                            transition: transform 0.2s ease, background 0.2s ease; 
                            line-height: 1; 
                        }
                        .gallery-controls .dropdown-item.has-sub .submenu-toggle:hover {
                            background: rgba(159, 224, 255, 0.1);
                        }
                        .gallery-controls .dropdown-item.has-sub .submenu-toggle.open {
                            transform: translateY(-50%) rotate(90deg);
                            background: rgba(159, 224, 255, 0.2);
                        }
                        .gallery-controls .submenu { 
                            display: none !important; 
                            position: relative !important; 
                            left: 0 !important; 
                            top: 0 !important; 
                            width: 100% !important; 
                            margin-left: 16px !important; 
                            border: none !important; 
                            box-shadow: none !important; 
                            background: rgba(46, 123, 237, 0.05) !important; 
                            border-left: 2px solid #2e7bed !important; 
                            border-radius: 0 8px 8px 0 !important; 
                        }
                        .gallery-controls .submenu.show { 
                            display: block !important; 
                        }
                        .gallery-controls .submenu .dropdown-item {
                            padding: 8px 12px !important; 
                            font-size: 0.9rem !important; 
                            border-bottom: 1px solid rgba(46, 123, 237, 0.1) !important; 
                        }
                        .gallery-controls .submenu .dropdown-item:last-child {
                            border-bottom: none !important; 
                        }
                    }
                    `;
                    document.head.appendChild(st);
                }

                const dd = leagueFilter.querySelector('#leagueDropdown');
                const toggle = leagueFilter.querySelector('#leagueDropdownToggle');
                const menu = leagueFilter.querySelector('#leagueDropdownMenu');
                if (!dd || !toggle || !menu) return;

                const leagueMap = new Map();
                (Array.isArray(PRODUCTS) ? PRODUCTS : []).forEach(p => {
                    const league = getLeagueFromProduct(p);
                    const team = getTeamFromProduct(p);
                    if (!leagueMap.has(league)) leagueMap.set(league, new Map());
                    const canonical = canonicalizeTeamName(team);
                    const key = normalizeNoAccentsGlobal(canonical);
                    if (key){
                        const m = leagueMap.get(league);
                        if (!m.has(key)) m.set(key, canonical);
                    }
                });
                const leaguesSorted = Array.from(leagueMap.keys()).sort((a,b)=> a.localeCompare(b));

                const itemAll = document.createElement('div');
                itemAll.className = 'dropdown-item';
                itemAll.textContent = 'Todas las ligas';
                itemAll.addEventListener('click', () => {
                    currentLeagueFilter = 'all';
                    currentTeamFilter = 'all';
                    toggle.textContent = 'Todas las ligas';
                    renderGallery(document.getElementById('productSearch')?.value || '');
                    closeDropdown();
                });
                menu.appendChild(itemAll);

                leaguesSorted.forEach(league => {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'dropdown-item has-sub';
                    wrapper.textContent = league;

                    wrapper.addEventListener('click', (e) => {º
                        e.stopPropagation();
                        currentLeagueFilter = league;
                        currentTeamFilter = 'all';
                        toggle.textContent = `Liga: ${league}`;
                        renderGallery(document.getElementById('productSearch')?.value || '');
                        closeDropdown();
                    });

                    const submenu = document.createElement('div');
                    submenu.className = 'submenu';

                    const subAll = document.createElement('div');
                    subAll.className = 'dropdown-item';
                    subAll.textContent = 'Todos los equipos';
                    subAll.addEventListener('click', (e) => {
                        e.stopPropagation();
                        currentLeagueFilter = league;
                        currentTeamFilter = 'all';
                        toggle.textContent = `Liga: ${league}`;
                        renderGallery(document.getElementById('productSearch')?.value || '');
                        closeDropdown();
                    });
                    submenu.appendChild(subAll);

                    const teamsMap = leagueMap.get(league) || new Map();
                    const teams = Array.from(teamsMap.values())
                        .map(v => canonicalizeTeamName(v))
                        .filter((v,i,arr)=> arr.findIndex(x => normalizeNoAccentsGlobal(x) === normalizeNoAccentsGlobal(v)) === i)
                        .sort((a,b)=> a.localeCompare(b));
                    teams.forEach(team => {
                        const tItem = document.createElement('div');
                        tItem.className = 'dropdown-item';
                        tItem.textContent = team;
                        tItem.addEventListener('click', (e) => {
                            e.stopPropagation();
                            currentLeagueFilter = league;
                        currentTeamFilter = canonicalizeTeamName(team);
                        toggle.textContent = `Equipo: ${canonicalizeTeamName(team)}`;
                        renderGallery(document.getElementById('productSearch')?.value || '');
                            closeDropdown();
                        });
                        submenu.appendChild(tItem);
                    });

                    wrapper.appendChild(submenu);
                    menu.appendChild(wrapper);
                });

                function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }
                function layoutColumns(container, maxWidth){
                    const items = Array.from(container.children);
                    const firstItem = items.find(el => el.classList && el.classList.contains('dropdown-item')) || items[0];
                    const tempDisplay = container.style.display;
                    const tempVis = container.style.visibility;
                    container.style.display = 'block';
                    container.style.visibility = 'hidden';
                    const itemHeight = firstItem ? (firstItem.getBoundingClientRect().height || 32) : 32;
                    const totalItems = items.length || 1;
                    const margin = 8;
                    const maxColumnsByWidth = Math.max(1, Math.floor((maxWidth - 2*margin) / 260));
                    const columnsByHeight = Math.ceil((totalItems * itemHeight) / (window.innerHeight - 2*margin));
                    const columns = clamp(columnsByHeight, 1, maxColumnsByWidth);
                    container.classList.add('columns');
                    container.style.columnCount = String(columns);
                    container.style.columnWidth = '240px';
                    const width = Math.min(columns * 260, maxWidth - 2*margin);
                    container.style.width = width + 'px';
                    container.style.display = tempDisplay;
                    container.style.visibility = tempVis;
                    return width;
                }
                function positionFixed(container, anchorRect, preferBelow = true){
                    const margin = 8;
                    container.classList.add('fixed-open');
                    container.style.position = 'fixed';
                    container.style.display = 'block';
                    container.style.visibility = 'hidden';

                    layoutColumns(container, window.innerWidth);
                    const rect = container.getBoundingClientRect();

                    const scale = Math.min(1,
                        (window.innerWidth - 2*margin) / rect.width,
                        (window.innerHeight - 2*margin) / rect.height
                    );
                    container.style.transform = (scale < 1 ? `scale(${scale})` : 'none');
                    const effWidth = rect.width * scale;
                    const effHeight = rect.height * scale;
                    let left = clamp(anchorRect.left, margin, window.innerWidth - effWidth - margin);
                    let topCandidate = preferBelow ? (anchorRect.bottom + margin) : (anchorRect.top - effHeight - margin);
                    if (preferBelow && (topCandidate + effHeight + margin > window.innerHeight)){

                        topCandidate = Math.max(margin, anchorRect.top - effHeight - margin);
                    }
                    if (!preferBelow && (topCandidate < margin)){

                        topCandidate = clamp(anchorRect.bottom + margin, margin, window.innerHeight - effHeight - margin);
                    }
                    const top = clamp(topCandidate, margin, window.innerHeight - effHeight - margin);
                    container.style.left = left + 'px';
                    container.style.top = top + 'px';
                    container.style.visibility = 'visible';
                }
                function clearFixed(container){
                    container.classList.remove('fixed-open','columns');
                    container.style.removeProperty('position');
                    container.style.removeProperty('left');
                    container.style.removeProperty('top');
                    container.style.removeProperty('width');
                    container.style.removeProperty('column-count');
                    container.style.removeProperty('column-width');
                    container.style.removeProperty('display');
                    container.style.removeProperty('visibility');
                }

                let resizeHandler;
                function openDropdown(){
                    dd.classList.add('open');
                    const anchor = toggle.getBoundingClientRect();
                    positionFixed(menu, anchor, true);

                    resizeHandler = () => positionFixed(menu, toggle.getBoundingClientRect(), true);
                    window.addEventListener('resize', resizeHandler);
                    window.addEventListener('scroll', resizeHandler, { passive: true });
                }
                function closeDropdown(){
                    dd.classList.remove('open');
                    clearFixed(menu);

                    menu.querySelectorAll('.submenu').forEach(sm => { clearFixed(sm); sm.style.display=''; });
                    if (resizeHandler){
                        window.removeEventListener('resize', resizeHandler);
                        window.removeEventListener('scroll', resizeHandler);
                        resizeHandler = null;
                    }
                }

                let __lastMouseX = 0, __lastMouseY = 0;
                (function(){
                    const PADDING = 20;
                    let proximityTimer = null;
                    function within(rect, x, y){
                        return x >= rect.left - PADDING && x <= rect.right + PADDING && y >= rect.top - PADDING && y <= rect.bottom + PADDING;
                    }
                    function withinAny(rects, x, y){
                        for (const r of rects){
                            if (within(r, x, y)) return true;
                        }
                        return false;
                    }
                    function collectRects(){
                        const rects = [ toggle.getBoundingClientRect(), menu.getBoundingClientRect() ];
                        menu.querySelectorAll('.submenu.fixed-open').forEach(sm => {
                            rects.push(sm.getBoundingClientRect());
                        });
                        return rects;
                    }
                    function onMove(e){
                        if (!dd.classList.contains('open')) return;
                        const rects = collectRects();
                        const x = e.clientX, y = e.clientY;
                        if (!withinAny(rects, x, y)){
                            if (proximityTimer) clearTimeout(proximityTimer);
                            proximityTimer = setTimeout(() => {
                                const rects2 = collectRects();
                                const x2 = e.clientX, y2 = e.clientY;
                                if (!withinAny(rects2, x2, y2)) closeDropdown();
                            }, 30);
                        } else if (proximityTimer){
                            clearTimeout(proximityTimer);
                            proximityTimer = null;
                        }
                    }
                    document.addEventListener('mousemove', onMove, { passive: true });
                    document.addEventListener('mousemove', (e)=>{ __lastMouseX = e.clientX; __lastMouseY = e.clientY; }, { passive: true });
                })();
                toggle.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (dd.classList.contains('open')) closeDropdown(); else openDropdown();
                });
                document.addEventListener('click', () => closeDropdown());

                const wrappers = menu.querySelectorAll('.dropdown-item.has-sub');
                const isSmallScreen = window.innerWidth <= 768;
                const supportsHover = window.matchMedia && window.matchMedia('(hover: hover) and (pointer: fine)').matches && !isSmallScreen;
                wrappers.forEach(wrapper => {
                    const submenu = wrapper.querySelector('.submenu');
                    if (!submenu) return;

                    if (supportsHover){
                        let hoverWrapper = false;
                        let hoverSubmenu = false;
                        let hideTimeout = null;

                        function positionSubmenu(){
                            submenu.style.display = 'block';
                            const wRect = wrapper.getBoundingClientRect();
                            submenu.classList.add('fixed-open');
                            layoutColumns(submenu, window.innerWidth);
                            const sRect = submenu.getBoundingClientRect();
                            const margin = 8;
                            let left = wRect.right + margin;
                            if (left + sRect.width + margin > window.innerWidth){
                                left = Math.max(margin, wRect.left - margin - sRect.width);
                            }
                            let top = clamp(wRect.top, margin, window.innerHeight - sRect.height - margin);
                            submenu.style.position = 'fixed';
                            submenu.style.left = left + 'px';
                            submenu.style.top = top + 'px';
                        }
                        function scheduleHide(){
                            if (hideTimeout) clearTimeout(hideTimeout);
                            hideTimeout = setTimeout(() => {
                                if (!hoverWrapper && !hoverSubmenu){
                                    const rects = [ wrapper.getBoundingClientRect(), submenu.getBoundingClientRect() ];
                                    const inside = rects.some(r => __lastMouseX >= r.left - 20 && __lastMouseX <= r.right + 20 && __lastMouseY >= r.top - 20 && __lastMouseY <= r.bottom + 20);
                                    if (!inside){
                                        clearFixed(submenu);
                                        submenu.style.display = '';
                                    }
                                }
                            }, 30);
                        }

                        wrapper.addEventListener('mouseenter', () => {
                            hoverWrapper = true;
                            menu.querySelectorAll('.submenu').forEach(sm => { if (sm !== submenu) { clearFixed(sm); sm.style.display=''; } });
                            positionSubmenu();
                        });
                        wrapper.addEventListener('mouseleave', () => {
                            hoverWrapper = false;
                            scheduleHide();
                        });
                        submenu.addEventListener('mouseenter', () => {
                            hoverSubmenu = true;
                            positionSubmenu();
                        });
                        submenu.addEventListener('mouseleave', () => {
                            hoverSubmenu = false;
                            scheduleHide();
                        });
                    } else if (isSmallScreen) {

                        submenu.style.display = 'none';
                        let btn = wrapper.querySelector('.submenu-toggle');
                        if (!btn){
                            btn = document.createElement('button');
                            btn.type = 'button';
                            btn.className = 'submenu-toggle';
                            btn.setAttribute('aria-label', 'Mostrar equipos');
                            btn.setAttribute('aria-expanded', 'false');
                            btn.textContent = '›';
                            wrapper.appendChild(btn);
                        }
                        btn.addEventListener('click', (e)=>{
                            e.stopPropagation();
                            const willOpen = !wrapper.classList.contains('open');

                            menu.querySelectorAll('.dropdown-item.has-sub.open').forEach(w => {
                                if (w !== wrapper){
                                    w.classList.remove('open');
                                    const sm = w.querySelector('.submenu');
                                    if (sm) sm.style.display = 'none';
                                    const b = w.querySelector('.submenu-toggle');
                                    if (b) b.setAttribute('aria-expanded','false');
                                }
                            });
                            wrapper.classList.toggle('open');
                            submenu.style.display = willOpen ? 'block' : 'none';
                            btn.setAttribute('aria-expanded', String(willOpen));
                        });
                    }
                });

                if (!document.getElementById('leagueTouchStyles')){
                    const st2 = document.createElement('style');
                    st2.id = 'leagueTouchStyles';
                    st2.textContent = `
                    @media (max-width: 768px) and (hover: none) and (pointer: coarse){
                        .gallery-controls .dropdown-item.has-sub { position: relative; padding-right: 40px; }
                        .gallery-controls .dropdown-item.has-sub .submenu { display: none !important; margin-top: 4px; background: rgba(10,31,61,0.95); border-radius: 8px; padding: 4px 0; }
                        .gallery-controls .dropdown-item.has-sub.open > .submenu { display: block !important; }
                        .gallery-controls .dropdown-item.has-sub .submenu-toggle{ position:absolute; right:8px; top:50%; transform:translateY(-50%); background: rgba(42,91,168,0.3); border:1px solid rgba(255,255,255,0.2); color:#9fe0ff; border-radius:6px; padding:6px 10px; cursor:pointer; font-size:14px; transition:all 0.2s ease; min-width: 28px; text-align: center; }
                        .gallery-controls .dropdown-item.has-sub .submenu-toggle:active { background: rgba(42,91,168,0.5); }
                        .gallery-controls .dropdown-item.has-sub.open > .submenu-toggle { transform:translateY(-50%) rotate(90deg); background: rgba(42,91,168,0.6); }
                    }
                    @media (max-width: 768px) and (hover: hover){
                        .gallery-controls .dropdown-item.has-sub .submenu-toggle { display: none !important; }
                    }
                    `;
                    document.head.appendChild(st2);
                }
            })();
            

            const sortOrder = document.createElement('div');
            sortOrder.className = 'sort-order';
            sortOrder.innerHTML = `
                <label for="sortSelect">Ordenar por:</label>
                <select id="sortSelect">
                    <option value="default">Por defecto</option>
                    <option value="price-asc">Precio: menor a mayor</option>
                    <option value="price-desc">Precio: mayor a menor</option>
                    <option value="name-asc">Nombre: A-Z</option>
                    <option value="name-desc">Nombre: Z-A</option>
                    <option value="team-asc">Equipo: A-Z</option>
                    <option value="team-desc">Equipo: Z-A</option>
                    <option value="season-desc">Temporada: más reciente</option>
                    <option value="season-asc">Temporada: más antigua</option>
                </select>
            `;
            

            controlsContainer.appendChild(leagueFilter);
            controlsContainer.appendChild(sortOrder);

            const countEl = document.createElement('div');
            countEl.id = 'productCount';
            countEl.className = 'product-count';
            countEl.setAttribute('aria-live', 'polite');

            countEl.textContent = `Mostrando ${Array.isArray(PRODUCTS) ? PRODUCTS.length : 0} de ${Array.isArray(PRODUCTS) ? PRODUCTS.length : 0} productos`;
            controlsContainer.appendChild(countEl);
            

            const searchWrap = document.querySelector('.product-search-wrap');
            if (searchWrap) {

                searchWrap.parentNode.insertBefore(controlsContainer, searchWrap.nextSibling);
            } else {

                container.insertBefore(controlsContainer, container.firstChild);
            }
            

            
            document.getElementById('sortSelect').addEventListener('change', function(e) {
                currentSortOrder = e.target.value;
                renderGallery(document.getElementById('productSearch')?.value || '');
            });
        }
        
        function renderGallery(filterText){
            const container = byId('productGallery');
            container.innerHTML = '';
            

            if (!document.getElementById('galleryControls')) {
                createGalleryControls(container);
            } else {

                const controls = document.getElementById('galleryControls');
                const searchWrap = document.querySelector('.product-search-wrap');
                
                if (controls && searchWrap) {

                    searchWrap.parentNode.insertBefore(controls, searchWrap.nextSibling);
                }
            }
            

            const normalizeNoAccents = (s)=> (s||'').toString().toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            const q = normalizeNoAccents(filterText || '');

            const base = (function(){
                if (Array.isArray(window._PRODUCTS_SHUFFLED)) return window._PRODUCTS_SHUFFLED;
                const copy = Array.isArray(PRODUCTS) ? PRODUCTS.slice() : [];
                for (let i = copy.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    const tmp = copy[i]; copy[i] = copy[j]; copy[j] = tmp;
                }
                window._PRODUCTS_SHUFFLED = copy;
                return copy;
            })();
            let list = base.filter(p => { 
                if (!q) return true; 
                const nameNoAccents = normalizeNoAccents(p.name || '');
                return nameNoAccents.indexOf(q) !== -1; 
            });
            

            if (currentLeagueFilter !== 'all') {
                list = list.filter(p => {
                    const league = getLeagueFromProduct(p);
                    return league === currentLeagueFilter;
                });
            }
            

            if (currentTeamFilter !== 'all') {
                const target = canonicalizeTeamName(currentTeamFilter);
                list = list.filter(p => normalizeNoAccentsGlobal(canonicalizeTeamName(getTeamFromProduct(p))) === normalizeNoAccentsGlobal(target));
            }
            

            if (currentSortOrder === 'price-asc') {
                list.sort((a, b) => a.price - b.price);
            } else if (currentSortOrder === 'price-desc') {
                list.sort((a, b) => b.price - a.price);
            } else if (currentSortOrder === 'name-asc' || currentSortOrder === 'name-desc') {
                list.sort((a, b) => {
                    const an = normalizeNoAccentsGlobal(a.name || '');
                    const bn = normalizeNoAccentsGlobal(b.name || '');
                    return currentSortOrder === 'name-asc' ? an.localeCompare(bn) : bn.localeCompare(an);
                });
            } else if (currentSortOrder === 'team-asc' || currentSortOrder === 'team-desc') {
                list.sort((a, b) => {
                    const ta = normalizeNoAccentsGlobal(canonicalizeTeamName(getTeamFromProduct(a)) || '');
                    const tb = normalizeNoAccentsGlobal(canonicalizeTeamName(getTeamFromProduct(b)) || '');
                    return currentSortOrder === 'team-asc' ? ta.localeCompare(tb) : tb.localeCompare(ta);
                });
            } else if (currentSortOrder === 'season-desc' || currentSortOrder === 'season-asc') {
                list.sort((a, b) => {
                    const ya = getSeasonYearFromProduct(a) || 0;
                    const yb = getSeasonYearFromProduct(b) || 0;
                    return currentSortOrder === 'season-desc' ? (yb - ya) : (ya - yb);
                });
            }
            

            const totalCount = Array.isArray(PRODUCTS) ? PRODUCTS.length : 0;
            const currentCount = list.length;
            const countBox = document.getElementById('productCount');
            if (countBox) {
                countBox.textContent = `Mostrando ${currentCount} de ${totalCount} productos`;
            }
            

            list.forEach(p => {
                    const el = document.createElement('article');
                    el.className = 'product-item';

                    el.setAttribute('data-id', p.id);
                    el.setAttribute('data-action', 'add');

                    if (p.images && p.images.length) {
                        const imgsJson = JSON.stringify(p.images);
                        el.innerHTML = `
                            <div class="pedido-mini-card" data-images='${imgsJson}'>
                                <div style="display:flex;justify-content:center;">
                                    <div style="max-width:800px;width:100%;aspect-ratio:1/1;overflow:hidden;border-radius:8px;">
                                        <img class="pedido-carrusel-img" src="${p.images[0]}" alt="${p.name}" loading="lazy" width="1512" height="1512" style="width:100%;height:100%;object-fit:cover;display:block;">
                                    </div>
                                </div>
                                <h4 style="margin-top:6px">${p.name}</h4>
                                <div class="price">€${p.price.toFixed(2)}</div>
                                <div class="excerpt">${p.excerpt}</div>
                                
                            </div>
                        `;
                    } else {
                        el.innerHTML = `
                                <div style="width:100%;aspect-ratio:1/1;overflow:hidden;border-radius:8px;">
                                    <img src="${p.img}" alt="${p.name}" loading="lazy" width="1512" height="1512" style="width:100%;height:100%;object-fit:cover;display:block;">
                                </div>
                                <h4>${p.name}</h4>
                                <div class="price">€${p.price.toFixed(2)}</div>
                                <div class="excerpt">${p.excerpt}</div>
                                
                            `;
                    }
                    container.appendChild(el);
                });
        }

        function openProductModal(product){

            const modal = document.createElement('div');
            modal.style.position = 'fixed';
            modal.style.left = '0'; modal.style.top = '0'; modal.style.width = '100vw'; modal.style.height = '100vh';
            modal.style.display = 'flex';
            modal.style.alignItems = 'flex-start';
            modal.style.justifyContent = 'center';
            modal.style.background = 'rgba(2,6,23,0.7)';
            modal.style.zIndex = 1200;
            modal.style.padding = '0';
            modal.style.margin = '0';
            modal.style.maxWidth = '100vw';
            modal.style.overflow = 'hidden';
            modal.innerHTML = `
                <div class="product-modal-container" style="width:100%;max-width:280px;background:#071735;padding:8px;border-radius:8px;color:#dbeeff;overflow:visible;box-sizing:border-box;display:grid;grid-template-columns:1fr 1fr;gap:24px;align-items:start;">
                <style>
                @media (min-width: 992px) {
                    .product-modal-container {
                        max-width: calc(100vw - 300px) !important;
                        max-height: calc(100vh - 300px) !important;
                        width: calc(100vw - 300px) !important;
                        padding: 40px !important;
                        margin: 150px !important;
                        border-radius: 20px !important;
                    }
                }
                @media (max-width: 768px) {
                    #modal-tienda-carrusel > div > div {
                        max-width: 240px !important;
                        width: 85vw !important;
                        border-radius: 6px !important;
                        margin: 0 auto !important;
                        padding: 6px !important;
                    }
                }
                @media (max-width: 480px) {
                    #modal-tienda-carrusel > div > div {
                        max-width: 220px !important;
                        width: 80vw !important;
                        padding: 5px !important;
                    }
                }
                @media (max-width: 320px) {
                    #modal-tienda-carrusel > div > div {
                        max-width: 200px !important;
                        width: 90vw !important;
                        padding: 4px !important;
                    }
                }
                
                
                @media (min-width: 769px) {
                    .product-title-desktop {
                        font-size: 2.5rem !important;
                    }
                    .product-excerpt-desktop {
                        font-size: 1.6rem !important;
                    }
                    .product-price-desktop {
                        font-size: 2.2rem !important;
                    }
                }
                </style>
                    <div style="display:flex;flex-direction:column;gap:6px;align-items:center;">
                        <img src="${product.img}" alt="${product.name}" loading="lazy" width="1512" height="1512" style="width:100%;max-width:400px;aspect-ratio:1/1;object-fit:cover;border-radius:16px;margin:0 auto;">
                        <div style="width:100%;">
                            <h3 style="margin:0;color:var(--azul-acento);font-size:2rem;text-align:center;" class="product-title-desktop">${product.name}</h3>
                            <p style="color:#d6e9ff;font-size:1.3rem;margin:8px 0;text-align:center;" class="product-excerpt-desktop">${product.excerpt}</p>
                            <p style="font-weight:800;font-size:1.8rem;color:#9fe0ff;margin:8px 0;text-align:center;" class="product-price-desktop">€${product.price.toFixed(2)}</p>
                            <form id="_personalizeForm" style="margin-top:16px;display:grid;grid-template-columns:1fr;gap:16px;align-items:start;font-size:1.2rem;">
                                <label style="font-weight:600;color:#dbeeff;font-size:1.6rem;">Nombre y número (+2€)
                                     <input id="_opt_dorsal" placeholder="Ej: MESSI 10" style="width:100%;padding:16px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;margin-top:12px;font-size:1.3rem;" />
                                 </label>

                                <label style="font-weight:600;color:#dbeeff;font-size:1.6rem;">Parche (+1€)
                                    <select id="_opt_parche_select" class="custom-select" style="margin-top:8px;width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;font-size:1.1rem;">
                                        <option value="none">Ninguno</option>
                                        <option value="LaLiga">LaLiga</option>
                                        <option value="Premier League">Premier League</option>
                                        <option value="Ligue 1">Ligue 1</option>
                                        <option value="Serie A">Serie A</option>
                                        <option value="Bundesliga">Bundesliga</option>
                                        <option value="Champions League">Champions League</option>
                                        <option value="Europa League">Europa League</option>
                                        <option value="Eurocopa">Eurocopa</option>
                                        <option value="Otros">Otros</option>
                                    </select>
                                </label>
                                <label id="_opt_parche_otros_wrap" style="display:none;font-size:1.6rem;">
                                    <input id="_opt_parche_otros" placeholder="Indica el parche" style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;font-size:1.1rem;" />
                                </label>

                                <label style="font-weight:600;color:#dbeeff;font-size:1.6rem;"> Talla:
                                    <select id="_opt_talla" class="custom-select input-talla" style="margin-top:8px;width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;font-size:1.1rem;">
                                        <option value="S">S</option>
                                        <option value="M">M</option>
                                        <option value="L">L</option>
                                        <option value="XL">XL</option>
                                        <option value="2XL">2XL (+1€)</option>
                                        <option value="3XL">3XL (+2€)</option>
                                        <option value="4XL">4XL (+2€)</option>
                                    </select>
                                </label>

                                <label style="font-weight:600;color:#dbeeff;font-size:1.6rem;"> Versión (elige una):
                                    <select id="_opt_version" class="custom-select" style="margin-top:8px;width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;font-size:1.1rem;">
                                        <option value="" disabled selected>Selecciona versión</option>
                                        <option value="fan">FAN</option>
                                        <option value="jugador">JUGADOR (+5€)</option>
                                    </select>
                                </label>
                                <div style="margin-top:12px;text-align:center;">
                                    <button id="_sizeGuideBasic" type="button" style="background:transparent;color:var(--azul-acento);border:none;padding:0;cursor:pointer;font-family:inherit;font-size:1.5rem;font-weight:600;transition:all 0.2s ease;position:relative;padding-bottom:4px;display:inline-block;border-bottom:2px solid var(--azul-acento);">Guía de tallas</button>
                                </div>
                            </form>
                            <div style="margin-top:20px;display:flex;flex-direction:column;gap:16px;">
                                <button id="_addCart" class="btn-primary" style="padding:18px;font-size:1.4rem;">Personalizar y Comprar</button>
                                <button id="_closeModal" class="btn-secondary" style="padding:16px;font-size:1.3rem;">Cerrar</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
            if (!document.getElementById('modalTiendaResponsiveStyles')){
                const st = document.createElement('style'); st.id = 'modalTiendaResponsiveStyles';
                st.textContent = `
                 @media (max-width: 768px){
                     #modal-tienda-carrusel{ padding:0 !important; margin:0 !important; align-items:flex-start !important; overflow-x:hidden !important; width:100vw !important; max-width:100vw !important; left:0 !important; right:0 !important; }
                     #modal-tienda-carrusel .tienda-panel{ grid-template-columns:1fr !important; max-width:100vw !important; width:100vw !important; min-width:100vw !important; overflow:hidden !important; box-sizing:border-box !important; margin:0 !important; border-radius:0 !important; }
                     #modal-tienda-carrusel .tienda-panel > div{ max-width:100vw !important; width:100vw !important; box-sizing:border-box !important; }
                     #modal-tienda-carrusel .tienda-panel img{ max-width:100% !important; height:auto !important; }
                     #modalTiendaThumbs{ flex-wrap: wrap; }
                 }
                 @media (max-width: 480px){
                     #modal-tienda-carrusel{ padding:0 !important; }
                     #modal-tienda-carrusel .tienda-panel{ max-width:100vw !important; width:100vw !important; height:100dvh !important; max-height:100dvh !important; border-radius:0 !important; display:flex !important; flex-direction:column !important; gap:8px !important; overflow:hidden !important; }
                     #modal-tienda-carrusel .tienda-panel > div{ border-radius:0 !important; }
                     #modal-tienda-carrusel .tienda-panel > div:last-child{ flex:1 1 auto !important; overflow:auto !important; display:flex !important; flex-direction:column !important; }
                     #modal-tienda-carrusel .tienda-panel > div:first-child{ flex:0 0 auto !important; }
                     #modalTiendaCarousel{ width:100% !important; max-height:45vh !important; aspect-ratio:auto !important; }
                     #modalTiendaCarousel .carousel-track > div{ aspect-ratio:auto !important; height:auto !important; }
                     #modalTiendaCarousel img{ width:100% !important; height:auto !important; object-fit:cover !important; }
                     #modalTiendaThumbs{ overflow-x:auto !important; -webkit-overflow-scrolling:touch !important; justify-content:flex-start !important; gap:8px !important; padding:6px 8px !important; }
                     #modal-tienda-carrusel #modalTiendaPersonalizar{ position:sticky !important; bottom:0 !important; margin-top:auto !important; padding:12px !important; }
                     #modal-tienda-carrusel .tienda-panel > div:last-child form{ padding:12px !important; }
                     #modal-tienda-carrusel .tienda-panel > div:last-child h3{ font-size:1.1rem !important; margin-bottom:8px !important; }
                     #modal-tienda-carrusel .tienda-panel > div:last-child .btn-primary,
                     #modal-tienda-carrusel .tienda-panel > div:last-child .btn-secondary{ width:100% !important; margin:4px 0 !important; padding:12px !important; font-size:0.9rem !important; }
                 }
                 @media (max-width: 390px){
                     #modal-tienda-carrusel .tienda-panel > div:last-child{ padding:8px !important; }
                     #modal-tienda-carrusel .tienda-panel > div:last-child form{ padding:8px !important; }
                     #modal-tienda-carrusel .tienda-panel > div:last-child h3{ font-size:1rem !important; }
                     #modalTiendaCarousel{ max-height:40vh !important; }
                 }
                 `;
                document.head.appendChild(st);
            }

            const panel = modal.firstElementChild;
            function __fitPanel(){
                if (!panel) return;
                if (window.innerWidth <= 768) {

                    panel.style.transform = 'none';
                    panel.style.maxWidth = '240px';
                    panel.style.width = '85vw';
                    panel.style.margin = '0 auto';
                    panel.style.borderRadius = '6px';
                    panel.style.padding = '6px';
                    

                    if (window.innerWidth <= 480) {
                        panel.style.maxWidth = '220px';
                        panel.style.width = '80vw';
                        panel.style.padding = '5px';
                    }
                    

                    if (window.innerWidth <= 320) {
                        panel.style.maxWidth = '200px';
                        panel.style.width = '90vw';
                        panel.style.padding = '4px';
                    }
                    

                    const img = panel.querySelector('img');
                    if (img) {
                        img.style.width = '80px';
                        img.style.height = '80px';
                        
                        if (window.innerWidth <= 320) {
                            img.style.width = '70px';
                            img.style.height = '70px';
                        }
                    }
                } else {

                    panel.style.transformOrigin = 'center center';
                    panel.style.maxWidth = 'calc(100vw - 300px)';
                    panel.style.maxHeight = 'calc(100vh - 300px)';
                    panel.style.width = 'calc(100vw - 300px)';
                    panel.style.padding = '40px';
                    panel.style.margin = '150px';
                    panel.style.borderRadius = '20px';
                    panel.style.overflow = 'auto';
                    const availH = Math.max(0, window.innerHeight - 300);
                    const availW = Math.max(0, window.innerWidth - 300);
                    const rectH = panel.scrollHeight;
                    const rectW = panel.scrollWidth;
                    const scale = Math.min(1, (availH > 0 ? availH / rectH : 1), (availW > 0 ? availW / rectW : 1));
                    panel.style.transform = `scale(${scale})`;
                }
            }
            __fitPanel();
            window.addEventListener('resize', __fitPanel);

            function __closeProductModal(){
                window.removeEventListener('resize', __fitPanel);
                document.removeEventListener('keydown', onKeyDownProductModal);
                modal.remove();
                document.body.style.overflow = '';
            }
            
            function onKeyDownProductModal(e) {
                if (e.key === 'Escape') __closeProductModal();
            }
            
            modal.addEventListener('click', (e)=>{ if (e.target === modal) { __closeProductModal(); } });
            document.addEventListener('keydown', onKeyDownProductModal);

                try {
                    const imgsForViewer = (Array.isArray(product.images) && product.images.length) ? product.images : [product.img];
                    const mainImgEl = modal.querySelector('img');
                    if (mainImgEl) {
                        mainImgEl.style.cursor = 'zoom-in';
                        mainImgEl.addEventListener('click', (e)=>{ e.stopPropagation(); openImageViewer(imgsForViewer, 0); });
                    }
                } catch(e) {}

                modal.querySelector('#_closeModal').addEventListener('click', ()=> modal.remove());
                modal.addEventListener('click', (e) => { if (e.target === modal) modal.remove(); });

                const _sizeGuideBtn = modal.querySelector('#_sizeGuideBasic');
                if (_sizeGuideBtn) {
                    _sizeGuideBtn.addEventListener('click', ()=>{
                        const overlay = document.createElement('div');
                        overlay.style.position='fixed'; overlay.style.left=0; overlay.style.top=0; overlay.style.right=0; overlay.style.bottom=0;
                        overlay.style.background='rgba(0,0,0,0.85)'; overlay.style.zIndex=5000; overlay.style.display='flex'; overlay.style.alignItems='center'; overlay.style.justifyContent='center';
                        const isNBA = /^nba/i.test(product.id) || /\bNBA\b/i.test(product.name);
                        const isKids = /kids/i.test(product.id) || /\((kids|niños)\)/i.test(product.name);
                        const guideSrc = isKids ? 'assets/images/guia tallas niños.png' : (isNBA ? 'assets/images/guias tallas nba.png' : 'assets/images/guia tallas camisetas futbol.png');
                        const guideAlt = isKids ? 'Guía de tallas Niños' : (isNBA ? 'Guía de tallas NBA' : 'Guía de tallas Fútbol');
                        overlay.innerHTML = `
                            <div style="position:relative;width:auto;max-width:98vw;max-height:98vh;background:transparent;border-radius:12px;padding:0;box-shadow:0 12px 40px rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;overflow:auto;">
                                <button aria-label="Cerrar" style="position:absolute;top:8px;right:8px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.15);color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;font-weight:500;transition:all 0.2s ease;font-size:0.9rem;">✕ Cerrar</button>
                                <img src="${guideSrc}" alt="${guideAlt}" loading="lazy" style="${isKids ? 'height:65vh;max-height:65vh;max-width:88vw;width:auto;object-fit:contain;border-radius:6px;display:block;' : 'height:80vh;max-height:80vh;max-width:98vw;width:auto;object-fit:contain;border-radius:6px;display:block;'}">
                            </div>
                        `;
                        document.body.appendChild(overlay);
                        const panel = overlay.firstElementChild;
                        const closeBtn = panel.querySelector('button');
                        const close = ()=> {
                            document.removeEventListener('keydown', onKeyDownSizeGuide);
                            overlay.remove();
                        };
                        
                        function onKeyDownSizeGuide(e) {
                            if (e.key === 'Escape') close();
                        }
                        
                        closeBtn.addEventListener('click', (e)=>{ e.stopPropagation(); close(); });
                        overlay.addEventListener('click', (e)=>{ if (e.target === overlay) close(); });
                        document.addEventListener('keydown', onKeyDownSizeGuide);
                    });
                }
                try {
                    const __isKids = /kids/i.test(product.id) || /\((kids|niños)\)/i.test(product.name);
                    if (__isKids) {
                        const tallaSel = modal.querySelector('#_opt_talla');
                        if (tallaSel) {
                            tallaSel.innerHTML = `
                                <option value="16">16</option>
                                <option value="18">18</option>
                                <option value="20">20</option>
                                <option value="22">22</option>
                                <option value="24">24</option>
                                <option value="26">26</option>
                                <option value="28">28</option>
                            `;
                        }
                        const verSel = modal.querySelector('#_opt_version');
                        const verLabel = verSel ? verSel.parentElement : null;
                        if (verSel) verSel.value = 'none';
                        if (verLabel) verLabel.style.display = 'none';
                    }
                    const __isNBA = /^nba/i.test(product.id) || /\bNBA\b/i.test(product.name);
                    if (__isNBA) {
                        const verSel = modal.querySelector('#_opt_version');
                        const verLabel = verSel ? verSel.parentElement : null;
                        if (verLabel) verLabel.style.display = 'none';
                        const parcheSel = modal.querySelector('#_opt_parche_select');
                        const parcheLabel = parcheSel ? parcheSel.parentElement : null;
                        if (parcheLabel) parcheLabel.style.display = 'none';
                        const otrosWrap = modal.querySelector('#_opt_parche_otros_wrap');
                        if (otrosWrap) otrosWrap.style.display = 'none';
                        }
                } catch(e) {}

            try {
                if (product && Array.isArray(product.versions) && product.versions.length === 1) {
                    const verSelect = modal.querySelector('#_opt_version');
                    const verLabel = verSelect ? verSelect.parentElement : null;
                    if (verSelect) { verSelect.value = product.versions[0]; }
                    if (verLabel) { verLabel.style.display = 'none'; }
                }
            } catch(e) {  }

            const parcheSelect = modal.querySelector('#_opt_parche_select');
            const parcheOtrosWrap = modal.querySelector('#_opt_parche_otros_wrap');
            const parcheOtrosInput = modal.querySelector('#_opt_parche_otros');
            if (parcheSelect) {
                parcheSelect.addEventListener('change', function(){
                    if (this.value === 'Otros') { parcheOtrosWrap.style.display = ''; parcheOtrosInput.focus(); }
                    else { parcheOtrosWrap.style.display = 'none'; parcheOtrosInput.value = ''; }
                });
            }

             const versionSelectBasic = modal.querySelector('#_opt_version');
             if (versionSelectBasic) {
                 versionSelectBasic.addEventListener('change', function(){
                     if (this.value === 'jugador') {
                         const overlay = document.createElement('div');
                         overlay.style.position='fixed'; overlay.style.left=0; overlay.style.top=0; overlay.style.right=0; overlay.style.bottom=0;
                         overlay.style.background='rgba(0,0,0,0.55)'; overlay.style.zIndex=6000; overlay.style.display='flex'; overlay.style.alignItems='center'; overlay.style.justifyContent='center';
                         overlay.innerHTML = `
                             <div style="max-width:520px;background:#071735;color:#dbeeff;padding:16px 18px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.4);font-size:0.95rem;line-height:1.45;">
                                 <div style="margin-bottom:12px;">
                                     Has seleccionado la versión JUGADOR. Debes encontrar la camiseta en el siguiente enlace:<br>
                                     <a href="https://hxltds.x.yupoo.com/" target="_blank" rel="noopener noreferrer" style="color:#60a5fa;text-decoration:underline;word-break:break-all;">https://hxltds.x.yupoo.com/</a>.<br>
                                     Si no la encuentras, contáctanos primero por Instagram.
                                 </div>
                                 <div style="display:flex;justify-content:flex-end;gap:8px;">
                                     <button id="jugadorNoticeClose" type="button" style="background:#1f2a44;border:none;color:#dbeeff;padding:8px 12px;border-radius:8px;cursor:pointer;">Cerrar</button>
                                     <a href="https://hxltds.x.yupoo.com/" target="_blank" rel="noopener noreferrer" style="background:#2563eb;color:#fff;padding:8px 12px;border-radius:8px;text-decoration:none;">Abrir enlace</a>
                                 </div>
                             </div>`;
                         document.body.appendChild(overlay);
                         overlay.addEventListener('click', (e)=>{ if (e.target === overlay) overlay.remove(); });
                         const closeBtn = overlay.querySelector('#jugadorNoticeClose');
                         if (closeBtn) closeBtn.addEventListener('click', ()=> overlay.remove());
                     }
                 });
             }

            modal.querySelector('#_addCart').addEventListener('click', ()=>{
                const talla = modal.querySelector('#_opt_talla').value;
                const dorsal = modal.querySelector('#_opt_dorsal').value.trim();
                const __isNBA = /^nba/i.test(product.id) || /\bNBA\b/i.test(product.name);

                let parcheFinal = '';
                let version = 'none';
                if (!__isNBA) {
                    const parcheSel = modal.querySelector('#_opt_parche_select').value;
                    if (parcheSel === 'Otros') {
                        const otros = modal.querySelector('#_opt_parche_otros').value.trim();
                        if (!otros) { alert('Indica el parche en el campo "Otros".'); modal.querySelector('#_opt_parche_otros').focus(); return; }
                        parcheFinal = otros;
                    } else {
                        parcheFinal = (parcheSel === 'none' ? '' : parcheSel);
                    }
                    version = modal.querySelector('#_opt_version').value;
                    if (!version) { alert('Selecciona una versión antes de añadir al carrito.'); return; }
                }
                if (__isNBA && !dorsal) { alert('Debes introducir un dorsal para camisetas NBA.'); return; }
                addToCart({ productId: product.id, name: product.name, price: product.price, img: product.img, talla, dorsal, parche: parcheFinal, version });
                modal.remove();
                document.body.style.overflow = '';
            });
        }

        function openTiendaCarouselModal(product) {
            if (document.getElementById('modal-tienda-carrusel')) return;
            const modal = document.createElement('div');
            modal.id = 'modal-tienda-carrusel';
            modal.style.position = 'fixed';
            modal.style.left = 0; modal.style.top = 0; modal.style.right = 0; modal.style.bottom = 0;
            modal.style.display = 'flex';
            modal.style.alignItems = 'center';
            modal.style.justifyContent = 'center';
            modal.style.background = 'rgba(2,6,23,0.78)'; modal.style.zIndex = 1400;
            modal.style.padding = '24px';
            modal.style.overflow = 'auto';

            const imgs = Array.isArray(product.images) && product.images.length ? product.images : [product.img];
            const slidesHtml = imgs.map((src, i) => `<div style="flex:0 0 100%;width:100%;aspect-ratio:1/1;overflow:hidden;border-radius:4px;min-width:100%;"><img src="${src}" alt="Imagen ${i+1} de ${imgs.length}" loading="lazy" width="1512" height="1512" style="width:100%;height:100%;object-fit:cover;display:block;"></div>`).join('');
            const thumbsHtml = imgs.map((src, i) => `<img data-index="${i}" src="${src}" alt="Miniatura ${i+1} de ${imgs.length}" loading="lazy" style="width:40px;height:40px;object-fit:cover;border-radius:4px;cursor:pointer;border:2px solid rgba(255,255,255,0.06);">`).join('');

            modal.innerHTML = `
                <div class="tienda-panel" style="width:100%;max-width:720px;background:#071735;padding:8px;border-radius:8px;color:#dbeeff;display:grid;grid-template-columns:1fr 240px;gap:8px;overflow:visible;">
                    <div style="background:rgba(10,31,61,0.6);padding:6px;border-radius:6px;">
                        <div id="modalTiendaCarousel" style="position:relative;overflow:hidden;border-radius:8px;">
                            <button id="modalTiendaPrev" aria-label="Anterior" style="position:absolute;left:8px;top:50%;transform:translateY(-50%);z-index:5;background:rgba(0,0,0,0.4);border:none;color:#fff;padding:8px 10px;border-radius:8px;cursor:pointer;">‹</button>
                            <div class="carousel-track" style="display:flex;transition:transform .35s ease;">
                                ${slidesHtml}
                            </div>
                            <button id="modalTiendaNext" aria-label="Siguiente" style="position:absolute;right:8px;top:50%;transform:translateY(-50%);z-index:5;background:rgba(0,0,0,0.4);border:none;color:#fff;padding:8px 10px;border-radius:8px;cursor:pointer;">›</button>
                        </div>
                        <div id="modalTiendaThumbs" style="display:flex;gap:4px;margin-top:6px;justify-content:center;padding:3px;">
                            ${thumbsHtml}
                        </div>
                    </div>
                    <div style="background:rgba(10,31,61,0.9);padding:10px;border-radius:6px;border:1px solid rgba(42,91,168,0.12);overflow:visible;">
                        <h3 style="color:var(--azul-acento);margin-top:0;font-size:1rem;">${product.name}</h3>
                        <p style="color:#d6e9ff;font-size:0.8rem;margin:4px 0;">${product.excerpt}</p>
                        <div style="font-weight:800;color:#9fe0ff;font-size:1.1rem;margin:6px 0;">€${product.price.toFixed(2)}</div>
                        <div style="display:flex;gap:4px;flex-direction:column;">
                            <button id="modalTiendaPersonalizar" class="btn-primary" style="padding:6px 12px;font-size:0.8rem;">Personalizar y Comprar</button>
                        </div>
                    </div>
                </div>
                <button id="modalTiendaClose" aria-label="Cerrar" style="position:fixed;top:18px;right:18px;background:transparent;border:2px solid rgba(255,255,255,0.12);color:#fff;padding:8px 12px;border-radius:10px;cursor:pointer;z-index:1500;">Cerrar</button>
            `;

            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';

            const panel = modal.firstElementChild;
            function __fitTiendaPanel(){
                if (!panel) return;
                panel.style.transformOrigin = 'center center';
                if (window.innerWidth <= 768){ panel.style.transform = 'none'; return; }
                const availH = Math.max(0, window.innerHeight - 48);
                const availW = Math.max(0, window.innerWidth - 48);
                const rectH = panel.scrollHeight;
                const rectW = panel.scrollWidth;
                const scale = Math.min(1, (availH > 0 ? availH / rectH : 1), (availW > 0 ? availW / rectW : 1));
                panel.style.transform = scale < 1 ? `scale(${scale})` : 'none';
            }
            __fitTiendaPanel();
            window.addEventListener('resize', __fitTiendaPanel);

            function __closeTienda(){
                window.removeEventListener('resize', __fitTiendaPanel);
                document.removeEventListener('keydown', onKeyDownTiendaModal);
                modal.remove();
                document.body.style.overflow = '';
            }
            
            function onKeyDownTiendaModal(e) {
                if (e.key === 'Escape') __closeTienda();
            }
            
            document.getElementById('modalTiendaClose').addEventListener('click', ()=> { __closeTienda(); });
            document.addEventListener('keydown', onKeyDownTiendaModal);

            modal.addEventListener('click', (e) => { if (e.target === modal) { __closeTienda(); } });

            const track = modal.querySelector('.carousel-track');
            const slides = Array.from(track.querySelectorAll('div[style*="flex:0 0 100%"]'));
            let idx = 0;
            const prev = modal.querySelector('#modalTiendaPrev');
            const next = modal.querySelector('#modalTiendaNext');
            const thumbs = modal.querySelector('#modalTiendaThumbs');

            try { track.style.cursor = 'zoom-in'; track.addEventListener('click', (e)=>{ e.stopPropagation(); openImageViewer(imgs, idx); }); } catch(e) {}
            function update(){ track.style.transform = `translateX(-${idx * 100}%)`; Array.from(thumbs.children).forEach((t,i)=> t.style.outline = i===idx? '3px solid var(--azul-acento)' : 'none'); }
            prev && prev.addEventListener('click', (e)=>{ e.stopPropagation(); idx = (idx-1+slides.length)%slides.length; update(); });
            next && next.addEventListener('click', (e)=>{ e.stopPropagation(); idx = (idx+1)%slides.length; update(); });
            if (thumbs) thumbs.addEventListener('click', (e)=>{ const t = e.target.closest('img[data-index]'); if (!t) return; idx = parseInt(t.dataset.index,10); update(); });
            update();

            let autoplayTimer = null;
            function startAutoplay(){ if (autoplayTimer) clearInterval(autoplayTimer); autoplayTimer = setInterval(()=>{ idx = (idx+1)%slides.length; update(); }, 5000); }
            function stopAutoplay(){ if (autoplayTimer) { clearInterval(autoplayTimer); autoplayTimer = null; } }
            startAutoplay();
            const carouselWrap = modal.querySelector('#modalTiendaCarousel');
            [carouselWrap, prev, next, thumbs, modal].forEach(el => { if (!el) return; el.addEventListener('mouseenter', ()=> stopAutoplay()); el.addEventListener('mouseleave', ()=> startAutoplay()); });

            const rightCol = modal.querySelector('div[style*="background:rgba(10,31,61,0.9)"]');
            if (rightCol) {
                rightCol.innerHTML = `
                    <h3 style="color:var(--azul-acento);margin-top:0;font-size:1.4rem;" class="product-title-desktop">${product.name}</h3>
                    <p style="color:#d6e9ff;font-size:1.2rem;margin:4px 0;" class="product-excerpt-desktop">${product.excerpt}</p>
                    <div style="font-weight:800;color:#9fe0ff;font-size:1.4rem;margin:6px 0;" class="product-price-desktop">€${product.price.toFixed(2)}</div>
                    <form id="modalTiendaForm" style="display:grid;gap:4px;overflow:visible;font-size:0.8rem;">
                        <label style="font-weight:700;color:#dbeeff;font-size:1.3rem;">Nombre y número (+2€)
                             <input id="_opt_dorsal_modal" placeholder="Ej: JAMES 6" style="width:100%;padding:8px;border-radius:4px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;margin-top:8px;font-size:1.0rem;" />
                         </label>
                        <label style="font-size:1.3rem;">Talla:
                            <select id="_opt_talla_modal" class="custom-select input-talla" style="margin-top:3px;padding:4px;border-radius:4px;font-size:1.0rem;">
                                <option value="S">S</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                                <option value="XL">XL</option>
                                <option value="2XL">2XL (+1€)</option>
                                <option value="3XL">3XL (+2€)</option>
                                <option value="4XL">4XL (+2€)</option>
                            </select>
                        </label>
                        <div style="margin:2px 0 0 0;">
                            <button id="_sizeGuideCarousel" type="button" style="background:transparent;color:var(--azul-acento);border:none;padding:0;cursor:pointer;font-family:inherit;font-size:1.2rem;font-weight:600;transition:all 0.2s ease;position:relative;padding-bottom:1px;display:inline-block;transform:translateX(2px);border-bottom:1px solid var(--azul-acento);">Guía de tallas</button>
                        </div>
                        <div style="display:flex;gap:4px;justify-content:flex-end;margin-top:4px;">
                            <button id="modalTiendaAdd" type="button" class="btn-primary" style="padding:4px 8px;font-size:1.0rem;">Añadir al carrito</button>
                            <button id="modalTiendaCloseInline" type="button" class="btn-secondary" style="padding:4px 8px;font-size:1.0rem;">Cerrar</button>
                        </div>
                    </form>
                `;

                try {
                    const isNBA = /^nba/i.test(product.id) || /\bNBA\b/i.test(product.name);
                    const isKids = /kids/i.test(product.id) || /\((kids|niños)\)/i.test(product.name);
                    const form = rightCol.querySelector('#modalTiendaForm');
                    if (form && !isNBA) {

                        if (!rightCol.querySelector('#_opt_parche_select_modal')) {
                            const parcheHTML = `
                        <label style="font-weight:700;color:#dbeeff;font-size:1.3rem;">Parche (+1€)
                            <select id="_opt_parche_select_modal" class="custom-select" style="margin-top:3px;padding:4px;border-radius:4px;font-size:1.0rem;">
                                <option value="none">Ninguno</option>
                                <option value="LaLiga">LaLiga</option>
                                <option value="Premier League">Premier League</option>
                                <option value="Ligue 1">Ligue 1</option>
                                <option value="Serie A">Serie A</option>
                                <option value="Bundesliga">Bundesliga</option>
                                <option value="Champions League">Champions League</option>
                                <option value="Europa League">Europa League</option>
                                <option value="Eurocopa">Eurocopa</option>
                                <option value="Otros">Otros</option>
                            </select>
                        </label>
                        <label id="_opt_parche_otros_wrap_modal" style="display:none;font-size:1.3rem;"><input id="_opt_parche_otros_modal" placeholder="Indica el parche" style="width:100%;padding:4px;border-radius:4px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;font-size:1.0rem;" /></label>`;
                            const tallaLabel = rightCol.querySelector('#_opt_talla_modal')?.parentElement;
                            if (tallaLabel) tallaLabel.insertAdjacentHTML('beforebegin', parcheHTML);
                            else form.insertAdjacentHTML('beforeend', parcheHTML);
                        }

                        if (!isKids && !rightCol.querySelector('#_opt_version_modal')) {
                            const versionHTML = `
                        <label style="font-size:1.3rem;">Versión:
                            <select id="_opt_version_modal" class="custom-select" style="margin-top:3px;padding:4px;border-radius:4px;font-size:1.0rem;">
                                <option value="" disabled selected>Selecciona versión</option>
                                <option value="fan">FAN</option>
                                <option value="jugador">JUGADOR (+5€)</option>
                            </select>
                        </label>`;

                            const sizeGuideRow = form.querySelector('#_sizeGuideCarousel')?.closest('div');
                            if (sizeGuideRow) {
                                sizeGuideRow.insertAdjacentHTML('beforebegin', versionHTML);
                            } else {
                                const buttonsRow = form.querySelector('div[style*="justify-content:flex-end"]');
                                if (buttonsRow) buttonsRow.insertAdjacentHTML('beforebegin', versionHTML);
                                else form.insertAdjacentHTML('beforeend', versionHTML);
                            }
                        }

                        if (isKids) {
                            const tSel = rightCol.querySelector('#_opt_talla_modal');
                            if (tSel) {
                                tSel.innerHTML = ['16','18','20','22','24','26','28'].map(s=>`<option value="${s}">${s}</option>`).join('');
                            }
                        }
                    } else if (form && isNBA) {

                        const isKidsNBA = isKids;
                        const tSel = rightCol.querySelector('#_opt_talla_modal');
                        if (isKidsNBA) {
                            if (tSel) tSel.innerHTML = ['16','18','20','22','24','26','28'].map(s=>`<option value="${s}">${s}</option>`).join('');
                        } else {

                            if (tSel) {
                                ['3XL','4XL'].forEach(val => {
                                    const opt = tSel.querySelector(`option[value="${val}"]`);
                                    if (opt) opt.remove();
                                });
                                if (['3XL','4XL'].includes(tSel.value)) tSel.value = '2XL';
                            }
                        }
                    }
                } catch(e) {}

                const parcheSelectModal = rightCol.querySelector('#_opt_parche_select_modal');
                const parcheOtrosWrapModal = rightCol.querySelector('#_opt_parche_otros_wrap_modal');
                if (parcheSelectModal) parcheSelectModal.addEventListener('change', function(){ if (this.value === 'Otros') { parcheOtrosWrapModal.style.display = ''; } else { parcheOtrosWrapModal.style.display = 'none'; const inp = rightCol.querySelector('#_opt_parche_otros_modal'); if (inp) inp.value=''; } });

                const versionSelectModal = rightCol.querySelector('#_opt_version_modal');
                if (versionSelectModal) {
                    versionSelectModal.addEventListener('change', function(){
                        if (this.value === 'jugador') {
                            const overlay = document.createElement('div');
                            overlay.style.position='fixed'; overlay.style.left=0; overlay.style.top=0; overlay.style.right=0; overlay.style.bottom=0;
                            overlay.style.background='rgba(0,0,0,0.55)'; overlay.style.zIndex=6000; overlay.style.display='flex'; overlay.style.alignItems='center'; overlay.style.justifyContent='center';
                            overlay.innerHTML = `
                                <div style="max-width:520px;background:#071735;color:#dbeeff;padding:16px 18px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.4);font-size:0.95rem;line-height:1.45;">
                                    <div style="margin-bottom:12px;">
                                        Has seleccionado la versión JUGADOR. Debes encontrar la camiseta en el siguiente enlace:<br>
                                        <a href="https://hxltds.x.yupoo.com/" target="_blank" rel="noopener noreferrer" style="color:#60a5fa;text-decoration:underline;word-break:break-all;">https://hxltds.x.yupoo.com/</a>.<br>
                                        Si no la encuentras, contáctanos primero por Instagram.
                                    </div>
                                    <div style="display:flex;justify-content:flex-end;gap:8px;">
                                        <button id="jugadorNoticeClose2" type="button" style="background:#1f2a44;border:none;color:#dbeeff;padding:8px 12px;border-radius:8px;cursor:pointer;">Cerrar</button>
                                        <a href="https://hxltds.x.yupoo.com/" target="_blank" rel="noopener noreferrer" style="background:#2563eb;color:#fff;padding:8px 12px;border-radius:8px;text-decoration:none;">Abrir enlace</a>
                                    </div>
                                </div>`;
                            document.body.appendChild(overlay);
                            overlay.addEventListener('click', (e)=>{ if (e.target === overlay) overlay.remove(); });
                            const closeBtn = overlay.querySelector('#jugadorNoticeClose2');
                            if (closeBtn) closeBtn.addEventListener('click', ()=> overlay.remove());
                        }
                    });
                }

                try {
                    if (product && Array.isArray(product.versions) && product.versions.length === 1) {
                        const verSelModal = rightCol.querySelector('#_opt_version_modal');
                        const verLabelModal = verSelModal ? verSelModal.parentElement : null;
                        if (verSelModal) verSelModal.value = product.versions[0];
                        if (verLabelModal) verLabelModal.style.display = 'none';
                    }
                } catch(e) {}

                rightCol.querySelector('#modalTiendaAdd').addEventListener('click', ()=>{
                    const talla = rightCol.querySelector('#_opt_talla_modal').value;
                    const dorsal = rightCol.querySelector('#_opt_dorsal_modal').value.trim();
                    const isNBA = /^nba/i.test(product.id) || /\bNBA\b/i.test(product.name);

                    let parcheFinal = '';
                    let version = 'none';
                    if (isNBA) {

                        if (!dorsal) { alert('Debes introducir un dorsal para camisetas NBA.'); return; }
                    } else {

                        const parcheSelectEl = rightCol.querySelector('#_opt_parche_select_modal');
                        if (parcheSelectEl) {
                            const parcheSel = parcheSelectEl.value;
                            if (parcheSel === 'Otros') {
                                const otros = rightCol.querySelector('#_opt_parche_otros_modal').value.trim();
                                if (!otros) { alert('Indica el parche en el campo "Otros".'); rightCol.querySelector('#_opt_parche_otros_modal').focus(); return; }
                                parcheFinal = otros;
                            } else {
                                parcheFinal = (parcheSel === 'none' ? '' : parcheSel);
                            }
                        }
                        const versionEl = rightCol.querySelector('#_opt_version_modal');
                        version = versionEl ? versionEl.value : 'fan';
                        if (versionEl && !version) { alert('Selecciona una versión antes de añadir al carrito.'); return; }
                    }
                    addToCart({ productId: product.id, name: product.name, price: product.price, img: product.img, talla, dorsal, parche: parcheFinal, version });

                    stopAutoplay(); modal.remove(); document.body.style.overflow = '';
                });
                rightCol.querySelector('#modalTiendaCloseInline').addEventListener('click', ()=> { stopAutoplay(); modal.remove(); document.body.style.overflow = ''; });

                const sizeGuideBtn2 = rightCol.querySelector('#_sizeGuideCarousel');
                if (sizeGuideBtn2){
                    sizeGuideBtn2.addEventListener('click', ()=>{
                        const overlay = document.createElement('div');
                        overlay.style.position='fixed'; overlay.style.left=0; overlay.style.top=0; overlay.style.right=0; overlay.style.bottom=0;
                        overlay.style.background='rgba(0,0,0,0.85)'; overlay.style.zIndex=5000; overlay.style.display='flex'; overlay.style.alignItems='center'; overlay.style.justifyContent='center';
                        const isNBA2 = /^nba/i.test(product.id) || /\bNBA\b/i.test(product.name);
const isKids2 = /kids/i.test(product.id) || /\((kids|niños)\)/i.test(product.name);
const guideSrc2 = isKids2 ? 'assets/images/guia tallas niños.png' : (isNBA2 ? 'assets/images/guias tallas nba.png' : 'assets/images/guia tallas camisetas futbol.png');
const guideAlt2 = isKids2 ? 'Guía de tallas Niños' : (isNBA2 ? 'Guía de tallas NBA' : 'Guía de tallas Fútbol');
                        overlay.innerHTML = `
                            <div style="position:relative;width:auto;max-width:98vw;max-height:98vh;background:transparent;border-radius:12px;padding:0;box-shadow:0 12px 40px rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;overflow:auto;">
                                <button aria-label=\"Cerrar\" style=\"position:absolute;top:8px;right:8px;background:rgba(0,0,0,0.4);border:1px solid rgba(255,255,255,0.2);color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;\">Cerrar</button>
                                <img src=\"${guideSrc2}\" alt=\"${guideAlt2}\" loading=\"lazy\" style=\"${isKids2 ? 'height:65vh;max-height:65vh;max-width:88vw;width:auto;object-fit:contain;border-radius:6px;display:block;' : 'height:80vh;max-height:80vh;max-width:98vw;width:auto;object-fit:contain;border-radius:6px;display:block;'}\">
                            </div>
                        `;
                        document.body.appendChild(overlay);
                        const panel = overlay.firstElementChild;
                        const closeBtn = panel.querySelector('button');
                        const close = ()=> {
                            document.removeEventListener('keydown', onKeyDownSizeGuide2);
                            overlay.remove();
                        };
                        
                        function onKeyDownSizeGuide2(e) {
                            if (e.key === 'Escape') close();
                        }
                        
                        closeBtn.addEventListener('click', (e)=>{ e.stopPropagation(); close(); });
                        overlay.addEventListener('click', (e)=>{ if (e.target === overlay) close(); });
                        document.addEventListener('keydown', onKeyDownSizeGuide2);
                    });
                }
            }
        }

        function openImageViewer(images, startIndex) {
            if (!Array.isArray(images) || images.length === 0) return;
            let idx = Math.max(0, Math.min(startIndex || 0, images.length - 1));

            const overlay = document.createElement('div');
            overlay.id = 'image-viewer-overlay';
            overlay.style.position = 'fixed';
            overlay.style.left = 0; overlay.style.top = 0; overlay.style.right = 0; overlay.style.bottom = 0;
            overlay.style.background = 'rgba(0,0,0,0.88)';
            overlay.style.zIndex = 6000;
            overlay.style.display = 'flex';
            overlay.style.alignItems = 'center';
            overlay.style.justifyContent = 'center';

            overlay.innerHTML = `
                <div id="iv-panel" style="position:relative;width:92vw;max-width:1200px;height:86vh;max-height:900px;display:flex;align-items:center;justify-content:center;overflow:hidden;border-radius:12px;background:rgba(0,0,0,0.1);border:1px solid rgba(255,255,255,0.12);">
                    <img id="iv-img" src="${images[idx]}" alt="Imagen ${idx+1}" loading="lazy" width="1512" height="1512" style="max-width:100%;max-height:100%;object-fit:contain;will-change:transform;touch-action:none;user-select:none;cursor:zoom-in;" />
                    <button id="iv-prev" aria-label="Anterior" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);z-index:2;background:rgba(0,0,0,0.45);border:1px solid rgba(255,255,255,0.2);color:#fff;padding:10px 12px;border-radius:10px;cursor:pointer;font-size:20px;">‹</button>
                    <button id="iv-next" aria-label="Siguiente" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);z-index:2;background:rgba(0,0,0,0.45);border:1px solid rgba(255,255,255,0.2);color:#fff;padding:10px 12px;border-radius:10px;cursor:pointer;font-size:20px;">›</button>
                    <div id="iv-controls" style="position:absolute;bottom:12px;left:50%;transform:translateX(-50%);display:flex;gap:8px;background:rgba(0,0,0,0.45);padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.15);align-items:center;">
                        <button id="iv-toggle" style="background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;">Alternar zoom</button>
                        <button id="iv-reset" style="background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;">Restablecer</button>
                        <span id="iv-index" style="color:#fff;opacity:.8;font-size:.9rem;">${idx+1}/${images.length}</span>
                    </div>
                    <button id="iv-close" aria-label="Cerrar" style="position:absolute;top:12px;right:12px;background:rgba(0,0,0,0.45);border:1px solid rgba(255,255,255,0.2);color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;">✕ Cerrar</button>
                </div>
            `;

            document.body.appendChild(overlay);

            const __prevScrollY = window.scrollY;
            const __prevOverflow = document.body.style.overflow;
            const __prevPosition = document.body.style.position;
            const __prevTop = document.body.style.top;
            const __prevWidth = document.body.style.width;
            document.body.style.overflow = 'hidden';
            document.body.style.position = 'fixed';
            document.body.style.top = `-${__prevScrollY}px`;
            document.body.style.width = '100%';

            const panel = overlay.querySelector('#iv-panel');
            const img = overlay.querySelector('#iv-img');
            const btnPrev = overlay.querySelector('#iv-prev');
            const btnNext = overlay.querySelector('#iv-next');
            const btnClose = overlay.querySelector('#iv-close');
            const btnToggle = overlay.querySelector('#iv-toggle');
            const btnReset = overlay.querySelector('#iv-reset');
            const idxLabel = overlay.querySelector('#iv-index');

            let scale = 1, tx = 0, ty = 0;
            const minScale = 1, maxScale = 5;
            let isPanning = false, startX = 0, startY = 0, lastX = 0, lastY = 0;
            let lastTapTime = 0;
            let pinchStartDist = 0, pinchStartScale = 1;
            let panMovedMouse = false, movedDuringPanTouch = false;

            function clampPan(){
                const panelW = panel.clientWidth; const panelH = panel.clientHeight;
                const naturalW = img.naturalWidth; const naturalH = img.naturalHeight;
                if (!naturalW || !naturalH) return;
                if (scale <= 1) { tx = 0; ty = 0; return; }
                let baseW = panelW; let baseH = baseW * (naturalH / naturalW);
                if (baseH > panelH) { baseH = panelH; baseW = baseH * (naturalW / naturalH); }
                const scaledW = baseW * scale; const scaledH = baseH * scale;
                const maxX = Math.max(0, (scaledW - panelW) / 2);
                const maxY = Math.max(0, (scaledH - panelH) / 2);
                tx = (scaledW <= panelW) ? 0 : Math.max(-maxX, Math.min(maxX, tx));
                ty = (scaledH <= panelH) ? 0 : Math.max(-maxY, Math.min(maxY, ty));
            }
            function applyTransform(){ clampPan(); img.style.transform = `translate(${tx}px, ${ty}px) scale(${scale})`; }
            function resetTransform(){
                scale = 1; tx = 0; ty = 0;
                isPanning = false;
                panMovedMouse = false;
                movedDuringPanTouch = false;
                lastPanEnd = 0;
                lastTapTime = 0;
                img.style.cursor = 'zoom-in';
                applyTransform();
            }
            function updateIndex(){ if (idxLabel) idxLabel.textContent = `${idx+1}/${images.length}`; }
            function showImage(newIdx){ idx = (newIdx + images.length) % images.length; img.src = images[idx]; resetTransform(); updateIndex(); }

            btnPrev.addEventListener('click', (e)=>{ e.stopPropagation(); showImage(idx - 1); });
            btnNext.addEventListener('click', (e)=>{ e.stopPropagation(); showImage(idx + 1); });

            function close(){
                document.removeEventListener('keydown', onKey);
                overlay.remove();

                document.body.style.overflow = __prevOverflow;
                document.body.style.position = __prevPosition;
                document.body.style.top = __prevTop;
                document.body.style.width = __prevWidth;
                window.scrollTo(0, __prevScrollY);
            }
            btnClose.addEventListener('click', (e)=>{ e.stopPropagation(); close(); });

            let lastPanEnd = 0;
            overlay.addEventListener('click', (e)=>{ if (e.target === overlay && Date.now() - lastPanEnd > 200) close(); });
            function onKey(e){ if (e.key === 'Escape') close(); else if (e.key === 'ArrowLeft') showImage(idx-1); else if (e.key === 'ArrowRight') showImage(idx+1); }
            document.addEventListener('keydown', onKey);

            btnToggle.addEventListener('click', (e)=>{ e.stopPropagation(); if (scale === 1) { scale = 2; img.style.cursor = 'grab'; } else { resetTransform(); } applyTransform(); });
            btnReset.addEventListener('click', (e)=>{ e.stopPropagation(); resetTransform(); });

            panel.addEventListener('wheel', (e)=>{
                e.preventDefault();
                const delta = -e.deltaY;
                const factor = Math.exp(delta * 0.0015);
                const newScale = Math.min(maxScale, Math.max(minScale, scale * factor));
                if (newScale !== scale) {
                    scale = newScale;
                    img.style.cursor = scale > 1 ? 'grab' : 'zoom-in';
                    applyTransform();
                }
            }, { passive: false });

            img.addEventListener('mousedown', (e)=>{
                if (scale <= 1) return;
                isPanning = true;
                img.style.cursor = 'grabbing';
                startX = e.clientX; startY = e.clientY; lastX = tx; lastY = ty;
                panMovedMouse = false;
                e.preventDefault();
            });
            window.addEventListener('mousemove', (e)=>{
                if (!isPanning) return;
                tx = lastX + (e.clientX - startX);
                ty = lastY + (e.clientY - startY);
                if (!panMovedMouse) {
                    const dx = e.clientX - startX;
                    const dy = e.clientY - startY;
                    if (Math.hypot(dx, dy) > 3) panMovedMouse = true;
                }
                applyTransform();
            });
            window.addEventListener('mouseup', ()=>{ if (isPanning) { isPanning = false; img.style.cursor = 'grab'; lastPanEnd = Date.now(); } });

            img.addEventListener('click', (e)=>{
                if (Date.now() - lastPanEnd < 250 || panMovedMouse) { e.stopPropagation(); e.preventDefault(); return; }
                e.preventDefault();
                if (scale === 1) { scale = 2; img.style.cursor = 'grab'; } else { resetTransform(); }
                applyTransform();
            });

            img.addEventListener('dblclick', (e)=>{
                if (Date.now() - lastPanEnd < 250 || panMovedMouse) { e.stopPropagation(); e.preventDefault(); return; }
                e.preventDefault();
                if (scale === 1) { scale = 2; img.style.cursor = 'grab'; } else { resetTransform(); }
                applyTransform();
            });

            let swipeStartX = 0, swipeStartY = 0, swipeActive = false;
            panel.addEventListener('touchstart', (e)=>{
                if (e.touches.length === 2) {
                    const dx = e.touches[0].clientX - e.touches[1].clientX;
                    const dy = e.touches[0].clientY - e.touches[1].clientY;
                    pinchStartDist = Math.hypot(dx, dy);
                    pinchStartScale = scale;
                    swipeActive = false;
                } else if (e.touches.length === 1) {
                    swipeStartX = e.touches[0].clientX; swipeStartY = e.touches[0].clientY;
                    if (scale > 1) {
                        isPanning = true;
                        startX = swipeStartX; startY = swipeStartY; lastX = tx; lastY = ty;
                        movedDuringPanTouch = false;
                        swipeActive = false;
                    } else {

                        swipeActive = true;
                    }
                }
            }, { passive: false });
            panel.addEventListener('touchmove', (e)=>{
                if (e.touches.length === 2) {
                    e.preventDefault();
                    const dx = e.touches[0].clientX - e.touches[1].clientX;
                    const dy = e.touches[0].clientY - e.touches[1].clientY;
                    const dist = Math.hypot(dx, dy);
                    const newScale = Math.min(maxScale, Math.max(minScale, (dist / pinchStartDist) * pinchStartScale));
                    if (newScale !== scale) { scale = newScale; img.style.cursor = scale > 1 ? 'grab' : 'zoom-in'; applyTransform(); }
                } else if (e.touches.length === 1) {
                    if (isPanning) {
                        e.preventDefault();
                        const curX = e.touches[0].clientX;
                        const curY = e.touches[0].clientY;
                        tx = lastX + (curX - startX);
                        ty = lastY + (curY - startY);
                        if (!movedDuringPanTouch) {
                            const dx = curX - startX; const dy = curY - startY;
                            if (Math.hypot(dx, dy) > 3) movedDuringPanTouch = true;
                        }
                        applyTransform();
                    } else if (swipeActive) {
                        const dxSwipe = e.touches[0].clientX - swipeStartX;
                        const dySwipe = e.touches[0].clientY - swipeStartY;

                        if (Math.abs(dxSwipe) > 24 && Math.abs(dxSwipe) > Math.abs(dySwipe)) {
                            e.preventDefault();
                            swipeActive = false;
                            if (dxSwipe < 0) showImage(idx + 1); else showImage(idx - 1);
                        }
                    }
                }
            }, { passive: false });
            panel.addEventListener('touchend', (e)=>{
                if (e.touches.length === 0) {
                    const wasPanning = isPanning;
                    if (isPanning) { isPanning = false; lastPanEnd = Date.now(); }

                    if (movedDuringPanTouch) { movedDuringPanTouch = false; return; }
                    const now = Date.now();
                    if (!wasPanning && (now - lastTapTime < 300)) {
                        if (scale === 1) { scale = 2; img.style.cursor = 'grab'; } else { resetTransform(); }
                        applyTransform();
                        lastTapTime = 0;
                    } else {
                        lastTapTime = now;
                    }
                }
            });
        }

        function addToCart(item){

            let extra = 0;
            if (item.parche) extra += EXTRAS.parche;
            if (item.dorsal) extra += EXTRAS.dorsal;

            if (item.version === 'jugador') extra += EXTRAS.versionJugador;
            else if (item.talla === '3XL') extra += 2;
            else if (item.talla === '4XL') extra += 2;
            const total = (item.price + extra);
            const cartItem = { id: Date.now().toString(36), productId: item.productId, name: item.name, img: item.img, price: item.price, extra, talla: item.talla, dorsal: item.dorsal, parche: item.parche, version: item.version, total };
            CART.push(cartItem);
            renderCart();
            try {
                const totalTxt = byId('cartTotal') ? byId('cartTotal').textContent : '';
                const totalNum = parseFloat(totalTxt);
                if (!isNaN(totalNum) && typeof window.showCartTotalToast === 'function') {
                    window.showCartTotalToast(totalNum);
                }

            } catch (e) {}
        }

        function renderCart(){
            const list = byId('cartItems');
                list.innerHTML = '';
            let subtotal = 0;

            const grouped = {};
            CART.forEach(ci => {
                subtotal += ci.total;
                const key = `${ci.productId}::${ci.talla}::${ci.version || 'none'}::${ci.dorsal || 'none'}::${ci.parche || 'none'}`;
                if (!grouped[key]) grouped[key] = { ...ci, cantidad: 0 };
                grouped[key].cantidad += 1;

            });
            Object.keys(grouped).forEach(key => {
                const ci = grouped[key];
                const row = document.createElement('div'); row.className = 'cart-item';
                const parcheLabel = ci.parche ? `<small>Parche: ${ci.parche}</small>` : '';
                row.innerHTML = `
                    <img src="${ci.img}" alt="${ci.name}">
                    <div class="meta"><b>${ci.name}</b><small>${ci.talla} ${ci.dorsal? '· ' + ci.dorsal : ''} ${ci.version !== 'none' ? '· ' + ci.version : ''}</small>${parcheLabel}<small>Extras: €${ci.extra.toFixed(2)}</small></div>
                    <div style="text-align:right">
                        <div style="font-weight:700">€${(ci.total * ci.cantidad).toFixed(2)}</div>
                        <div style="margin-top:10px;display:flex;gap:8px;align-items:center;justify-content:flex-end;">
                            <button class="decrease" data-key="${key}" aria-label="Disminuir" style="width:32px;height:32px;border-radius:8px;background:linear-gradient(180deg, var(--azul-acento) 0%, #1a3b6d 100%);color:#fff;border:1px solid rgba(255,255,255,0.12);box-shadow:0 2px 8px rgba(0,0,0,0.15);font-size:18px;font-weight:bold;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease;">−</button>
                            <input class="cart-qty-input" data-key="${key}" value="${ci.cantidad}" style="width:48px;height:32px;text-align:center;border-radius:8px;border:1px solid rgba(255,255,255,0.15);background:rgba(255,255,255,0.08);color:#fff;font-weight:600;" />
                            <button class="increase" data-key="${key}" aria-label="Aumentar" style="width:32px;height:32px;border-radius:8px;background:linear-gradient(180deg, var(--azul-acento) 0%, #1a3b6d 100%);color:#fff;border:1px solid rgba(255,255,255,0.12);box-shadow:0 2px 8px rgba(0,0,0,0.15);font-size:18px;font-weight:bold;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease;">+</button>
                            <button class="remove" data-key="${key}" style="margin-left:8px;height:32px;padding:0 12px;border-radius:8px;background:rgba(255,50,50,0.2);color:#ff5050;border:1px solid rgba(255,80,80,0.3);font-weight:600;transition:all 0.2s ease;">Eliminar</button>
                        </div>
                    </div>
                `;
                list.appendChild(row);
            });

            const countEl = byId('cartCount');
            if (countEl) countEl.textContent = CART.length.toString();

            (function(){
                const cartBtn = document.querySelector('.boton-seccion[data-seccion="carrito"]');
                if (!cartBtn) return;
                let badge = cartBtn.querySelector('.cart-tab-badge');
                if (!badge) {
                    badge = document.createElement('span');
                    badge.className = 'cart-tab-badge';
                    cartBtn.appendChild(badge);
                }
                const totalQty = Array.isArray(CART) ? CART.length : 0;
                if (totalQty > 0) {
                    badge.textContent = String(totalQty);
                    badge.classList.remove('hidden');
                } else {
                    badge.textContent = '0';
                    badge.classList.add('hidden');
                }
            })();

            if (CART.length === 0) {
                list.innerHTML = '<div class="cart-empty">Tu carrito está vacío<br><small>Agrega productos para empezar</small></div>';
            }

            function isShirt(ci){
                if (!ci || !ci.name) return false;
                const n = ci.name.toLowerCase();
                return ci.productId === 'barca1' || n.indexOf('camiseta') !== -1 || n.indexOf('camisetas') !== -1;
            }

            const shirtItems = CART.filter(isShirt);
            const nonShirtItems = CART.filter(ci => !isShirt(ci));

            const shirtCount = shirtItems.length;
            const shirtExtrasSum = shirtItems.reduce((s, it) => s + (it.extra || 0), 0);
            const shirtBaseSum = shirtItems.reduce((s, it) => s + (it.price || 0), 0);

            const baseOffer = (OFFERS && OFFERS.find(o=>o.size===1) && OFFERS.find(o=>o.size===1).price) ? OFFERS.find(o=>o.size===1).price : 19.90;
            const shirtPriceSurplus = shirtItems.reduce((s,it) => s + Math.max(0, (it.price || 0) - baseOffer), 0);

            const nonShirtTotal = nonShirtItems.reduce((s,it)=> s + (it.total || 0), 0);

            const originalTotal = (subtotal + (CART.length>0? SHIPPING : 0));

            let appliedOffer = null;
            let newSubtotal = subtotal;
            let newShipping = (CART.length>0? SHIPPING : 0);

            if (shirtCount > 0){
                const best = computeBestOfferForCount(shirtCount);

                const shirtsOfferCost = best.total + shirtExtrasSum + shirtPriceSurplus;

                const shirtsOfferShipping = (shirtCount > 1) ? 0 : best.shipping;

                newSubtotal = nonShirtTotal + shirtsOfferCost;

                newShipping = (shirtCount > 1) ? 0 : (shirtsOfferShipping + (nonShirtItems.length>0 ? SHIPPING : 0));
                appliedOffer = { count: shirtCount, detail: best, shirtsOfferCost, shirtsOfferShipping };
            }

            const total = (CART.length>0) ? (newSubtotal + newShipping) : 0;

            byId('cartSubtotal').textContent = newSubtotal.toFixed(2) + '€';
            byId('cartShipping').textContent = newShipping.toFixed(2) + '€';
            byId('cartTotal').textContent = total.toFixed(2) + '€';

            const totalsContainer = document.querySelector('.cart-totals');
            if (totalsContainer){

                const prev = totalsContainer.querySelector('.offer-summary'); if (prev) prev.remove();
                    if (appliedOffer){

                        let savings = 0;
                        try { const computed = computeCartTotals(); if (computed && computed.savings !== undefined) savings = Number(computed.savings); else savings = (originalTotal - total); } catch(e){ savings = (originalTotal - total); }

                        const displayedSavings = Number(savings);
                    const box = document.createElement('div');
                    box.className = 'offer-summary';
                    box.style.margin = '10px 0';
                    box.style.padding = '8px';
                    box.style.borderRadius = '8px';
                    box.style.background = 'linear-gradient(90deg, rgba(255,250,230,0.04), rgba(180,220,255,0.02))';
                    box.innerHTML = `
                        <div style="font-weight:800;color:#ffd966">Oferta aplicada: ${appliedOffer.count} camisetas</div>
                        <div style="color:#cfe7ff;font-size:0.95rem">Ahorro estimado: <strong>€${displayedSavings.toFixed(2)}</strong></div>
                        <div style="color:#bcd9ff;font-size:0.9rem">Detalle: ${Object.keys(appliedOffer.detail.combo).map(sz => `${appliedOffer.detail.combo[sz]}×${sz}`).join(' + ')}</div>
                    `;
                    totalsContainer.insertBefore(box, totalsContainer.firstChild);
                }
            }

            list.querySelectorAll('.remove').forEach(btn => btn.addEventListener('click', ()=>{
                const key = btn.dataset.key;
                if (!key) return;
                const [productId, talla, version, dorsal, parche] = key.split('::');
                CART = CART.filter(i => !(i.productId === productId && i.talla === talla && (i.version || 'none') === version && (i.dorsal || 'none') === dorsal && (i.parche || 'none') === parche));
                renderCart();
            }));
            list.querySelectorAll('.increase').forEach(btn => btn.addEventListener('click', ()=>{
                const key = btn.dataset.key;

                const [productId, talla, version, dorsal, parche] = key.split('::');
                const item = CART.find(i=> i.productId === productId && i.talla === talla && (i.version || 'none') === version && (i.dorsal || 'none') === dorsal && (i.parche || 'none') === parche);
                if (item) CART.push(Object.assign({}, item, { id: Date.now().toString(36) }));
                renderCart();
            }));
            list.querySelectorAll('.decrease').forEach(btn => btn.addEventListener('click', ()=>{
                const key = btn.dataset.key;
                const [productId, talla, version, dorsal, parche] = key.split('::');

                for (let i = CART.length-1; i>=0; i--) {
                    const it = CART[i];
                    if (it.productId === productId && it.talla === talla && (it.version || 'none') === version && (it.dorsal || 'none') === dorsal && (it.parche || 'none') === parche) { CART.splice(i,1); break; }
                }
                renderCart();
            }));
            list.querySelectorAll('.cart-qty-input').forEach(inp => inp.addEventListener('change', ()=>{
                const key = inp.dataset.key;
                const v = Math.max(1, parseInt(inp.value) || 1);
                const [productId, talla, version, dorsal, parche] = key.split('::');

                const current = CART.filter(i=> i.productId === productId && i.talla === talla && (i.version || 'none') === version && (i.dorsal || 'none') === dorsal && (i.parche || 'none') === parche).length;
                if (v > current) {
                    const item = CART.find(i=> i.productId === productId && i.talla === talla && (i.version || 'none') === version && (i.dorsal || 'none') === dorsal && (i.parche || 'none') === parche);
                    for (let k=0;k < v-current; k++) { if (item) CART.push(Object.assign({}, item, { id: Date.now().toString(36) })); }
                } else if (v < current) {
                    let toRemove = current - v;
                    for (let i = CART.length-1; i>=0 && toRemove>0; i--) {
                        const it = CART[i];
                        if (it.productId === productId && it.talla === talla && (it.version || 'none') === version && (it.dorsal || 'none') === dorsal && (it.parche || 'none') === parche) { CART.splice(i,1); toRemove--; }
                    }
                }
                renderCart();
            }));

            try { updateCartPromoBanner(); } catch(e) {}

            try { if (typeof updateRecommendations === 'function') updateRecommendations(); } catch(e) {}
        }

        function clearCart(){ CART = []; renderCart(); }

        const _origClearCart = clearCart;
        function clearCart(){ CART = []; renderCart();

            try { setTimeout(() => { const evt = new Event('resize'); window.dispatchEvent(evt); }, 80); } catch(e){}
        }

        function openCheckout(){
            const total = parseFloat(byId('cartTotal').textContent);
            if (!total || total <= 0) { alert('Tu carrito está vacío. Añade algún producto antes de proceder al checkout.'); return; }

            if (document.getElementById('checkoutModal')) return;
            const modal = document.createElement('div');
            modal.id = 'checkoutModal';
            modal.style.position = 'fixed'; modal.style.left = 0; modal.style.top = 0; modal.style.right = 0; modal.style.bottom = 0; modal.style.display = 'flex'; modal.style.alignItems = 'center'; modal.style.justifyContent = 'center'; modal.style.background = 'rgba(2,6,23,0.78)'; modal.style.zIndex = 3001;
            modal.innerHTML = `
                <div style="width:92%;max-width:760px;background:#071735;padding:16px;border-radius:10px;color:#dbeeff;">
                    <h3 style="margin-top:0;color:var(--azul-acento);">Resumen de pedido y datos de envío</h3>
                    <div style="margin-bottom:10px;color:#cfe7ff">Total a pagar: <strong>€${total.toFixed(2)}</strong></div>
                    <div id="checkoutSummary" style="background:rgba(255,255,255,0.03);padding:10px;border-radius:8px;margin-bottom:12px;max-height:200px;overflow:auto;"></div>
                    <div id="checkoutGrid" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:8px;">
                        <input id="checkoutContactName" class="checkout-input" placeholder="Contact Name:" />
                        <input id="checkoutAddressLine" class="checkout-input" placeholder="Address Line:" />
                        <input id="checkoutCity" class="checkout-input" placeholder="City:" />
                        <input id="checkoutState" class="checkout-input" placeholder="State:" />
                        <input id="checkoutCountry" class="checkout-input" placeholder="Country:" />
                        <input id="checkoutPostal" class="checkout-input" placeholder="Postal Code:" />
                        <input id="checkoutPhone" class="checkout-input" placeholder="Phone Number:" />
                        <input id="checkoutPaypalEmail" class="checkout-input" placeholder="PayPal Email:" />
                        <input id="checkoutInstagram" class="checkout-input" placeholder="@Instagram" />
                    </div>
                    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:6px;">
                                <button id="checkoutCancel" class="btn-secondary">Cancelar</button>
                                <button id="checkoutConfirm" class="btn-primary">Pagar con PayPal</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            try {
                const content = modal.firstElementChild;
                if (content) {
                    content.style.maxHeight = '100dvh';
                    content.style.display = 'flex';
                    content.style.flexDirection = 'column';

                    const grid = content.querySelector('#checkoutGrid');
                    if (grid) {
                        grid.style.flex = '1 1 auto';
                        grid.style.minHeight = '0';
                        grid.style.overflow = 'auto';
                    }
                    const actions = content.querySelector('#checkoutConfirm')?.parentElement;
                    if (actions) {
                        actions.style.position = 'sticky';
                        actions.style.bottom = '8px';
                        actions.style.background = 'rgba(7,23,53,0.95)';
                        actions.style.paddingTop = '8px';
                        actions.style.marginTop = '6px';
                    }
                }
            } catch(e) {  }

            if (!document.getElementById('checkoutResponsiveStyles')){
                const stc = document.createElement('style'); stc.id = 'checkoutResponsiveStyles';
                stc.textContent = `
                @media (max-width: 768px){
                    #checkoutModal{ align-items:flex-start !important; padding:12px !important; }
                    #checkoutModal > div{ padding-bottom: calc(16px + env(safe-area-inset-bottom, 0px)) !important; }
                    #checkoutModal > div{ width:100% !important; max-width:100% !important; }
                    #checkoutGrid{ grid-template-columns:1fr !important; }
                    #checkoutSummary{ max-height:40vh !important; }
                }
                `;
                document.head.appendChild(stc);
            }

            const summary = modal.querySelector('#checkoutSummary');
            function renderSummary(){
                console.log('renderSummary: CART length =', CART.length);
                summary.innerHTML = '';
                let subtotal = 0;
                CART.forEach(ci => {
                    subtotal += ci.total;
                    const item = document.createElement('div');
                    item.style.padding = '8px 0';
                    const parche = ci.parche ? `<div style="color:#bcd9ff;font-size:0.95rem">Parche: ${ci.parche} (+€${(ci.parche? EXTRAS.parche:0).toFixed(2)})</div>` : '';
                    const dorsal = ci.dorsal ? `<div style="color:#bcd9ff;font-size:0.95rem">Dorsal: ${ci.dorsal} (+€${(ci.dorsal? EXTRAS.dorsal:0).toFixed(2)})</div>` : '';
                    const version = (ci.version && ci.version !== 'none') ? (ci.version === 'jugador' ? `<div style="color:#bcd9ff;font-size:0.95rem">Versión: ${ci.version} (+€${EXTRAS.versionJugador.toFixed(2)})</div>` : `<div style=\"color:#bcd9ff;font-size:0.95rem\">Versión: ${ci.version}</div>`) : '';
                    item.innerHTML = `
                        <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:8px;">
                            <div style="flex:1">
                                <strong>${ci.name}</strong>
                                <div style="color:#d6e9ff;font-size:0.95rem">Talla: ${ci.talla} ${ci.version && ci.version !== 'none' ? '· ' + ci.version : ''}</div>
                                ${parche}${dorsal}${version}
                                <div style="color:#bcd9ff;font-size:0.9rem">Extras: €${ci.extra.toFixed(2)}</div>
                            </div>
                            <div style="text-align:right"><div style="font-weight:800">€${ci.total.toFixed(2)}</div></div>
                        </div>
                    `;
                    summary.appendChild(item);
                });

                const totals = document.createElement('div');
                totals.style.marginTop = '10px';
                const computed = computeCartTotals();

                const displayedSavingsModal = computed.savings ? Number(computed.savings) : 0;
                totals.innerHTML = `
                        <div style="display:flex;justify-content:space-between;color:#cfe7ff"><div>Subtotal</div><div>€${computed.subtotal.toFixed(2)}</div></div>
                        <div style="display:flex;justify-content:space-between;color:#cfe7ff"><div>Gastos envío</div><div>€${computed.shipping.toFixed(2)}</div></div>
                        ${displayedSavingsModal>0? `<div style="display:flex;justify-content:space-between;color:#ffd966;font-weight:800"><div>Ahorro total</div><div>€${displayedSavingsModal.toFixed(2)}</div></div>`: ''}
                        <div style="display:flex;justify-content:space-between;font-weight:800;margin-top:6px"><div>Total</div><div>€${computed.total.toFixed(2)}</div></div>
                        <div style="margin-top:8px;color:#9aaed9;font-size:0.9rem">ENVIO EXPRESS 5-15 DIAS</div>
                    `;
                summary.appendChild(totals);
            }
            renderSummary();

            function closeCheckoutModal() {
                document.removeEventListener('keydown', onKeyDownCheckoutModal);
                modal.remove();
                document.body.style.overflow = '';
            }
            
            function onKeyDownCheckoutModal(e) {
                if (e.key === 'Escape') closeCheckoutModal();
            }
            
            modal.querySelector('#checkoutCancel').addEventListener('click', closeCheckoutModal);
            modal.addEventListener('click', (e) => { if (e.target === modal) closeCheckoutModal(); });
            document.addEventListener('keydown', onKeyDownCheckoutModal);

            modal.querySelector('#checkoutConfirm').addEventListener('click', ()=>{
                const name = modal.querySelector('#checkoutContactName').value.trim();
                const address = modal.querySelector('#checkoutAddressLine').value.trim();
                const city = modal.querySelector('#checkoutCity').value.trim();
                const state = modal.querySelector('#checkoutState').value.trim();
                const country = modal.querySelector('#checkoutCountry').value.trim();
                const postal = modal.querySelector('#checkoutPostal').value.trim();
                const phone = modal.querySelector('#checkoutPhone').value.trim();
                const paypalEmail = modal.querySelector('#checkoutPaypalEmail').value.trim();
                const instagram = modal.querySelector('#checkoutInstagram').value.trim();

                if (!name || !address || !city || !country || !postal || !phone) {
                    alert('Por favor, completa todos los campos de dirección.');
                    return;
                }
                if (!paypalEmail || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(paypalEmail)) { alert('Introduce un correo PayPal válido.'); return; }
                if (!instagram || !/^@/.test(instagram)) { alert('Introduce tu usuario de Instagram, debe empezar por @'); return; }

                const checkoutData = { name, address, city, state, country, postal, phone, paypalEmail, instagram };

                const computed = computeCartTotals();
                const total = Number(computed.total || 0);

                console.log('Checkout data:', checkoutData, 'total:', total);

                if (typeof window.abrirPayPal === 'function') {

                    window.abrirPayPal(total.toFixed(2));
                } else {
                    alert('Función de pago no disponible.');
                }
            });
        }

            document.addEventListener('click', (e)=>{

            const targetWithAction = e.target.closest('[data-action]');
            if (!targetWithAction) return;

            if (e.target.matches('input,textarea,select,button') && !e.target.closest('.product-item')) {
                return;
            }
            const id = targetWithAction.dataset.id;
            const action = targetWithAction.dataset.action;
            const product = PRODUCTS.find(p=>p.id===id);
            if (!product) return;
            if (action === 'details') {

                if (product.images && product.images.length) openTiendaCarouselModal(product);
                else openProductModal(product);
            }
            if (action === 'add') {
                if (product.images && product.images.length) openTiendaCarouselModal(product);
                else openProductModal(product);
            }
        });

    if (byId('gotoCheckoutBtn')) byId('gotoCheckoutBtn').addEventListener('click', openCheckout);
        if (byId('clearCartGallery')) byId('clearCartGallery').addEventListener('click', clearCart);

        if (byId('productGallery') && byId('cartItems')) {

            const galleryWrap = document.getElementById('productGallery');
            const galleryHeaderEl = document.querySelector('.gallery-header') || galleryWrap.parentElement;
            if (!document.getElementById('productSearch')) {
                const wrap = document.createElement('div');
                wrap.className = 'product-search-wrap';
                wrap.style.display = 'flex';
                wrap.style.justifyContent = 'space-between';
                wrap.style.alignItems = 'center';
                wrap.style.margin = '0 0 12px 0';
                wrap.style.width = '100%';
                wrap.style.boxSizing = 'border-box';
                wrap.innerHTML = `
                    <div style="display:flex;align-items:center;gap:10px;width:100%;">
                            <div style="background:linear-gradient(90deg, rgba(5,25,55,0.6), rgba(10,31,61,0.6));padding:8px 12px;border-radius:12px;display:flex;align-items:center;gap:10px;width:100%;box-shadow:0 8px 30px rgba(10,31,61,0.25);border:1px solid rgba(255,255,255,0.04);">
                            <i class="fas fa-search" style="color:#9fe0ff;font-size:1.05rem;"></i>
                            <input id="productSearch" placeholder="Buscar camiseta por nombre..." style="flex:1;padding:12px 8px;border-radius:8px;border:none;background:transparent;color:#fff;font-size:1.05rem;outline:none;" />
                            <button id="productSearchClear" title="Limpiar" style="background:transparent;border:none;color:#bcd9ff;cursor:pointer;font-weight:700;padding:6px 8px;border-radius:8px;">Limpiar</button>
                        </div>
                    </div>
                `;
                galleryHeaderEl.appendChild(wrap);

                const input = document.getElementById('productSearch');
                const clearBtn = document.getElementById('productSearchClear');
                if (input) input.addEventListener('input', debounce(function(e){ renderGallery(e.target.value.trim()); }, 180));
                if (clearBtn) clearBtn.addEventListener('click', function(){ if (input) { input.value = ''; renderGallery(''); input.focus(); } });
            }
            renderGallery(); renderCart();
            if (window.updateCartTabBadge) window.updateCartTabBadge();
            try { updateRecommendations(); } catch(e) {}
        }
    </script>
</section>
<section id="reco-helpers" style="display:none">
    <script>

        function updateRecommendations(){
            const scroller = document.getElementById('recoScroller');
            if (!scroller) return;
            scroller.innerHTML = '';
            const inCartIds = new Set(CART.map(ci => ci.productId));
            const recos = (Array.isArray(PRODUCTS) ? PRODUCTS : []).filter(p => !inCartIds.has(p.id)).slice(0, 12);
            if (!recos.length) {
                const hint = document.createElement('div');
                hint.className = 'reco-empty';
                hint.style.color = '#bcd9ff';
                hint.style.padding = '8px 0';
                hint.textContent = 'Añade productos al carrito para ver recomendaciones personalizadas';
                scroller.appendChild(hint);
                return;
            }
            recos.forEach(p => {
                const card = document.createElement('div');
                card.className = 'reco-card';

                card.setAttribute('data-id', p.id);
                card.setAttribute('data-action', 'add');
                const imgSrc = Array.isArray(p.images) && p.images.length ? p.images[0] : p.img || '';
                const price = (typeof p.price === 'number') ? `€${p.price.toFixed(2)}` : '';
                card.innerHTML = `
                    <div style="width:100%;aspect-ratio:1/1;overflow:hidden;border-radius:8px;">
                        <img src="${imgSrc}" alt="${p.name}" loading="lazy" width="1512" height="1512" style="width:100%;height:100%;object-fit:cover;display:block;">
                    </div>
                    <div class="reco-meta">
                        <div class="reco-name">${p.name}</div>
                        <div class="reco-price">${price}</div>
                    </div>
                    
                `;
                scroller.appendChild(card);
            });

            scroller.onclick = null;
        }
    </script>
</section>
<footer>
    <div class="redes_sociales">
        <a href="https://www.instagram.com/camisetazo._/"><i class="fab fa-instagram"></i></a>
        <a href="https://www.tiktok.com/@camisetazo"><i class="fab fa-tiktok"></i></a>
    </div>
    <p style="margin-top: 2rem; opacity: 0.8; font-size: 0.9rem;">
        © 2025 Camisetazo. Todos los derechos reservados
    </p>
</footer>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {

        const PRECIOS_BASE = {
          1: 25.00,
          2: 24.00,
          3: 23.00,
          4: 22.00,
          5: 21.00,
          6: 20.00,
          7: 19.00,
          8: 18.00,
          9: 17.00,
          10: 16.00,
          11: 15.50,
          12: 15.00,
          13: 14.50,
          14: 14.00,
          15: 13.50,
          16: 13.00,
          17: 12.50,
          18: 12.00,
          19: 11.50,
          20: 11.00
        };
        const EXTRAS = {
          parche: 3.00,
          dorsal: 4.00,
          versionJugador: 5.00
        };
        const GASTOS_ENVIO = 5.00;

        document.querySelectorAll('.boton-seccion').forEach(boton => {
            boton.addEventListener('click', function() {
                document.querySelectorAll('.boton-seccion').forEach(b => b.classList.remove('activo'));
                document.querySelectorAll('.seccion').forEach(s => s.classList.remove('activa'));
                const seccionId = this.dataset.seccion;
                this.classList.add('activo');
                const target = document.getElementById(seccionId);
                if (target) target.classList.add('activa');

                try {
                    if (typeof positionCartBelowHeader === 'function') {
                        setTimeout(positionCartBelowHeader, 120);
                        setTimeout(positionCartBelowHeader, 420);
                    }
                } catch(e){}
            });
        });

    (function(){
        const cart = document.getElementById('cartPanel');
        const nav = document.querySelector('.navegacion');
        const header = document.querySelector('header');
        if (!cart) return;

        function calculateTopForCart(){
            const pedidos = document.getElementById('pedidos');
            const gallery = document.getElementById('productGallery');
            const ref = nav || header;
            const refBottom = ref ? Math.round((ref.getBoundingClientRect().bottom || 0) + 8) : 8;

            const pedidosTop = pedidos ? Math.round(pedidos.getBoundingClientRect().top || 8) : 8;
            const minTop = Math.max(refBottom, pedidosTop);

            if (pedidos && pedidos.classList.contains('activa') && gallery) {
                const firstProduct = gallery.querySelector('.product-item');
                if (!firstProduct) return null;
                const pRect = firstProduct.getBoundingClientRect();
                let top = Math.round(pRect.top);
                if (isNaN(top)) top = Math.round(gallery.getBoundingClientRect().top);

                top = Math.max(top, minTop);
                return top;
            }

            if (ref) return Math.max(minTop, refBottom);
            return minTop || 8;
        }

        function positionCartBelowHeader(){

            try {
                const secCarrito = document.getElementById('carrito');
                if (secCarrito && secCarrito.classList.contains('activa')) {
                    cart.style.position = 'relative';
                    cart.style.top = '';
                    cart.style.right = '';
                    cart.style.zIndex = '';
                    cart.style.transition = '';
                    return;
                }
            } catch(e){}

            if (window.innerWidth > 1200) {
                cart.style.position = 'relative';
                cart.style.top = '';
                cart.style.right = '';
                cart.style.zIndex = '';
                try { positionPromoBanner(); } catch(e) {}
                return;
            }

            let top = calculateTopForCart();
            if (top === null) {

                clearTimeout(positionCartBelowHeader._retry);
                positionCartBelowHeader._retry = setTimeout(positionCartBelowHeader, 120);
                return;
            }
            if (isNaN(top) || top < 8) top = 8;

            const vh = Math.max(320, window.innerHeight || 768);
            const cartH = Math.min(cart.offsetHeight || 420, vh - 32);
            if (top + cartH > vh - 12) top = Math.max(8, vh - 12 - cartH);

            cart.style.position = 'fixed';
            cart.style.top = top + 'px';

            cart.style.right = '12px';
            cart.style.zIndex = 1200;

            cart.style.transition = 'top 0.12s ease, right 0.12s ease';
            try { positionPromoBanner(); } catch(e) {}
        }

        window.addEventListener('resize', positionCartBelowHeader);
        window.addEventListener('scroll', positionCartBelowHeader);
        document.querySelectorAll('.boton-seccion').forEach(b => b.addEventListener('click', () => setTimeout(positionCartBelowHeader, 220)));

        const gallery = document.getElementById('productGallery');
        if (gallery) {
            const imgs = gallery.querySelectorAll('img');
            imgs.forEach(img => {
                if (!img.complete) {
                    img.addEventListener('load', () => setTimeout(positionCartBelowHeader, 120));
                    img.addEventListener('error', () => setTimeout(positionCartBelowHeader, 120));
                }
            });
        }

        setTimeout(positionCartBelowHeader, 120);
    })();

    document.querySelectorAll('.boton-unidad').forEach(boton => {
        boton.addEventListener('click', function() {
            unidades = parseInt(this.dataset.unidades);
            document.querySelectorAll('.boton-unidad').forEach(b => b.classList.remove('activo'));
            this.classList.add('activo');
            const contenedor = document.getElementById('contenedorUnidades');
            contenedor.innerHTML = '';
            for(let i = 1; i <= unidades; i++) {
                const isFullWidth = (unidades % 2 === 1) && (i === unidades);
                contenedor.innerHTML += crearUnidad(i, isFullWidth);
            }
            actualizarPrecio();
            configurarEventosUnidades();
        });
    });

    

    function actualizarPrecio() {
    if (typeof unidades === 'undefined' || isNaN(unidades) || unidades < 1) { unidades = 1; }
    let precioBase = PRECIOS_BASE[unidades] || 0;
    let total = precioBase;
    let parches = 0;
    let dorsales = 0;
    let versionesJugador = 0;
    let versionesEspecial = 0;
    let camisetasNBA = 0;
    let recargoTallas = 0;
    let totalRecargoTallas = 0;

    document.querySelectorAll('.unidad').forEach(unidad => {
        const parche = unidad.querySelector('[name="parche[]"]').value.trim();
        const dorsal = unidad.querySelector('[name="dorsal[]"]').value.trim();
        const versionJugador = unidad.querySelector('[name="versionJugador[]"]').value === 'Sí';
        const versionEspecial = unidad.querySelector('[name="versionRetro[]"]').value === 'Sí';
        const esCamisetaNBA = unidad.querySelector('[name="camisetaNBA[]"]').value === 'Sí';
        const talla = unidad.querySelector('[name="talla[]"]').value;

        if (esCamisetaNBA && !dorsal) {
        }

        if (esCamisetaNBA) {
            if (parche) {
                unidad.querySelector('[name="parche[]"]').value = '';
            }
            camisetasNBA++;
            if (dorsal) dorsales++;
        } else {
            if (parche) parches++;
            if (dorsal) dorsales++;
        }
        if (versionJugador) versionesJugador++;
        if (versionEspecial) versionesEspecial++;
        if (talla === '3XL') {
            recargoTallas++;
            totalRecargoTallas += 2;
        } else if (talla === '4XL') {
            recargoTallas++;
            totalRecargoTallas += 2;
        }
    });

    const totalParches = parches * EXTRAS.parche;
    const totalDorsales = dorsales * EXTRAS.dorsal;
    const totalVersionesCombinadas = (versionesJugador + versionesEspecial + camisetasNBA);
    const totalVersionesJugador = totalVersionesCombinadas * EXTRAS.versionJugador;

    total += totalParches + totalDorsales + totalVersionesJugador + totalRecargoTallas;

    let gastosEnvio = 0;
    if (unidades === 1) {
        gastosEnvio = GASTOS_ENVIO;
        total += gastosEnvio;
    }

    if (gastosEnvio === 0) {
        const ge = document.getElementById('gastos-envio'); if (ge) { ge.innerHTML = '<i class="fas fa-gift" style="color:#28a745;margin-right:0.4em;"></i><strong style="color:#28a745;font-size:1.1em;letter-spacing:1px;">GRATIS</strong>'; }
    } else {
        const ge = document.getElementById('gastos-envio'); if (ge) { ge.innerHTML = gastosEnvio.toFixed(2) + '€'; }
    }

    const setText = (id, value) => { const el = document.getElementById(id); if (el) el.textContent = value; };
    const setVal = (id, value) => { const el = document.getElementById(id); if (el) el.value = value; };

    setText('cantidad-unidades', unidades);
    setText('plural-unidades', unidades > 1 ? 'es' : '');
    setText('precio-base-detalle', (PRECIOS_BASE[unidades] || 0).toFixed(2));

    setText('cantidad-unidades-sin-desc', unidades);
    setText('plural-unidades-sin-desc', unidades > 1 ? 'es' : '');
    const precioSinDescuentoUnidad = 25.00;
    const totalSinDescuentoExtras = (parches * EXTRAS.parche) + (dorsales * EXTRAS.dorsal) + ((versionesJugador + versionesEspecial + camisetasNBA) * EXTRAS.versionJugador) + totalRecargoTallas;
    const totalSinDescuento = (precioSinDescuentoUnidad * unidades + totalSinDescuentoExtras).toFixed(2);
    setText('precio-sin-descuento', totalSinDescuento);
    setText('precioSinDescuentoTotal', totalSinDescuento);

    setText('cantidad-parches', parches);
    setText('total-parches', totalParches.toFixed(2));

    setText('cantidad-dorsales', dorsales);
    setText('total-dorsales', totalDorsales.toFixed(2));

    setText('cantidad-versiones', totalVersionesCombinadas);
    setText('total-versiones', totalVersionesJugador.toFixed(2));

    setText('cantidad-tallas-extra', recargoTallas);
    setText('total-tallas-extra', totalRecargoTallas.toFixed(2));

    setText('precioDisplay', total.toFixed(2));
    setVal('precioTotal', total.toFixed(2));

    const precioConDescuento = total.toFixed(2);
    const diferencia = (totalSinDescuento - precioConDescuento).toFixed(2);
    let ahorroHtml = '';
    if (unidades > 0) {
        ahorroHtml = `
        <div class="ahorro-visual animate__animated animate__fadeIn" style="display:flex;justify-content:flex-end;margin:0.5rem 0 0.2rem 0;">
            <span style="background:rgba(40,167,69,0.08);color:#28a745;font-weight:600;font-size:1rem;padding:0.25em 0.9em;border-radius:16px;box-shadow:0 1px 4px #2a5ba81a;display:inline-flex;align-items:center;gap:0.5em;">
                <i class="fas fa-arrow-down" style="color:#28a745;font-size:1em;"></i>
                Ahorro: <span style="font-weight:700;">-${diferencia}€</span>
            </span>
        </div>`;
    }
    const totalContainer = document.querySelector('.total-container');
    if (totalContainer) {
        let oldAhorro = totalContainer.parentElement.querySelector('.ahorro-visual');
        if (oldAhorro) oldAhorro.remove();
        totalContainer.insertAdjacentHTML('beforebegin', ahorroHtml);
    }

    return total;
}
    function prepararRedireccion(event) {
    const total = document.getElementById('precioDisplay').textContent;
    const direccion = document.getElementById('direccion').value;
    const params = new URLSearchParams({
        total: total,
        direccion: encodeURIComponent(direccion)
    });
    const baseUrl = window.location.href.replace('index.html', 'exito.html');
    document.getElementById('nextUrl').value = `${baseUrl}?${params.toString()}`;
    return true;
    }
    function configurarEventosUnidades() {
        document.querySelectorAll('.boton-version-jugador').forEach(boton => {
            boton.addEventListener('click', function() {
                const hiddenInput = this.parentElement.querySelector('[name="versionJugador[]"]');
                const unidad = this.closest('.unidad');
                const botonNBA = unidad.querySelector('.boton-camiseta-nba');
                const botonRetro = unidad.querySelector('.boton-version-especial:not(.boton-version-jugador):not(.boton-camiseta-nba)');

                if (!this.classList.contains('activo')) {
                    if (botonNBA.classList.contains('activo')) {
                        botonNBA.classList.remove('activo');
                        botonNBA.querySelector('span').textContent = 'DESACTIVADO';
                        botonNBA.parentElement.querySelector('[name="camisetaNBA[]"]').value = 'No';
                    }
                    if (botonRetro && botonRetro.classList.contains('activo')) {
                        botonRetro.classList.remove('activo');
                        botonRetro.querySelector('span').textContent = 'DESACTIVADO';
                        botonRetro.parentElement.querySelector('[name="versionRetro[]"]').value = 'No';
                    }
                }

                this.classList.toggle('activo');
                const activo = this.classList.contains('activo');
                this.querySelector('span').textContent = activo ? 'ACTIVADO' : 'DESACTIVADO';
                hiddenInput.value = activo ? 'Sí' : 'No';

                if (activo) {

                    (function(){
                        const overlay = document.createElement('div');
                        overlay.style.position='fixed'; overlay.style.left=0; overlay.style.top=0; overlay.style.right=0; overlay.style.bottom=0;
                        overlay.style.background='rgba(0,0,0,0.55)'; overlay.style.zIndex=6000; overlay.style.display='flex'; overlay.style.alignItems='center'; overlay.style.justifyContent='center';
                        overlay.innerHTML = `
                            <div style="max-width:520px;background:#071735;color:#dbeeff;padding:16px 18px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.4);font-size:0.95rem;line-height:1.45;">
                                <div style="margin-bottom:12px;">
                                    Has seleccionado la versión JUGADOR. Debes encontrar la camiseta en el siguiente enlace:<br>
                                    <a href=\"https://hxltds.x.yupoo.com/\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color:#60a5fa;text-decoration:underline;word-break:break-all;\">https://hxltds.x.yupoo.com/</a>.<br>
                                    Si no la encuentras, contáctanos primero por Instagram.
                                </div>
                                <div style="display:flex;justify-content:flex-end;gap:8px;">
                                    <button id="jugadorNoticeClose3" type="button" style="background:#1f2a44;border:none;color:#dbeeff;padding:8px 12px;border-radius:8px;cursor:pointer;">Cerrar</button>
                                    <a href=\"https://hxltds.x.yupoo.com/\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"background:#2563eb;color:#fff;padding:8px 12px;border-radius:8px;text-decoration:none;\">Abrir enlace</a>
                                </div>
                            </div>`;
                        document.body.appendChild(overlay);
                        overlay.addEventListener('click', (e)=>{ if (e.target === overlay) overlay.remove(); });
                        const closeBtn = overlay.querySelector('#jugadorNoticeClose3');
                        if (closeBtn) closeBtn.addEventListener('click', ()=> overlay.remove());
                    })();

                    if (botonNBA.classList.contains('activo')) {
                        botonNBA.classList.remove('activo');
                        botonNBA.querySelector('span').textContent = 'DESACTIVADO';
                        botonNBA.parentElement.querySelector('[name="camisetaNBA[]"]').value = 'No';
                    }
                    if (botonRetro && botonRetro.classList.contains('activo')) {
                        botonRetro.classList.remove('activo');
                        botonRetro.querySelector('span').textContent = 'DESACTIVADO';
                        botonRetro.parentElement.querySelector('[name="versionRetro[]"]').value = 'No';
                    }
                }

                actualizarPrecio();
            });
        });

        document.querySelectorAll('.boton-version-especial').forEach(boton => {
            if (
                !boton.classList.contains('boton-version-jugador') &&
                !boton.classList.contains('boton-camiseta-nba')
            ) {
                boton.addEventListener('click', function() {
                    const hiddenInput = this.parentElement.querySelector('[name="versionRetro[]"]');
                    const unidad = this.closest('.unidad');
                    const botonNBA = unidad.querySelector('.boton-camiseta-nba');
                    const botonJugador = unidad.querySelector('.boton-version-jugador');

                    if (!this.classList.contains('activo')) {
                        if (botonNBA.classList.contains('activo')) {
                            botonNBA.classList.remove('activo');
                            botonNBA.querySelector('span').textContent = 'DESACTIVADO';
                            botonNBA.parentElement.querySelector('[name="camisetaNBA[]"]').value = 'No';
                        }
                        if (botonJugador.classList.contains('activo')) {
                            botonJugador.classList.remove('activo');
                            botonJugador.querySelector('span').textContent = 'DESACTIVADO';
                            botonJugador.parentElement.querySelector('[name="versionJugador[]"]').value = 'No';
                        }
                    }

                    this.classList.toggle('activo');
                    const activo = this.classList.contains('activo');
                    this.querySelector('span').textContent = activo ? 'ACTIVADO' : 'DESACTIVADO';
                    hiddenInput.value = activo ? 'Sí' : 'No';

                    if (activo) {
                        if (botonNBA.classList.contains('activo')) {
                            botonNBA.classList.remove('activo');
                            botonNBA.querySelector('span').textContent = 'DESACTIVADO';
                            botonNBA.parentElement.querySelector('[name="camisetaNBA[]"]').value = 'No';
                        }
                        if (botonJugador.classList.contains('activo')) {
                            botonJugador.classList.remove('activo');
                            botonJugador.querySelector('span').textContent = 'DESACTIVADO';
                            botonJugador.parentElement.querySelector('[name="versionJugador[]"]').value = 'No';
                        }
                    }

                    actualizarPrecio();
                });
            }
        });

        document.querySelectorAll('.boton-camiseta-nba').forEach(boton => {
            boton.addEventListener('click', function() {
                const hiddenInput = this.parentElement.querySelector('[name="camisetaNBA[]"]');
                const unidad = this.closest('.unidad');
                const botonJugador = unidad.querySelector('.boton-version-jugador');
                const botonRetro = unidad.querySelector('.boton-version-especial:not(.boton-version-jugador):not(.boton-camiseta-nba)');
                const inputParche = unidad.querySelector('[name="parche[]"]');
                const inputDorsal = unidad.querySelector('[name="dorsal[]"]');

                if (!this.classList.contains('activo')) {
                    if (!inputDorsal.value.trim()) {
                        alert('Debes introducir un dorsal para activar la camiseta NBA.');
                        inputDorsal.focus();
                        return;
                    }
                }

                if (!this.classList.contains('activo')) {
                    if (botonJugador.classList.contains('activo')) {
                        botonJugador.classList.remove('activo');
                        botonJugador.querySelector('span').textContent = 'DESACTIVADO';
                        botonJugador.parentElement.querySelector('[name="versionJugador[]"]').value = 'No';
                    }
                    if (botonRetro && botonRetro.classList.contains('activo')) {
                        botonRetro.classList.remove('activo');
                        botonRetro.querySelector('span').textContent = 'DESACTIVADO';
                        botonRetro.parentElement.querySelector('[name="versionRetro[]"]').value = 'No';
                    }
                }

                this.classList.toggle('activo');
                const activo = this.classList.contains('activo');
                this.querySelector('span').textContent = activo ? 'ACTIVADO' : 'DESACTIVADO';
                hiddenInput.value = activo ? 'Sí' : 'No';

                if (activo) {
                    if (botonJugador.classList.contains('activo')) {
                        botonJugador.classList.remove('activo');
                        botonJugador.querySelector('span').textContent = 'DESACTIVADO';
                        botonJugador.parentElement.querySelector('[name="versionJugador[]"]').value = 'No';
                    }
                    if (botonRetro && botonRetro.classList.contains('activo')) {
                        botonRetro.classList.remove('activo');
                        botonRetro.querySelector('span').textContent = 'DESACTIVADO';
                        botonRetro.parentElement.querySelector('[name="versionRetro[]"]').value = 'No';
                    }
                }

                inputParche.disabled = activo;
                if (activo) inputParche.value = '';

                inputDorsal.disabled = false;

                actualizarPrecio();
            });
        });
    document.querySelectorAll('.input-parche, .input-dorsal').forEach(input => {
        input.addEventListener('input', actualizarPrecio);
    });

        document.querySelectorAll('.input-talla').forEach(input => {
            input.addEventListener('change', actualizarPrecio);
        });
}

    window.abrirPayPal = function (total, opts) {
        opts = opts || {};

        let totalStr = String(total || '0');
        totalStr = totalStr.replace(/,/g, '.').replace(/[^0-9.]/g, '');
        const parts = totalStr.split('.');
        if (parts.length > 2) {
            const dec = parts.pop();
            totalStr = parts.join('') + '.' + dec;
        }
        const payAmount = (Number(totalStr) || 0).toFixed(2);

        const width = 600;
        const height = 800;
        const left = Math.round((window.innerWidth - width) / 2);
        const top = Math.round((window.innerHeight - height) / 2);
        const paypalUrl = `https://www.paypal.com/paypalme/camisetazo/${encodeURIComponent(payAmount)}EUR`;

        if (opts && opts.skipHint) {

            let popup = null;
            try {
                popup = window.open(paypalUrl, 'PagoPayPal', `width=${width},height=${height},left=${left},top=${top},resizable=yes,scrollbars=yes`);
                if (popup && typeof popup.focus === 'function') popup.focus();
            } catch(e) {
                setTimeout(()=> { try { popup = window.open(paypalUrl, 'PagoPayPal', `width=${width},height=${height},left=${left},top=${top},resizable=yes,scrollbars=yes`); if (popup && typeof popup.focus === 'function') popup.focus(); } catch(e2){} }, 300);
            }
            if (!popup) {
                mostrarExito('Popup bloqueado. Abre manualmente: ' + paypalUrl);
                return null;
            }

            const intervalo = setInterval(() => {
                try {
                    if (popup.closed) {
                        clearInterval(intervalo);
                        mostrarExito('Pago detectado. Enviando pedido...');
                        try { if (typeof enviarFormulario === 'function') enviarFormulario(); } catch (err) { console.error(err); }
                        const cm = document.getElementById('checkoutModal'); if (cm) cm.remove();
                    }
                } catch (e) {}
            }, 500);
            return popup;
        }

        (function showHintThenOpen(){

            const existing = document.getElementById('paypalHintOverlay'); if (existing) existing.remove();
            const overlay = document.createElement('div');
            overlay.id = 'paypalHintOverlay';
            overlay.style.position = 'fixed';
            overlay.style.left = '0'; overlay.style.top = '0'; overlay.style.right = '0'; overlay.style.bottom = '0';
            overlay.style.display = 'flex';
            overlay.style.alignItems = 'center';
            overlay.style.justifyContent = 'center';
            overlay.style.background = 'rgba(0,0,0,0.45)';
            overlay.style.zIndex = 99999;

            const box = document.createElement('div');
            box.style.background = '#ffc107';
            box.style.color = '#000';
            box.style.padding = '18px';
            box.style.borderRadius = '10px';
            box.style.maxWidth = '820px';
            box.style.width = '92%';
            box.style.boxShadow = '0 10px 40px rgba(0,0,0,0.35)';
            box.innerHTML = `
                    <div style="display:flex;align-items:flex-start;gap:12px;">
                        <div style="flex:1">
                            <strong>Importante:</strong>
                            <div style="margin-top:6px;color:#111;line-height:1.3;">En la ventana de PayPal selecciona la opción "Enviar a amigos y familiares". Cuando cierres la ventana de PayPal se enviará el pedido automáticamente. Si quieres revisar o modificar tu pedido pulsa "Revisar pedido". Para proceder, pulsa "Abrir PayPal" IMPORTANTE: El pedido se enviará simepre y cuando se reciba el pago correctamente.</div>
                        </div>
                        <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end;">
                            <button id="paypalHintRevisar" class="btn-secondary" style="background:transparent;color:#000;border:1px solid rgba(0,0,0,0.08);padding:8px 12px;border-radius:8px;">Revisar pedido</button>
                            <button id="paypalHintAbrir" class="btn-primary" style="background:#0b5ed7;color:#fff;border:none;padding:8px 12px;border-radius:8px;">Abrir PayPal</button>
                        </div>
                    </div>
            `;
            overlay.appendChild(box);

                const revisarBtn = box.querySelector('#paypalHintRevisar');
                const abrirBtn = box.querySelector('#paypalHintAbrir');
                if (revisarBtn) revisarBtn.addEventListener('click', () => { overlay.remove(); });

                if (abrirBtn) abrirBtn.addEventListener('click', () => {
                    overlay.remove();
                    try { window.abrirPayPal(payAmount, { skipHint: true }); } catch (e) { console.error('abrirBtn error', e); }
                });
            document.body.appendChild(overlay);
        })();
        return null;
    }

    function mostrarExito(mensaje) {
    const notificacion = document.getElementById('formStatus');
    if (!notificacion) return;
    notificacion.className = 'success';

    notificacion.style.position = 'fixed';
    notificacion.style.top = '20px';
    notificacion.style.left = '50%';
    notificacion.style.transform = 'translateX(-50%)';
    notificacion.style.zIndex = '200000';
    notificacion.style.background = '#1e7e34';
    notificacion.style.color = '#fff';
    notificacion.style.padding = '12px 16px';
    notificacion.style.borderRadius = '8px';
    notificacion.style.display = 'block';
    notificacion.style.width = 'auto';
    notificacion.style.maxWidth = '94%';
    notificacion.style.boxShadow = '0 8px 30px rgba(30,126,52,0.22)';
    notificacion.innerHTML = `<strong style="margin-right:8px;">✔</strong> ${mensaje} <button id="closeFormStatus" style="margin-left:12px;background:transparent;border:1px solid rgba(255,255,255,0.12);color:#fff;padding:6px 10px;border-radius:6px;cursor:pointer;">Cerrar</button>`;
    const closeBtn = document.getElementById('closeFormStatus');
    if (closeBtn) closeBtn.addEventListener('click', ()=> { notificacion.style.display = 'none'; });
    }
    function enviarFormulario() {
    console.log('enviarFormulario: start. CART length=', (window.CART||[]).length);
        const precioTotalEl = document.getElementById('precioTotal');
        const precioDisplayEl = document.getElementById('precioDisplay');
        const pedidoFormEl = document.getElementById('pedidoForm');
    if (!pedidoFormEl) { console.error('enviarFormulario: pedidoForm not found'); return; }

        if (pedidoFormEl.dataset.submitted === '1') {
            mostrarExito('Pedido ya en proceso de envío...');
            return;
        }

        try {
            const computed = (typeof computeCartTotals === 'function') ? computeCartTotals() : null;
            if (computed && computed.total !== undefined) {
                precioTotalEl.value = Number(computed.total).toFixed(2);
            } else if (precioDisplayEl) {
                precioTotalEl.value = precioDisplayEl.textContent || precioTotalEl.value || '0.00';
            } else {
                const cartTotalEl = document.getElementById('cartTotal');
                precioTotalEl.value = cartTotalEl ? (cartTotalEl.textContent || '0.00') : '0.00';
            }
        } catch (e) {
            precioTotalEl.value = '0.00';
        }

        const copyIfExists = (srcSelector, destId) => {
            const el = document.querySelector(srcSelector);
            const dest = document.getElementById(destId);
            if (el && dest) dest.value = el.value ? el.value.trim() : '';
        };
        copyIfExists('#checkoutPaypalEmail', 'form_emailPaypal');
        copyIfExists('#checkoutContactName', 'form_contactName');
        copyIfExists('#checkoutAddressLine', 'form_direccion');
        copyIfExists('#checkoutCity', 'form_city');
        copyIfExists('#checkoutState', 'form_state');
        copyIfExists('#checkoutCountry', 'form_country');
        copyIfExists('#checkoutPostal', 'form_postal');
        copyIfExists('#checkoutPhone', 'form_phone');
        copyIfExists('#checkoutInstagram', 'form_instagram');

    copyIfExists('#emailPaypal', 'form_emailPaypal');

    copyIfExists('#direccion', 'form_direccion');

        try {
            let itemsToProcess = (window.CART || []);
            if ((!itemsToProcess || itemsToProcess.length === 0) && document.querySelectorAll) {
                console.warn('enviarFormulario: CART vacío — intentando reconstruir items desde DOM');
                const domRows = document.querySelectorAll('#cartItems .cart-item');
                const reconstructed = [];
                domRows.forEach(row => {
                    try {
                        const name = row.querySelector('.meta b') ? row.querySelector('.meta b').textContent.trim() : 'Producto';
                        const metaSmall = row.querySelector('.meta small') ? row.querySelectorAll('.meta small')[0].textContent.trim() : '';
                        const qtyInput = row.querySelector('.cart-qty-input');
                        const quantity = qtyInput ? Math.max(1, parseInt(qtyInput.value) || 1) : 1;
                        let talla = '';
                        let dorsal = '';
                        let parche = '';
                        let version = '';
                        if (metaSmall) {
                            const parts = metaSmall.split('·').map(s=>s.trim()).filter(Boolean);
                            parts.forEach(p => {
                                if (!talla && /^(S|M|L|XL|2XL|3XL|4XL|[0-9]{1,2})$/i.test(p)) { talla = p; }
                                else if (!dorsal && /\d+|[A-Z\s]{2,}/.test(p)) { dorsal = p; }
                                else if (!version && (p.toLowerCase()==='fan' || p.toLowerCase()==='jugador' || p.toLowerCase()==='player')) { version = p; }
                            });
                        }

                        try {
                            const smEls = row.querySelectorAll('.meta small');
                            Array.from(smEls).forEach(sm => {
                                const txt = (sm.textContent||'').trim();
                                const m = txt.match(/^Parche:\s*(.+)$/i);
                                if (m && !parche) parche = m[1].trim();
                            });
                        } catch(e){}
                        let priceTextEl = row.querySelector('div[style*="font-weight:700"]');
                        let totalDisplayed = 0;
                        if (priceTextEl) {
                            const raw = priceTextEl.textContent || priceTextEl.innerText || '';
                            const m = raw.replace(/[^0-9.,]/g,'').replace(',', '.');
                            totalDisplayed = parseFloat(m) || 0;
                        }

                        for (let k = 0; k < quantity; k++) {
                            reconstructed.push({ productId: '', name, talla, dorsal, parche, version, extra:0, unitPrice: totalDisplayed/quantity || 0, total: totalDisplayed/quantity, quantity: 1 });
                        }
                    } catch (e) { console.error('reconstruct row error', e); }
                });
                if (reconstructed.length) itemsToProcess = reconstructed;
            }

            const groupedItems = {};
            itemsToProcess.forEach(item => {
                const key = `${item.productId || ''}-${item.name || ''}-${item.talla || ''}-${item.dorsal || ''}-${item.parche || ''}-${item.version || ''}`;
                if (!groupedItems[key]) {
                    groupedItems[key] = { ...item, quantity: 0, total: 0 };
                }
                groupedItems[key].quantity += 1;
                groupedItems[key].total += item.total;
            });

            const finalItems = Object.values(groupedItems);

            const mapVersion = v => { if (!v) return ''; if (v.toLowerCase() === 'jugador') return 'player'; return v; };
            const textEl = document.getElementById('form_cart_items_text');
            if (textEl) { 
                const lines = finalItems.map((it, idx) => {
                    const parts = [];
                    if (it.talla) parts.push(it.talla);
                    if (it.parche) parts.push(it.parche);
                    if (it.dorsal) parts.push(it.dorsal);
                    const ver = mapVersion(it.version);
                    if (ver) parts.push(ver);
                    const extras = parts.length ? ' · ' + parts.join(' · ') : '';
                    const priceStr = `€${(it.total||0).toFixed(2)}`;
                    return `${idx+1}. ${it.quantity}x ${it.name}${extras} — ${priceStr}`;
                });
                textEl.value = lines.join('\n');
                console.log('enviarFormulario: cart_items_text =', textEl.value);
            }
        } catch (e) { console.error('serialize cart error', e); }

    try { console.log('enviarFormulario: precio_total =', precioTotalEl ? precioTotalEl.value : '(no input)'); } catch(e){}

        try {
            let iframe = document.querySelector('iframe[name="formsubmit_iframe"]');
            if (!iframe) {
                iframe = document.createElement('iframe');
                iframe.name = 'formsubmit_iframe';
                iframe.style.display = 'none';
                document.body.appendChild(iframe);
            }

            pedidoFormEl.dataset.submitted = '1';
            pedidoFormEl.target = 'formsubmit_iframe';

            const onLoadHandler = () => {
                setTimeout(() => {
                    mostrarExito('Pedido enviado correctamente.');
                    try { if (typeof clearCart === 'function') clearCart(); } catch (e) {}
                    pedidoFormEl.dataset.submitted = '0';
                }, 600);
                iframe.removeEventListener('load', onLoadHandler);
            };
            iframe.addEventListener('load', onLoadHandler);

            console.log('enviarFormulario: submitting form to', pedidoFormEl.action, 'target=', pedidoFormEl.target);
            pedidoFormEl.submit();
        } catch (err) {
            console.error('Error enviando formulario:', err);
            mostrarExito('Error al enviar el pedido. Intenta de nuevo o contacta por Instagram.');
            pedidoFormEl.dataset.submitted = '0';
        }
    }

    (function attachLegacyFormHandlers(){
        const pedidoFormEl = document.getElementById('pedidoForm');
        if (!pedidoFormEl) return;

        const paypalBtn = document.getElementById('paypalButton');
        if (!paypalBtn) return;

        paypalBtn.addEventListener('click', function(event) {
            event.preventDefault();

            const emailEl = document.getElementById('emailPaypal');
            const usuarioEl = document.getElementById('usuario');
            const cantidadEl = document.getElementById('cantidad-unidades');
            const precioDisplayEl = document.getElementById('precioDisplay');

            const emailPaypal = emailEl ? emailEl.value.trim() : '';
            if (!emailPaypal || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailPaypal)) {
                alert("Por favor, ingresa un correo válido de PayPal.");
                return;
            }

            const usuarioInstagram = usuarioEl ? usuarioEl.value.trim() : '';
            if (!usuarioInstagram || !/^@[A-Za-z0-9_.]{1,30}$/.test(usuarioInstagram)) {
                alert("Por favor, ingresa un nombre de usuario válido de Instagram (debe comenzar con @ y tener entre 1 y 30 caracteres).");
                return;
            }

            const cantidadUnidades = cantidadEl ? cantidadEl.textContent : '0';
            if (parseInt(cantidadUnidades) === 0) {
                alert("Debes seleccionar al menos una unidad.");
                return;
            }

            const total = precioDisplayEl ? parseFloat(precioDisplayEl.textContent) : NaN;
            if (isNaN(total) || total <= 0) {
                alert("El total a pagar no es válido.");
                return;
            }

            if (typeof window.abrirPayPal === 'function') window.abrirPayPal(total);
        });
    })();

document.querySelectorAll('.catalogo-card-clickable').forEach(card => {
    card.addEventListener('click', function(e) {
        if (
            e.target.closest('.futbol-dropdown-menu a') ||
            e.target.closest('.futbol-dropdown-btn')
        ) {
            return;
        }
        const link = card.getAttribute('data-link');
        if (link) {
            const win = window.open(link, '_blank', 'noopener,noreferrer'); if (win) { try { win.opener = null; } catch(_){} }
        }
    });
});

    actualizarPrecio();

});
</script>

<nav class="bottom-nav" aria-label="Navegación inferior" role="navigation">
    <div class="footer-links" style="position: absolute; bottom: 70px; left: 0; right: 0; text-align: center; font-size: 12px; padding: 5px; background: rgba(10,20,40,0.8);">
        <a href="politica-privacidad.html" style="color: #bcd9ff; margin: 0 10px; text-decoration: none;">Privacidad</a>
        <a href="politica-cookies.html" style="color: #bcd9ff; margin: 0 10px; text-decoration: none;">Cookies</a>
    </div>
  
  <button class="bottom-nav__btn" data-seccion="tienda" aria-label="Ir a Catálogo">
    <span class="icon" aria-hidden="true">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 7h18l-1.5 10.5a2 2 0 0 1-2 1.7H6.5a2 2 0 0 1-2-1.7L3 7Z" stroke="currentColor" stroke-width="1.5"/>
        <path d="M8 7V5a3 3 0 0 1 3-3h2a3 3 0 0 1 3 3v2" stroke="currentColor" stroke-width="1.5"/>
      </svg>
    </span>
    <span class="label">Catálogo</span>
  </button>
  
  <button class="bottom-nav__btn" data-seccion="pedidos" aria-label="Ir a Tienda">
    <span class="icon" aria-hidden="true">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M4 7h16l-1 12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2L4 7Z" stroke="currentColor" stroke-width="1.5"/>
        <path d="M6 7l2-3h8l2 3" stroke="currentColor" stroke-width="1.5"/>
      </svg>
    </span>
    <span class="label">Tienda</span>
  </button>
  
  <button class="bottom-nav__btn" data-seccion="carrito" aria-label="Ir a Carrito">
    <span class="icon" aria-hidden="true">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 5h2l1.6 9.5a2 2 0 0 0 2 1.7h7.8a2 2 0 0 0 2-1.7L20 9H7" stroke="currentColor" stroke-width="1.5"/>
        <circle cx="9" cy="20" r="1.6" stroke="currentColor" stroke-width="1.5"/>
        <circle cx="17" cy="20" r="1.6" stroke="currentColor" stroke-width="1.5"/>
      </svg>
    </span>
    <span class="label">Carrito</span>
    <span class="cart-tab-badge hidden" aria-hidden="true">0</span>
  </button>
  
  <button class="bottom-nav__btn" data-seccion="quienes-somos" aria-label="Ir a ¿Quiénes Somos?">
    <span class="icon" aria-hidden="true">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="12" cy="7" r="3" stroke="currentColor" stroke-width="1.5"/>
        <path d="M4 20a8 8 0 0 1 16 0" stroke="currentColor" stroke-width="1.5"/>
      </svg>
    </span>
    <span class="label">Nosotros</span>
  </button>
</nav>
<script>
(function(){
  const bottomNav = document.querySelector('.bottom-nav');
  if (!bottomNav) return;

  const bottomButtons = Array.from(bottomNav.querySelectorAll('.bottom-nav__btn'));
  function activateSection(id){
    const topBtn = document.querySelector('.boton-seccion[data-seccion="'+id+'"]');
    if (topBtn) topBtn.click();
  }
  bottomButtons.forEach(btn => btn.addEventListener('click', () => activateSection(btn.dataset.seccion)));
  document.querySelectorAll('.boton-seccion').forEach(btn => {
    btn.addEventListener('click', () => {
      const id = btn.dataset.seccion;
      bottomButtons.forEach(b => {
        const isActive = b.dataset.seccion === id;
        b.classList.toggle('activo', isActive);
        if (isActive) { b.setAttribute('aria-current', 'page'); } else { b.removeAttribute('aria-current'); }
      });
    });
  });
  const activeSection = document.querySelector('.seccion.activa');
  if (activeSection){
    const id = activeSection.id;
    bottomButtons.forEach(b => {
      const isActive = b.dataset.seccion === id;
      b.classList.toggle('activo', isActive);
      if (isActive) { b.setAttribute('aria-current', 'page'); } else { b.removeAttribute('aria-current'); }
    });
  }
  const orig = window.updateCartTabBadge;
  window.updateCartTabBadge = function(total){
    try {
      if (typeof orig === 'function') orig(total);
      const btn = bottomNav.querySelector('.bottom-nav__btn[data-seccion="carrito"]');
      if (!btn) return;
      let badge = btn.querySelector('.cart-tab-badge');
      if (!badge){ badge = document.createElement('span'); badge.className='cart-tab-badge'; btn.appendChild(badge); }
      const v = (typeof total === 'number' ? total : (Array.isArray(window.CART) ? window.CART.length : 0));
      if (v > 0){ badge.textContent=String(v); badge.classList.remove('hidden'); }
      else { badge.textContent='0'; badge.classList.add('hidden'); }
    } catch(e) {}
  };
  if (typeof window.updateCartTabBadge === 'function') {
    window.updateCartTabBadge(Array.isArray(window.CART) ? window.CART.length : 0);
  }
})();
</script>
<script defer src="scripts/scripts.js"></script>
<script defer src="scripts/cart-persistence.js"></script>
<script defer src="scripts/schema-org.js"></script>
<script defer src="scripts/performance-optimizations.js"></script>
<script defer src="scripts/register-sw.js"></script>
<script defer src="scripts/cookie-consent.js"></script>
<script defer src="scripts/a11y-improvements.js"></script>
<script defer src="scripts/form-validation.js"></script>
<script defer src="scripts/ddos-protection.js"></script>
<script defer src="scripts/esc-modal-handler.js"></script>
<script defer src="scripts/lazy-loading.js"></script>
<script defer src="scripts/webp-optimization.js"></script>
<script defer src="scripts/advanced-minification.js"></script>
<script defer src="scripts/sitemap-generator.js"></script>
<script defer src="https://analytics.vercel.com/script.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GS53GWE2Z0"></script>
</body>
</html>

